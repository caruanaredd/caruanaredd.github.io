var rf=Object.defineProperty,of=Object.defineProperties,af=Object.getOwnPropertyDescriptors,gi=Object.getOwnPropertySymbols,Ma=Object.prototype.hasOwnProperty,Ea=Object.prototype.propertyIsEnumerable,Oa=(xe,Oe,re)=>Oe in xe?rf(xe,Oe,{enumerable:!0,configurable:!0,writable:!0,value:re}):xe[Oe]=re,te=(xe,Oe)=>{for(var re in Oe||(Oe={}))Ma.call(Oe,re)&&Oa(xe,re,Oe[re]);if(gi)for(var re of gi(Oe))Ea.call(Oe,re)&&Oa(xe,re,Oe[re]);return xe},Be=(xe,Oe)=>of(xe,af(Oe)),qs=(xe,Oe)=>{var re={};for(var J in xe)Ma.call(xe,J)&&Oe.indexOf(J)<0&&(re[J]=xe[J]);if(null!=xe&&gi)for(var J of gi(xe))Oe.indexOf(J)<0&&Ea.call(xe,J)&&(re[J]=xe[J]);return re};(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5967],{5967:(xe,Oe,re)=>{"use strict";re.r(Oe),re.d(Oe,{ScorePageModule:()=>tf});var J=re(9808),q=re(4182),m=re(2974),E=re(5966),k=re(655),he=re(2778),ue=re.n(he),_=re(2096),se=re(9855),X=re.n(se);const Me="14.7.77";var o=re(8021);const V=new WeakSet,M=new WeakMap,me=new WeakMap,Ee=new WeakMap,Z=new WeakMap,le=new WeakMap,be=new WeakMap,Pe=new WeakMap,qe=new WeakMap,fe=new WeakMap,Ye={construct:()=>Ye},nt=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,wt=(s,e)=>{const t=[];let n=s.replace(/^[\s]+/,""),i=n.match(nt);for(;null!==i;){const r=i[1].slice(1,-1),a=i[0].replace(/([\s]+)?;?$/,"").replace(r,new URL(r,e).toString());t.push(a),n=n.slice(i[0].length).replace(/^[\s]+/,""),i=n.match(nt)}return[t.join(";"),n]},Ze=s=>{if(void 0!==s&&!Array.isArray(s))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Tt=s=>{if(!(s=>{try{new new Proxy(s,Ye)}catch(e){return!1}return!0})(s))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===s.prototype||"object"!=typeof s.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},Et=(s,e)=>{const t=s.get(e);if(void 0===t)throw new Error("A value with the given key could not be found.");return t},Ve=(s,e)=>{const t=Array.from(s).filter(e);if(t.length>1)throw Error("More than one element was found.");if(0===t.length)throw Error("No element was found.");const[n]=t;return s.delete(n),n},ye=(s,e,t,n)=>{const i=Et(s,e),r=Ve(i,a=>a[0]===t&&a[1]===n);return 0===i.size&&s.delete(e),r},w=s=>Et(be,s),l=s=>{if(V.has(s))throw new Error("The AudioNode is already stored.");V.add(s),w(s).forEach(e=>e(!0))},b=s=>"port"in s,D=s=>{if(!V.has(s))throw new Error("The AudioNode is not stored.");V.delete(s),w(s).forEach(e=>e(!1))},j=(s,e)=>{!b(s)&&e.every(t=>0===t.size)&&D(s)},Ce={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8};var G=re(5861);const ne=(s,e)=>s.context===e,H=s=>{try{s.copyToChannel(new Float32Array(1),0,-1)}catch(e){return!1}return!0},De=()=>new DOMException("","IndexSizeError"),Ie=s=>{var e;s.getChannelData=(e=s.getChannelData,t=>{try{return e.call(s,t)}catch(n){throw 12===n.code?De():n}})},pe={numberOfChannels:1},ie=-34028234663852886e22,P=-ie,W=s=>V.has(s),we={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},ot=s=>Et(M,s),St=s=>Et(Ee,s),Qt=(s,e)=>{const{activeInputs:t}=ot(s);t.forEach(i=>i.forEach(([r])=>{e.includes(s)||Qt(r,[...e,s])}));const n=(s=>"playbackRate"in s)(s)?[s.playbackRate]:b(s)?Array.from(s.parameters.values()):(s=>"frequency"in s&&"gain"in s)(s)?[s.Q,s.detune,s.frequency,s.gain]:(s=>"offset"in s)(s)?[s.offset]:(s=>!("frequency"in s)&&"gain"in s)(s)?[s.gain]:(s=>"detune"in s&&"frequency"in s)(s)?[s.detune,s.frequency]:(s=>"pan"in s)(s)?[s.pan]:[];for(const i of n){const r=St(i);void 0!==r&&r.activeInputs.forEach(([a])=>Qt(a,e))}W(s)&&D(s)},Vt=s=>{Qt(s.destination,[])},Hn=s=>"context"in s,fn=s=>Hn(s[0]),Jt=(s,e,t,n)=>{for(const i of s)if(t(i)){if(n)return!1;throw Error("The set contains at least one similar element.")}return s.add(e),!0},Fn=(s,e,[t,n],i)=>{Jt(s,[e,t,n],r=>r[0]===e&&r[1]===t,i)},Vs=(s,[e,t,n],i)=>{const r=s.get(e);void 0===r?s.set(e,new Set([[t,n]])):Jt(r,[t,n],a=>a[0]===t,i)},pn=s=>"inputs"in s,vt=(s,e,t,n)=>{if(pn(e)){const i=e.inputs[n];return s.connect(i,t,0),[i,t,0]}return s.connect(e,t,n),[e,t,n]},Ls=(s,e,t)=>{for(const n of s)if(n[0]===e&&n[1]===t)return s.delete(n),n;return null},js=(s,e)=>{if(!w(s).delete(e))throw new Error("Missing the expected event listener.")},Yn=(s,e,t)=>{const n=Et(s,e),i=Ve(n,r=>r[0]===t);return 0===n.size&&s.delete(e),i},ht=(s,e,t,n)=>{pn(e)?s.disconnect(e.inputs[n],t,0):s.disconnect(e,t,n)},Qe=s=>Et(me,s),Nt=s=>Et(Z,s),At=s=>Pe.has(s),kt=s=>!V.has(s),Kt=(s,e)=>new Promise(t=>{if(null!==e)t(!0);else{const n=s.createScriptProcessor(256,1,1),i=s.createGain(),r=s.createBuffer(1,2,44100),a=r.getChannelData(0);a[0]=1,a[1]=1;const c=s.createBufferSource();c.buffer=r,c.loop=!0,c.connect(n).connect(s.destination),c.connect(i),c.disconnect(i),n.onaudioprocess=u=>{const f=u.inputBuffer.getChannelData(0);Array.prototype.some.call(f,d=>1===d)?t(!0):t(!1),c.stop(),n.onaudioprocess=null,c.disconnect(n),n.disconnect(s.destination)},c.start()}}),rn=(s,e)=>{const t=new Map;for(const n of s)for(const i of n){const r=t.get(i);t.set(i,void 0===r?1:r+1)}t.forEach((n,i)=>e(i,n))},Cn=s=>"context"in s,bi=(s,e,t,n,i)=>{const[r,a]=((s,e,t,n)=>{const{activeInputs:i,passiveInputs:r}=ot(e),a=Ls(i[n],s,t);return null===a?[ye(r,s,t,n)[2],!1]:[a[2],!0]})(s,t,n,i);if(null!==r&&(js(s,r),a&&!e&&!At(s)&&ht(Qe(s),Qe(t),n,i)),W(t)){const{activeInputs:c}=ot(t);j(t,c)}},wi=(s,e,t,n)=>{const[i,r]=((s,e,t)=>{const{activeInputs:n,passiveInputs:i}=St(e),r=Ls(n,s,t);return null===r?[Yn(i,s,t)[1],!1]:[r[2],!0]})(s,t,n);null!==i&&(js(s,i),r&&!e&&!At(s)&&Qe(s).disconnect(Nt(t),n))};class ao{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((n,i)=>e.call(t,n,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const Wa={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function Us(s,e,t,n,i){if("function"==typeof s.copyFromChannel)0===e[t].byteLength&&(e[t]=new Float32Array(128)),s.copyFromChannel(e[t],n,i);else{const r=s.getChannelData(n);if(0===e[t].byteLength)e[t]=r.slice(i,i+128);else{const a=new Float32Array(r.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(a)}}}const co=(s,e,t,n,i)=>{"function"==typeof s.copyToChannel?0!==e[t].byteLength&&s.copyToChannel(e[t],n,i):0!==e[t].byteLength&&s.getChannelData(n).set(e[t],i)},Gs=(s,e)=>{const t=[];for(let n=0;n<s;n+=1){const i=[],r="number"==typeof e?e:e[n];for(let a=0;a<r;a+=1)i.push(new Float32Array(128));t.push(i)}return t},za=function(){var s=(0,G.Z)(function*(e,t,n,i,r,a,c){const u=null===t?128*Math.ceil(e.context.length/128):t.length,f=i.channelCount*i.numberOfInputs,d=r.reduce((A,L)=>A+L,0),p=0===d?null:n.createBuffer(d,u,n.sampleRate);if(void 0===a)throw new Error("Missing the processor constructor.");const v=ot(e),y=yield((s,e)=>{const t=Et(fe,s),n=Qe(e);return Et(t,n)})(n,e),T=Gs(i.numberOfInputs,i.channelCount),x=Gs(i.numberOfOutputs,r),O=Array.from(e.parameters.keys()).reduce((A,L)=>Be(te({},A),{[L]:new Float32Array(128)}),{});for(let A=0;A<u;A+=128){if(i.numberOfInputs>0&&null!==t)for(let L=0;L<i.numberOfInputs;L+=1)for(let Y=0;Y<i.channelCount;Y+=1)Us(t,T[L],Y,Y,A);void 0!==a.parameterDescriptors&&null!==t&&a.parameterDescriptors.forEach(({name:L},Y)=>{Us(t,O,L,f+Y,A)});for(let L=0;L<i.numberOfInputs;L+=1)for(let Y=0;Y<r[L];Y+=1)0===x[L][Y].byteLength&&(x[L][Y]=new Float32Array(128));try{const L=T.map((oe,B)=>0===v.activeInputs[B].size?[]:oe),Y=c(A/n.sampleRate,n.sampleRate,()=>y.process(L,x,O));if(null!==p)for(let oe=0,B=0;oe<i.numberOfOutputs;oe+=1){for(let U=0;U<r[oe];U+=1)co(p,x[oe],U,B+U,A);B+=r[oe]}if(!Y)break}catch(L){e.dispatchEvent(new ErrorEvent("processorerror",{colno:L.colno,filename:L.filename,lineno:L.lineno,message:L.message}));break}}return p});return function(t,n,i,r,a,c,u){return s.apply(this,arguments)}}(),Ya={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Ja={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},tc={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ac={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},hc={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},uo=s=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(n=>{const i=()=>{t.onmessage=null,e.close(),t.close(),n()};t.onmessage=()=>i();try{e.postMessage(s,[s])}finally{i()}})},vc={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},zs=(s,e,t)=>{const n=e[t];if(void 0===n)throw s();return n},kc={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Fc={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Ct=()=>new DOMException("","InvalidStateError"),Zs=()=>new DOMException("","InvalidAccessError"),Zc={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},lo=(s,e,t,n,i,r,a,c,u,f,d)=>{const p=f.length;let v=c;for(let y=0;y<p;y+=1){let T=t[0]*f[y];for(let x=1;x<i;x+=1){const O=v-x&u-1;T+=t[x]*r[O],T-=s[x]*a[O]}for(let x=i;x<n;x+=1)T+=t[x]*r[v-x&u-1];for(let x=i;x<e;x+=1)T-=s[x]*a[v-x&u-1];r[v]=f[y],a[v]=T,v=v+1&u-1,d[y]=T}return v},cu={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},In=s=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=s.decodeAudioData(e.buffer,()=>{});return void 0!==t&&(t.catch(()=>{}),!0)}catch(t){}return!1},ct=(s,e,t)=>{const n=e[t];void 0!==n&&n!==s[t]&&(s[t]=n)},Rt=(s,e)=>{ct(s,e,"channelCount"),ct(s,e,"channelCountMode"),ct(s,e,"channelInterpretation")},ho=s=>"function"==typeof s.getFloatTimeDomainData,pt=(s,e,t)=>{const n=e[t];void 0!==n&&n!==s[t].value&&(s[t].value=n)},Ti=s=>{var e;s.start=(e=s.start,(t=0,n=0,i)=>{if("number"==typeof i&&i<0||n<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(s,t,n,i)})},xi=s=>{var e;s.stop=(e=s.stop,(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(s,t)})},fo=(s,e)=>null===s?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(s*e))))),Du=function(){var s=(0,G.Z)(function*(e,t){const n=yield(s=>new Promise((e,t)=>{const{port1:n,port2:i}=new MessageChannel;n.onmessage=({data:r})=>{n.close(),i.close(),e(r)},n.onmessageerror=({data:r})=>{n.close(),i.close(),t(r)},i.postMessage(s)}))(t);return new e(n)});return function(t,n){return s.apply(this,arguments)}}(),po=(s,e)=>{const t=s.createBiquadFilter();return Rt(t,e),pt(t,e,"Q"),pt(t,e,"detune"),pt(t,e,"frequency"),pt(t,e,"gain"),ct(t,e,"type"),t},ms=(s,e)=>{const t=s.createChannelSplitter(e.numberOfOutputs);return Rt(t,e),(s=>{const e=s.numberOfOutputs;Object.defineProperty(s,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Ct()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw Ct()}}),Object.defineProperty(s,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw Ct()}})})(t),t},Xn=(s,e)=>(s.connect=e.connect.bind(e),s.disconnect=e.disconnect.bind(e),s),mo=(s,e)=>{const t=s.createDelay(e.maxDelayTime);return Rt(t,e),pt(t,e,"delayTime"),t},Wt=(s,e)=>{const t=s.createGain();return Rt(t,e),pt(t,e,"gain"),t};function Vu(s,e){const t=e[0]*e[0]+e[1]*e[1];return[(s[0]*e[0]+s[1]*e[1])/t,(s[1]*e[0]-s[0]*e[1])/t]}function Lu(s,e){return[s[0]*e[0]-s[1]*e[1],s[0]*e[1]+s[1]*e[0]]}function _o(s,e){let t=[0,0];for(let n=s.length-1;n>=0;n-=1)t=Lu(t,e),t[0]+=s[n];return t}const _s=(s,e,t,n)=>s.createScriptProcessor(e,t,n),qt=()=>new DOMException("","NotSupportedError"),el={numberOfChannels:1},nl={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},rl={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},cl={disableNormalization:!1},gl={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},go=()=>new DOMException("","UnknownError"),xl={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},vo=(s,e,t)=>void 0===s.copyFromChannel?s.getChannelData(t)[0]:(s.copyFromChannel(e,t),e[0]),yo=s=>{if(null===s)return!1;const e=s.length;return e%2!=0?0!==s[Math.floor(e/2)]:s[e/2-1]+s[e/2]!==0},gs=(s,e,t,n)=>{let i=s;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:r,set:a}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(s,e,{get:t(r),set:n(a)})},bo=(s,e,t)=>{try{s.setValueAtTime(e,t)}catch(n){if(9!==n.code)throw n;bo(s,e,t+1e-7)}},Si=s=>{const e=s.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},wo=s=>{const e=s.createBuffer(1,1,44100),t=s.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch(n){return!1}},Ai=s=>{const e=s.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},To=(s,e)=>{const t=e.createGain();s.connect(t);const n=(i=s.disconnect,()=>{i.call(s,t),s.removeEventListener("ended",n)});var i;s.addEventListener("ended",n),Xn(s,t),s.stop=(i=>{let r=!1;return(a=0)=>{if(r)try{i.call(s,a)}catch(c){t.gain.setValueAtTime(0,a)}else i.call(s,a),r=!0}})(s.stop)},Qn=(s,e)=>t=>{const n={value:s};return Object.defineProperties(t,{currentTarget:n,target:n}),"function"==typeof e?e.call(s,t):e.handleEvent.call(s,t)},Ll=(s=Jt,(e,t,[n,i,r],a)=>{s(e[i],[t,n,r],c=>c[0]===t&&c[1]===n,a)}),Bl=(s=>(e,t,[n,i,r],a)=>{const c=e.get(n);void 0===c?e.set(n,new Set([[i,t,r]])):s(c,[i,t,r],u=>u[0]===i&&u[1]===t,a)})(Jt),jl=(s=>(e,t,n,i)=>s(e[i],r=>r[0]===t&&r[1]===n))(Ve),xo=new WeakMap,Wl=(s=>e=>{var t;return null!==(t=s.get(e))&&void 0!==t?t:0})(xo),Zt=((s,e)=>(t,n)=>{const i=e.get(t);if(void 0!==i)return i;const r=s.get(t);if(void 0!==r)return r;try{const a=n();return a instanceof Promise?(s.set(t,a),a.catch(()=>!1).then(c=>(s.delete(t),e.set(t,c),c))):(e.set(t,a),a)}catch(a){return e.set(t,!1),!1}})(new Map,new WeakMap),on="undefined"==typeof window?null:window,So=((s,e)=>(t,n)=>{const i=t.createAnalyser();if(Rt(i,n),!(n.maxDecibels>n.minDecibels))throw e();return ct(i,n,"fftSize"),ct(i,n,"maxDecibels"),ct(i,n,"minDecibels"),ct(i,n,"smoothingTimeConstant"),s(ho,()=>ho(i))||(s=>{s.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);s.getByteTimeDomainData(t);const n=Math.max(t.length,s.fftSize);for(let i=0;i<n;i+=1)e[i]=.0078125*(t[i]-128);return e}})(i),i})(Zt,De),ki=(s=>e=>{const t=s(e);if(null===t.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer})(ot),It=((s,e,t)=>function(){var n=(0,G.Z)(function*(i,r,a){const c=s(i);yield Promise.all(c.activeInputs.map((u,f)=>Array.from(u).map(function(){var d=(0,G.Z)(function*([p,v]){const T=yield e(p).render(p,r),x=i.context.destination;!t(p)&&(i!==x||!t(i))&&T.connect(a,v,f)});return function(p){return d.apply(this,arguments)}}())).reduce((u,f)=>[...u,...f],[]))});return function(i,r,a){return n.apply(this,arguments)}}())(ot,ki,At),Ul=((s,e,t)=>()=>{const n=new WeakMap,i=function(){var r=(0,G.Z)(function*(a,c){let u=e(a);return ne(u,c)||(u=s(c,{channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,fftSize:u.fftSize,maxDecibels:u.maxDecibels,minDecibels:u.minDecibels,smoothingTimeConstant:u.smoothingTimeConstant})),n.set(c,u),yield t(a,c,u),u});return function(c,u){return r.apply(this,arguments)}}();return{render(r,a){const c=n.get(a);return void 0!==c?Promise.resolve(c):i(r,a)}}})(So,Qe,It),at=(s=>e=>{const t=s.get(e);if(void 0===t)throw Ct();return t})(le),Ft=(s=>null===s?null:s.hasOwnProperty("OfflineAudioContext")?s.OfflineAudioContext:s.hasOwnProperty("webkitOfflineAudioContext")?s.webkitOfflineAudioContext:null)(on),st=(s=>e=>null!==s&&e instanceof s)(Ft),Ao=new WeakMap,ko=(s=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,n,i){if(null!==n){let r=this._listeners.get(n);void 0===r&&(r=s(this,n),"function"==typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(t,r,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,i){const r=null===n?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,void 0===r?null:r,i)}})(Qn),wn=(s=>null===s?null:s.hasOwnProperty("AudioContext")?s.AudioContext:s.hasOwnProperty("webkitAudioContext")?s.webkitAudioContext:null)(on),Ci=(s=>e=>null!==s&&e instanceof s)(wn),Di=(s=>e=>null!==s&&"function"==typeof s.AudioNode&&e instanceof s.AudioNode)(on),Co=(s=>e=>null!==s&&"function"==typeof s.AudioParam&&e instanceof s.AudioParam)(on),$n=(s=>null===s?null:s.hasOwnProperty("AudioWorkletNode")?s.AudioWorkletNode:null)(on),yt=((s,e,t,n,i,r,a,c,u,f,d,p,v,y,T,x)=>class extends f{constructor(A,L,Y,oe){super(Y),this._context=A,this._nativeAudioNode=Y;const B=d(A);p(B)&&!0!==t(Kt,()=>Kt(B,x))&&(s=>{const e=new Map;var t;s.connect=(t=s.connect.bind(s),(n,i=0,r=0)=>{const a=Cn(n)?t(n,i,r):t(n,i),c=e.get(n);return void 0===c?e.set(n,[{input:r,output:i}]):c.every(u=>u.input!==r||u.output!==i)&&c.push({input:r,output:i}),a}),s.disconnect=(t=>(n,i,r)=>{if(t.apply(s),void 0===n)e.clear();else if("number"==typeof n)for(const[a,c]of e){const u=c.filter(f=>f.output!==n);0===u.length?e.delete(a):e.set(a,u)}else if(e.has(n))if(void 0===i)e.delete(n);else{const a=e.get(n);if(void 0!==a){const c=a.filter(u=>u.output!==i&&(u.input!==r||void 0===r));0===c.length?e.delete(n):e.set(n,c)}}for(const[a,c]of e)c.forEach(u=>{Cn(a)?s.connect(a,u.output,u.input):s.connect(a,u.output)})})(s.disconnect)})(Y),me.set(this,Y),be.set(this,new Set),"closed"!==A.state&&L&&l(this),s(this,oe,Y)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(A){this._nativeAudioNode.channelCount=A}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(A){this._nativeAudioNode.channelCountMode=A}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(A){this._nativeAudioNode.channelInterpretation=A}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(A,L=0,Y=0){if(L<0||L>=this._nativeAudioNode.numberOfOutputs)throw i();const oe=d(this._context),B=T(oe);if(v(A)||y(A))throw r();if(Hn(A)){const I=Qe(A);try{const ke=vt(this._nativeAudioNode,I,L,Y),ge=kt(this);(B||ge)&&this._nativeAudioNode.disconnect(...ke),"closed"!==this.context.state&&!ge&&kt(A)&&l(A)}catch(ke){throw 12===ke.code?r():ke}if(e(this,A,L,Y,B)){const ke=u([this],A);rn(ke,n(B))}return A}const U=Nt(A);if("playbackRate"===U.name&&1024===U.maxValue)throw a();try{this._nativeAudioNode.connect(U,L),(B||kt(this))&&this._nativeAudioNode.disconnect(U,L)}catch(I){throw 12===I.code?r():I}if(((s,e,t,n)=>{const{activeInputs:i,passiveInputs:r}=St(e),{outputs:a}=ot(s),c=w(s),u=f=>{const d=Qe(s),p=Nt(e);if(f){const v=Yn(r,s,t);Fn(i,s,v,!1),!n&&!At(s)&&d.connect(p,t)}else{const v=((s,e,t)=>Ve(s,n=>n[0]===e&&n[1]===t))(i,s,t);Vs(r,v,!1),!n&&!At(s)&&d.disconnect(p,t)}};return!!Jt(a,[e,t],f=>f[0]===e&&f[1]===t,!0)&&(c.add(u),W(s)?Fn(i,s,[t,u],!0):Vs(r,[s,t,u],!0),!0)})(this,A,L,B)){const I=u([this],A);rn(I,n(B))}}disconnect(A,L,Y){let oe;const B=d(this._context),U=T(B);if(void 0===A)oe=((s,e)=>{const t=ot(s),n=[];for(const i of t.outputs)fn(i)?bi(s,e,...i):wi(s,e,...i),n.push(i[0]);return t.outputs.clear(),n})(this,U);else if("number"==typeof A){if(A<0||A>=this.numberOfOutputs)throw i();oe=((s,e,t)=>{const n=ot(s),i=[];for(const r of n.outputs)r[1]===t&&(fn(r)?bi(s,e,...r):wi(s,e,...r),i.push(r[0]),n.outputs.delete(r));return i})(this,U,A)}else{if(void 0!==L&&(L<0||L>=this.numberOfOutputs)||Hn(A)&&void 0!==Y&&(Y<0||Y>=A.numberOfInputs))throw i();if(oe=((s,e,t,n,i)=>{const r=ot(s);return Array.from(r.outputs).filter(a=>!(a[0]!==t||void 0!==n&&a[1]!==n||void 0!==i&&a[2]!==i)).map(a=>(fn(a)?bi(s,e,...a):wi(s,e,...a),r.outputs.delete(a),a[0]))})(this,U,A,L,Y),0===oe.length)throw r()}for(const C of oe){const I=u([this],C);rn(I,c)}}})((s=>(e,t,n)=>{const i=[];for(let r=0;r<n.numberOfInputs;r+=1)i.push(new Set);s.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})})(M),((s,e,t,n,i,r,a,c,u,f,d,p,v)=>{const y=new WeakMap;return(T,x,O,A,L)=>{const{activeInputs:Y,passiveInputs:oe}=r(x),{outputs:B}=r(T),U=c(T),C=I=>{const ae=u(x),ke=u(T);if(I){const ge=ye(oe,T,O,A);s(Y,T,ge,!1),!L&&!p(T)&&t(ke,ae,O,A),v(x)&&l(x)}else{const ge=n(Y,T,O,A);e(oe,A,ge,!1),!L&&!p(T)&&i(ke,ae,O,A);const z=a(x);if(0===z)d(x)&&j(x,Y);else{const Re=y.get(x);void 0!==Re&&clearTimeout(Re),y.set(x,setTimeout(()=>{d(x)&&j(x,Y)},1e3*z))}}};return!!f(B,[x,O,A],I=>I[0]===x&&I[1]===O&&I[2]===A,!0)&&(U.add(C),d(T)?s(Y,T,[O,A,C],!0):e(oe,A,[T,O,C],!0),!0)}})(Ll,Bl,vt,jl,ht,ot,Wl,w,Qe,Jt,W,At,kt),Zt,((s,e,t,n,i,r)=>a=>(c,u)=>{const f=s.get(c);if(void 0===f){if(!a&&r(c)){const d=n(c),{outputs:p}=t(c);for(const v of p)if(fn(v)){const y=n(v[0]);e(d,y,v[1],v[2])}else{const y=i(v[0]);d.disconnect(y,v[1])}}s.set(c,u)}else s.set(c,f+u)})(Pe,ht,ot,Qe,Nt,W),De,Zs,qt,((s,e,t,n,i,r,a,c)=>(u,f)=>{const d=e.get(u);if(void 0===d)throw new Error("Missing the expected cycle count.");const p=r(u.context),v=c(p);if(d===f){if(e.delete(u),!v&&a(u)){const y=n(u),{outputs:T}=t(u);for(const x of T)if(fn(x)){const O=n(x[0]);s(y,O,x[1],x[2])}else{const O=i(x[0]);y.connect(O,x[1])}}}else e.set(u,d-f)})(vt,Pe,ot,Qe,Nt,at,W,st),((s,e,t)=>function n(i,r){const a=Hn(r)?r:t(s,r);if((s=>"delayTime"in s)(a))return[];if(i[0]===a)return[i];if(i.includes(a))return[];const{outputs:c}=e(a);return Array.from(c).map(u=>n([...i,a],u[0])).reduce((u,f)=>u.concat(f),[])})(Ao,ot,Et),ko,at,Ci,Di,Co,st,$n),Gl=((s,e,t,n,i,r)=>class extends s{constructor(c,u){const f=i(c),d=te(te({},Ce),u),p=n(f,d);super(c,!1,p,r(f)?e():null),this._nativeAnalyserNode=p}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(c){this._nativeAnalyserNode.fftSize=c}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(c){const u=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=c,!(c>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=u,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(c){const u=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=c,!(this._nativeAnalyserNode.maxDecibels>c))throw this._nativeAnalyserNode.minDecibels=u,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(c){this._nativeAnalyserNode.smoothingTimeConstant=c}getByteFrequencyData(c){this._nativeAnalyserNode.getByteFrequencyData(c)}getByteTimeDomainData(c){this._nativeAnalyserNode.getByteTimeDomainData(c)}getFloatFrequencyData(c){this._nativeAnalyserNode.getFloatFrequencyData(c)}getFloatTimeDomainData(c){this._nativeAnalyserNode.getFloatTimeDomainData(c)}})(yt,Ul,De,So,at,st),Ri=new WeakSet,Do=(s=>null===s?null:s.hasOwnProperty("AudioBuffer")?s.AudioBuffer:null)(on),Ro=(s=>e=>(s[0]=e,s[0]))(new Uint32Array(1)),Oi=((s,e)=>t=>{t.copyFromChannel=(n,i,r=0)=>{const a=s(r),c=s(i);if(c>=t.numberOfChannels)throw e();const u=t.length,f=t.getChannelData(c),d=n.length;for(let p=a<0?-a:0;p+a<u&&p<d;p+=1)n[p]=f[p+a]},t.copyToChannel=(n,i,r=0)=>{const a=s(r),c=s(i);if(c>=t.numberOfChannels)throw e();const u=t.length,f=t.getChannelData(c),d=n.length;for(let p=a<0?-a:0;p+a<u&&p<d;p+=1)f[p+a]=n[p]}})(Ro,De),Mi=(s=>e=>{var t;e.copyFromChannel=(t=e.copyFromChannel,(n,i,r=0)=>{const a=s(r),c=s(i);if(a<e.length)return t.call(e,n,c,a)}),e.copyToChannel=(t=>(n,i,r=0)=>{const a=s(r),c=s(i);if(a<e.length)return t.call(e,n,c,a)})(e.copyToChannel)})(Ro),zl=((s,e,t,n,i,r,a,c)=>{let u=null;return class Na{constructor(d){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:p,numberOfChannels:v,sampleRate:y}=te(te({},pe),d);null===u&&(u=new i(1,1,44100));const T=null!==n&&e(r,r)?new n({length:p,numberOfChannels:v,sampleRate:y}):u.createBuffer(v,p,y);if(0===T.numberOfChannels)throw t();return"function"!=typeof T.copyFromChannel?(a(T),Ie(T)):e(H,()=>H(T))||c(T),s.add(T),T}static[Symbol.hasInstance](d){return null!==d&&"object"==typeof d&&Object.getPrototypeOf(d)===Na.prototype||s.has(d)}}})(Ri,Zt,qt,Do,Ft,(s=>()=>{if(null===s)return!1;try{new s({length:1,sampleRate:44100})}catch(e){return!1}return!0})(Do),Oi,Mi),Hs=(s=>(e,t)=>{const n=s(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(n),n.disconnect()};t.addEventListener("ended",i)})(Wt),Oo=((s,e,t)=>function(){var n=(0,G.Z)(function*(i,r,a){const c=e(i);yield Promise.all(Array.from(c.activeInputs).map(function(){var u=(0,G.Z)(function*([f,d]){const v=yield s(f).render(f,r);t(f)||v.connect(a,d)});return function(f){return u.apply(this,arguments)}}()))});return function(i,r,a){return n.apply(this,arguments)}}())(ki,St,At),mn=(s=>(e,t,n)=>s(t,e,n))(Oo),Jn=((s,e,t,n,i,r,a,c,u,f,d)=>(p,v)=>{const y=p.createBufferSource();return Rt(y,v),pt(y,v,"playbackRate"),ct(y,v,"buffer"),ct(y,v,"loop"),ct(y,v,"loopEnd"),ct(y,v,"loopStart"),e(t,()=>t(p))||(s=>{s.start=(e=>{let t=!1;return(n=0,i=0,r)=>{if(t)throw Ct();e.call(s,n,i,r),t=!0}})(s.start)})(y),e(n,()=>n(p))||(s=>{var e;s.start=(e=s.start,(t=0,n=0,i)=>{const r=s.buffer,a=null===r?n:Math.min(r.duration,n);null!==r&&a>r.duration-.5/s.context.sampleRate?e.call(s,t,0,0):e.call(s,t,a,i)})})(y),e(i,()=>i(p))||f(y,p),e(r,()=>r(p))||Ti(y),e(a,()=>a(p))||d(y,p),e(c,()=>c(p))||xi(y),s(p,y),y})(Hs,Zt,s=>{const e=s.createBufferSource();e.start();try{e.start()}catch(t){return!0}return!1},s=>{const e=s.createBufferSource(),t=s.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch(n){return!1}return!0},s=>{const e=s.createBufferSource();e.start();try{e.stop()}catch(t){return!1}return!0},Si,wo,Ai,0,(s=>(e,t)=>{const n=t.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=n),s(e,"buffer",i=>()=>{const r=i.call(e);return r===n?null:r},i=>r=>i.call(e,null===r?n:r))})(gs),To),_n=((s,e)=>(t,n,i)=>(s(n).replay(i),e(n,t,i)))((s=>e=>{const t=s(e);if(null===t.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer})(St),Oo),Zl=((s,e,t,n,i)=>()=>{const r=new WeakMap;let a=null,c=null;const u=function(){var f=(0,G.Z)(function*(d,p){let v=t(d);const y=ne(v,p);return y||(v=e(p,{buffer:v.buffer,channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,loop:v.loop,loopEnd:v.loopEnd,loopStart:v.loopStart,playbackRate:v.playbackRate.value}),null!==a&&v.start(...a),null!==c&&v.stop(c)),r.set(p,v),y?yield s(p,d.playbackRate,v.playbackRate):yield n(p,d.playbackRate,v.playbackRate),yield i(d,p,v),v});return function(p,v){return f.apply(this,arguments)}}();return{set start(f){a=f},set stop(f){c=f},render(f,d){const p=r.get(d);return void 0!==p?Promise.resolve(p):u(f,d)}}})(mn,Jn,Qe,_n,It),an=((s,e,t,n,i,r,a,c,u,f,d,p,v)=>(y,T,x,O=null,A=null)=>{const L=new o.AutomationEventList(x.defaultValue),Y=T?(s=>({replay(e){for(const t of s)if("exponentialRampToValue"===t.type){const{endTime:n,value:i}=t;e.exponentialRampToValueAtTime(i,n)}else if("linearRampToValue"===t.type){const{endTime:n,value:i}=t;e.linearRampToValueAtTime(i,n)}else if("setTarget"===t.type){const{startTime:n,target:i,timeConstant:r}=t;e.setTargetAtTime(i,n,r)}else if("setValue"===t.type){const{startTime:n,value:i}=t;e.setValueAtTime(i,n)}else{if("setValueCurve"!==t.type)throw new Error("Can't apply an unknown automation.");{const{duration:n,startTime:i,values:r}=t;e.setValueCurveAtTime(r,i,n)}}}}))(L):null,oe={get defaultValue(){return x.defaultValue},get maxValue(){return null===O?x.maxValue:O},get minValue(){return null===A?x.minValue:A},get value(){return x.value},set value(B){x.value=B,oe.setValueAtTime(B,y.context.currentTime)},cancelAndHoldAtTime(B){if("function"==typeof x.cancelAndHoldAtTime)null===Y&&L.flush(y.context.currentTime),L.add(i(B)),x.cancelAndHoldAtTime(B);else{const U=Array.from(L).pop();null===Y&&L.flush(y.context.currentTime),L.add(i(B));const C=Array.from(L).pop();x.cancelScheduledValues(B),U!==C&&void 0!==C&&("exponentialRampToValue"===C.type?x.exponentialRampToValueAtTime(C.value,C.endTime):"linearRampToValue"===C.type?x.linearRampToValueAtTime(C.value,C.endTime):"setValue"===C.type?x.setValueAtTime(C.value,C.startTime):"setValueCurve"===C.type&&x.setValueCurveAtTime(C.values,C.startTime,C.duration))}return oe},cancelScheduledValues:B=>(null===Y&&L.flush(y.context.currentTime),L.add(r(B)),x.cancelScheduledValues(B),oe),exponentialRampToValueAtTime(B,U){if(0===B)throw new RangeError;if(!Number.isFinite(U)||U<0)throw new RangeError;return null===Y&&L.flush(y.context.currentTime),L.add(a(B,U)),x.exponentialRampToValueAtTime(B,U),oe},linearRampToValueAtTime:(B,U)=>(null===Y&&L.flush(y.context.currentTime),L.add(c(B,U)),x.linearRampToValueAtTime(B,U),oe),setTargetAtTime:(B,U,C)=>(null===Y&&L.flush(y.context.currentTime),L.add(u(B,U,C)),x.setTargetAtTime(B,U,C),oe),setValueAtTime:(B,U)=>(null===Y&&L.flush(y.context.currentTime),L.add(f(B,U)),x.setValueAtTime(B,U),oe),setValueCurveAtTime(B,U,C){const I=B instanceof Float32Array?B:new Float32Array(B);if(null!==p&&"webkitAudioContext"===p.name){const ae=U+C,ke=y.context.sampleRate,ge=Math.ceil(U*ke),z=Math.floor(ae*ke),Re=z-ge,ee=new Float32Array(Re);for(let Te=0;Te<Re;Te+=1){const Ne=(I.length-1)/C*((ge+Te)/ke-U),je=Math.floor(Ne),Le=Math.ceil(Ne);ee[Te]=je===Le?I[je]:(1-(Ne-je))*I[je]+(1-(Le-Ne))*I[Le]}null===Y&&L.flush(y.context.currentTime),L.add(d(ee,U,C)),x.setValueCurveAtTime(ee,U,C);const ve=z/ke;ve<ae&&v(oe,ee[ee.length-1],ve),v(oe,I[I.length-1],ae)}else null===Y&&L.flush(y.context.currentTime),L.add(d(I,U,C)),x.setValueCurveAtTime(I,U,C);return oe}};return t.set(oe,x),e.set(oe,y),s(oe,Y),oe})((s=>(e,t)=>{s.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})})(Ee),Ao,Z,0,o.createCancelAndHoldAutomationEvent,o.createCancelScheduledValuesAutomationEvent,o.createExponentialRampToValueAutomationEvent,o.createLinearRampToValueAutomationEvent,o.createSetTargetAutomationEvent,o.createSetValueAutomationEvent,o.createSetValueCurveAutomationEvent,wn,bo),Hl=((s,e,t,n,i,r,a,c)=>class extends s{constructor(f,d){const p=r(f),v=te(te({},we),d),y=i(p,v),T=a(p),x=T?e():null;super(f,!1,y,x),this._audioBufferSourceNodeRenderer=x,this._isBufferNullified=!1,this._isBufferSet=null!==v.buffer,this._nativeAudioBufferSourceNode=y,this._onended=null,this._playbackRate=t(this,T,y.playbackRate,P,ie)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(f){if(this._nativeAudioBufferSourceNode.buffer=f,null!==f){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(f){this._nativeAudioBufferSourceNode.loop=f}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(f){this._nativeAudioBufferSourceNode.loopEnd=f}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(f){this._nativeAudioBufferSourceNode.loopStart=f}get onended(){return this._onended}set onended(f){const d="function"==typeof f?c(this,f):null;this._nativeAudioBufferSourceNode.onended=d;const p=this._nativeAudioBufferSourceNode.onended;this._onended=null!==p&&p===d?f:p}get playbackRate(){return this._playbackRate}start(f=0,d=0,p){if(this._nativeAudioBufferSourceNode.start(f,d,p),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===p?[f,d]:[f,d,p]),"closed"!==this.context.state){l(this);const v=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",v),W(this)&&D(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",v)}}stop(f=0){this._nativeAudioBufferSourceNode.stop(f),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=f)}})(yt,Zl,an,Ct,Jn,at,st,Qn),Yl=((s,e,t,n,i,r,a,c)=>class extends s{constructor(f,d){const p=r(f),v=a(p),y=i(p,d,v);super(f,!1,y,v?e(c):null),this._isNodeOfNativeOfflineAudioContext=v,this._nativeAudioDestinationNode=y}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(f){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(f>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=f}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(f){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=f}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(yt,s=>{const e=new WeakMap,t=function(){var n=(0,G.Z)(function*(i,r){const a=r.destination;return e.set(r,a),yield s(i,r,a),a});return function(r,a){return n.apply(this,arguments)}}();return{render(n,i){const r=e.get(i);return void 0!==r?Promise.resolve(r):t(n,i)}}},De,Ct,((s,e)=>(t,n,i)=>{const r=t.destination;if(r.channelCount!==n)try{r.channelCount=n}catch(c){}i&&"explicit"!==r.channelCountMode&&(r.channelCountMode="explicit"),0===r.maxChannelCount&&Object.defineProperty(r,"maxChannelCount",{value:n});const a=s(t,{channelCount:n,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return e(a,"channelCount",c=>()=>c.call(a),c=>u=>{c.call(a,u);try{r.channelCount=u}catch(f){if(u>r.maxChannelCount)throw f}}),e(a,"channelCountMode",c=>()=>c.call(a),c=>u=>{c.call(a,u),r.channelCountMode=u}),e(a,"channelInterpretation",c=>()=>c.call(a),c=>u=>{c.call(a,u),r.channelInterpretation=u}),Object.defineProperty(a,"maxChannelCount",{get:()=>r.maxChannelCount}),a.connect(r),a})(Wt,gs),at,st,It),Xl=((s,e,t,n,i)=>()=>{const r=new WeakMap,a=function(){var c=(0,G.Z)(function*(u,f){let d=t(u);const p=ne(d,f);return p||(d=e(f,{Q:d.Q.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,gain:d.gain.value,type:d.type})),r.set(f,d),p?(yield s(f,u.Q,d.Q),yield s(f,u.detune,d.detune),yield s(f,u.frequency,d.frequency),yield s(f,u.gain,d.gain)):(yield n(f,u.Q,d.Q),yield n(f,u.detune,d.detune),yield n(f,u.frequency,d.frequency),yield n(f,u.gain,d.gain)),yield i(u,f,d),d});return function(f,d){return c.apply(this,arguments)}}();return{render(c,u){const f=r.get(u);return void 0!==f?Promise.resolve(f):a(c,u)}}})(mn,po,Qe,_n,It),Pn=(s=>(e,t)=>s.set(e,t))(xo),Ql=((s,e,t,n,i,r,a,c)=>class extends s{constructor(f,d){const p=r(f),v=te(te({},Ya),d),y=i(p,v),T=a(p);super(f,!1,y,T?t():null),this._Q=e(this,T,y.Q,P,ie),this._detune=e(this,T,y.detune,1200*Math.log2(P),-1200*Math.log2(P)),this._frequency=e(this,T,y.frequency,f.sampleRate/2,0),this._gain=e(this,T,y.gain,40*Math.log10(P),ie),this._nativeBiquadFilterNode=y,c(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(f){this._nativeBiquadFilterNode.type=f}getFrequencyResponse(f,d,p){try{this._nativeBiquadFilterNode.getFrequencyResponse(f,d,p)}catch(v){throw 11===v.code?n():v}if(f.length!==d.length||d.length!==p.length)throw n()}})(yt,an,Xl,Zs,po,at,st,Pn),Dn=((s,e)=>(t,n,i)=>{const r=new Set;return t.connect=(a=t.connect,(c,u=0,f=0)=>{const d=0===r.size;if(e(c))return a.call(t,c,u,f),s(r,[c,u,f],p=>p[0]===c&&p[1]===u&&p[2]===f,!0),d&&n(),c;a.call(t,c,u),s(r,[c,u],p=>p[0]===c&&p[1]===u,!0),d&&n()}),t.disconnect=(a=>(c,u,f)=>{const d=r.size>0;if(void 0===c)a.apply(t),r.clear();else if("number"==typeof c){a.call(t,c);for(const v of r)v[1]===c&&r.delete(v)}else{e(c)?a.call(t,c,u,f):a.call(t,c,u);for(const v of r)v[0]===c&&(void 0===u||v[1]===u)&&(void 0===f||v[2]===f)&&r.delete(v)}d&&0===r.size&&i()})(t.disconnect),t;var a})(Jt,Di),$l=((s,e)=>(t,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw s()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw s()}});const i=t.createBufferSource();e(n,()=>{const c=n.numberOfInputs;for(let u=0;u<c;u+=1)i.connect(n,0,u)},()=>i.disconnect(n))})(Ct,Dn),Rn=((s,e)=>(t,n)=>{const i=t.createChannelMerger(n.numberOfInputs);return null!==s&&"webkitAudioContext"===s.name&&e(t,i),Rt(i,n),i})(wn,$l),Jl=((s,e,t)=>()=>{const n=new WeakMap,i=function(){var r=(0,G.Z)(function*(a,c){let u=e(a);return ne(u,c)||(u=s(c,{channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfInputs:u.numberOfInputs})),n.set(c,u),yield t(a,c,u),u});return function(c,u){return r.apply(this,arguments)}}();return{render(r,a){const c=n.get(a);return void 0!==c?Promise.resolve(c):i(r,a)}}})(Rn,Qe,It),Kl=((s,e,t,n,i)=>class extends s{constructor(a,c){const u=n(a),f=te(te({},Ja),c);super(a,!1,t(u,f),i(u)?e():null)}})(yt,Jl,Rn,at,st),eh=((s,e,t)=>()=>{const n=new WeakMap,i=function(){var r=(0,G.Z)(function*(a,c){let u=e(a);return ne(u,c)||(u=s(c,{channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfOutputs:u.numberOfOutputs})),n.set(c,u),yield t(a,c,u),u});return function(c,u){return r.apply(this,arguments)}}();return{render(r,a){const c=n.get(a);return void 0!==c?Promise.resolve(c):i(r,a)}}})(ms,Qe,It),th=((s,e,t,n,i,r)=>class extends s{constructor(c,u){const f=n(c),d=(s=>Be(te({},s),{channelCount:s.numberOfOutputs}))(te(te({},tc),u));super(c,!1,t(f,d),i(f)?e():null)}})(yt,eh,ms,at,st),nh=((s,e,t,n)=>(i,c)=>{var u=c,{offset:r}=u,a=qs(u,["offset"]);const f=i.createBuffer(1,2,44100),d=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),p=t(i,Be(te({},a),{gain:r})),v=f.getChannelData(0);v[0]=1,v[1]=1,d.buffer=f,d.loop=!0;const y={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(O){p.channelCount=O},get channelCountMode(){return p.channelCountMode},set channelCountMode(O){p.channelCountMode=O},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(O){p.channelInterpretation=O},get context(){return p.context},get inputs(){return[]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get offset(){return p.gain},get onended(){return d.onended},set onended(O){d.onended=O},addEventListener:(...O)=>d.addEventListener(O[0],O[1],O[2]),dispatchEvent:(...O)=>d.dispatchEvent(O[0]),removeEventListener:(...O)=>d.removeEventListener(O[0],O[1],O[2]),start(O=0){d.start.call(d,O)},stop(O=0){d.stop.call(d,O)}};return s(i,d),n(Xn(y,p),()=>d.connect(p),()=>d.disconnect(p))})(Hs,Jn,Wt,Dn),Kn=((s,e,t,n,i)=>(r,a)=>{if(void 0===r.createConstantSource)return t(r,a);const c=r.createConstantSource();return Rt(c,a),pt(c,a,"offset"),e(n,()=>n(r))||Ti(c),e(i,()=>i(r))||xi(c),s(r,c),c})(Hs,Zt,nh,Si,Ai),sh=((s,e,t,n,i)=>()=>{const r=new WeakMap;let a=null,c=null;const u=function(){var f=(0,G.Z)(function*(d,p){let v=t(d);const y=ne(v,p);return y||(v=e(p,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,offset:v.offset.value}),null!==a&&v.start(a),null!==c&&v.stop(c)),r.set(p,v),y?yield s(p,d.offset,v.offset):yield n(p,d.offset,v.offset),yield i(d,p,v),v});return function(p,v){return f.apply(this,arguments)}}();return{set start(f){a=f},set stop(f){c=f},render(f,d){const p=r.get(d);return void 0!==p?Promise.resolve(p):u(f,d)}}})(mn,Kn,Qe,_n,It),ih=((s,e,t,n,i,r,a)=>class extends s{constructor(u,f){const d=i(u),p=te(te({},ac),f),v=n(d,p),y=r(d),T=y?t():null;super(u,!1,v,T),this._constantSourceNodeRenderer=T,this._nativeConstantSourceNode=v,this._offset=e(this,y,v.offset,P,ie),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(u){const f="function"==typeof u?a(this,u):null;this._nativeConstantSourceNode.onended=f;const d=this._nativeConstantSourceNode.onended;this._onended=null!==d&&d===f?u:d}start(u=0){if(this._nativeConstantSourceNode.start(u),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=u),"closed"!==this.context.state){l(this);const f=()=>{this._nativeConstantSourceNode.removeEventListener("ended",f),W(this)&&D(this)};this._nativeConstantSourceNode.addEventListener("ended",f)}}stop(u=0){this._nativeConstantSourceNode.stop(u),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=u)}})(yt,an,sh,Kn,at,st,Qn),Mo=((s,e)=>(t,n)=>{const i=t.createConvolver();if(Rt(i,n),n.disableNormalization===i.normalize&&(i.normalize=!n.disableNormalization),ct(i,n,"buffer"),n.channelCount>2||(e(i,"channelCount",r=>()=>r.call(i),r=>a=>{if(a>2)throw s();return r.call(i,a)}),"max"===n.channelCountMode))throw s();return e(i,"channelCountMode",r=>()=>r.call(i),r=>a=>{if("max"===a)throw s();return r.call(i,a)}),i})(qt,gs),rh=((s,e,t)=>()=>{const n=new WeakMap,i=function(){var r=(0,G.Z)(function*(a,c){let u=e(a);return ne(u,c)||(u=s(c,{buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,disableNormalization:!u.normalize})),n.set(c,u),pn(u)?yield t(a,c,u.inputs[0]):yield t(a,c,u),u});return function(c,u){return r.apply(this,arguments)}}();return{render(r,a){const c=n.get(a);return void 0!==c?Promise.resolve(c):i(r,a)}}})(Mo,Qe,It),oh=((s,e,t,n,i,r)=>class extends s{constructor(c,u){const f=n(c),d=te(te({},hc),u),p=t(f,d);super(c,!1,p,i(f)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=p,null!==d.buffer&&r(this,d.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(c){this._nativeConvolverNode.buffer=c,null===c&&null!==this._nativeConvolverNode.buffer?(this._nativeConvolverNode.buffer=this._nativeConvolverNode.context.createBuffer(1,1,44100),this._isBufferNullified=!0,r(this,0)):(this._isBufferNullified=!1,r(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration))}get normalize(){return this._nativeConvolverNode.normalize}set normalize(c){this._nativeConvolverNode.normalize=c}})(yt,rh,Mo,at,st,Pn),ah=((s,e,t,n,i)=>r=>{const a=new WeakMap,c=function(){var u=(0,G.Z)(function*(f,d){let p=t(f);const v=ne(p,d);return v||(p=e(d,{channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,delayTime:p.delayTime.value,maxDelayTime:r})),a.set(d,p),v?yield s(d,f.delayTime,p.delayTime):yield n(d,f.delayTime,p.delayTime),yield i(f,d,p),p});return function(d,p){return u.apply(this,arguments)}}();return{render(u,f){const d=a.get(f);return void 0!==d?Promise.resolve(d):c(u,f)}}})(mn,mo,Qe,_n,It),ch=((s,e,t,n,i,r,a)=>class extends s{constructor(u,f){const d=i(u),p=te(te({},vc),f),v=n(d,p),y=r(d);super(u,!1,v,y?t(p.maxDelayTime):null),this._delayTime=e(this,y,v.delayTime),a(this,p.maxDelayTime)}get delayTime(){return this._delayTime}})(yt,an,ah,mo,at,st,Pn),Eo=(s=>(e,t)=>{const n=e.createDynamicsCompressor();if(Rt(n,t),t.channelCount>2||"max"===t.channelCountMode)throw s();return pt(n,t,"attack"),pt(n,t,"knee"),pt(n,t,"ratio"),pt(n,t,"release"),pt(n,t,"threshold"),n})(qt),uh=((s,e,t,n,i)=>()=>{const r=new WeakMap,a=function(){var c=(0,G.Z)(function*(u,f){let d=t(u);const p=ne(d,f);return p||(d=e(f,{attack:d.attack.value,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,knee:d.knee.value,ratio:d.ratio.value,release:d.release.value,threshold:d.threshold.value})),r.set(f,d),p?(yield s(f,u.attack,d.attack),yield s(f,u.knee,d.knee),yield s(f,u.ratio,d.ratio),yield s(f,u.release,d.release),yield s(f,u.threshold,d.threshold)):(yield n(f,u.attack,d.attack),yield n(f,u.knee,d.knee),yield n(f,u.ratio,d.ratio),yield n(f,u.release,d.release),yield n(f,u.threshold,d.threshold)),yield i(u,f,d),d});return function(f,d){return c.apply(this,arguments)}}();return{render(c,u){const f=r.get(u);return void 0!==f?Promise.resolve(f):a(c,u)}}})(mn,Eo,Qe,_n,It),lh=((s,e,t,n,i,r,a,c)=>class extends s{constructor(f,d){const p=r(f),v=te(te({},kc),d),y=n(p,v),T=a(p);super(f,!1,y,T?t():null),this._attack=e(this,T,y.attack),this._knee=e(this,T,y.knee),this._nativeDynamicsCompressorNode=y,this._ratio=e(this,T,y.ratio),this._release=e(this,T,y.release),this._threshold=e(this,T,y.threshold),c(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(f){const d=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=f,f>2)throw this._nativeDynamicsCompressorNode.channelCount=d,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(f){const d=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=f,"max"===f)throw this._nativeDynamicsCompressorNode.channelCountMode=d,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(yt,an,uh,Eo,qt,at,st,Pn),hh=((s,e,t,n,i)=>()=>{const r=new WeakMap,a=function(){var c=(0,G.Z)(function*(u,f){let d=t(u);const p=ne(d,f);return p||(d=e(f,{channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,gain:d.gain.value})),r.set(f,d),p?yield s(f,u.gain,d.gain):yield n(f,u.gain,d.gain),yield i(u,f,d),d});return function(f,d){return c.apply(this,arguments)}}();return{render(c,u){const f=r.get(u);return void 0!==f?Promise.resolve(f):a(c,u)}}})(mn,Wt,Qe,_n,It),dh=((s,e,t,n,i,r)=>class extends s{constructor(c,u){const f=i(c),d=te(te({},Fc),u),p=n(f,d),v=r(f);super(c,!1,p,v?t():null),this._gain=e(this,v,p.gain,P,ie)}get gain(){return this._gain}})(yt,an,hh,Wt,at,st),fh=((s,e,t,n)=>(i,r,{channelCount:a,channelCountMode:c,channelInterpretation:u,feedback:f,feedforward:d})=>{const p=fo(r,i.sampleRate),v=f instanceof Float64Array?f:new Float64Array(f),y=d instanceof Float64Array?d:new Float64Array(d),T=v.length,x=y.length,O=Math.min(T,x);if(0===T||T>20)throw n();if(0===v[0])throw e();if(0===x||x>20)throw n();if(0===y[0])throw e();if(1!==v[0]){for(let I=0;I<x;I+=1)y[I]/=v[0];for(let I=1;I<T;I+=1)v[I]/=v[0]}const A=t(i,p,a,a);A.channelCount=a,A.channelCountMode=c,A.channelInterpretation=u;const Y=[],oe=[],B=[];for(let I=0;I<a;I+=1){Y.push(0);const ae=new Float32Array(32),ke=new Float32Array(32);ae.fill(0),ke.fill(0),oe.push(ae),B.push(ke)}A.onaudioprocess=I=>{const ae=I.inputBuffer,ke=I.outputBuffer,ge=ae.numberOfChannels;for(let z=0;z<ge;z+=1){const Re=ae.getChannelData(z),ee=ke.getChannelData(z);Y[z]=lo(v,T,y,x,O,oe[z],B[z],Y[z],32,Re,ee)}};const U=i.sampleRate/2;return Xn({get bufferSize(){return p},get channelCount(){return A.channelCount},set channelCount(I){A.channelCount=I},get channelCountMode(){return A.channelCountMode},set channelCountMode(I){A.channelCountMode=I},get channelInterpretation(){return A.channelInterpretation},set channelInterpretation(I){A.channelInterpretation=I},get context(){return A.context},get inputs(){return[A]},get numberOfInputs(){return A.numberOfInputs},get numberOfOutputs(){return A.numberOfOutputs},addEventListener:(...I)=>A.addEventListener(I[0],I[1],I[2]),dispatchEvent:(...I)=>A.dispatchEvent(I[0]),getFrequencyResponse(I,ae,ke){if(I.length!==ae.length||ae.length!==ke.length)throw s();const ge=I.length;for(let z=0;z<ge;z+=1){const Re=-Math.PI*(I[z]/U),ee=[Math.cos(Re),Math.sin(Re)],Ne=Vu(_o(y,ee),_o(v,ee));ae[z]=Math.sqrt(Ne[0]*Ne[0]+Ne[1]*Ne[1]),ke[z]=Math.atan2(Ne[1],Ne[0])}},removeEventListener:(...I)=>A.removeEventListener(I[0],I[1],I[2])},A)})(Zs,Ct,_s,qt),Ys=((s,e,t,n)=>i=>s(In,()=>In(i))?Promise.resolve(s(n,n)).then(r=>{if(!r){const a=t(i,512,0,1);i.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>i.currentTime,a.connect(i.destination)}return i.startRendering()}):new Promise(r=>{const a=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=c=>{a.disconnect(),r(c.renderedBuffer)},a.connect(i.destination),i.startRendering()}))(Zt,Wt,_s,((s,e)=>()=>{if(null===e)return Promise.resolve(!1);const t=new e(1,1,44100),n=s(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{n.disconnect(),i(0!==t.currentTime)},t.startRendering()})})(Wt,Ft)),ph=((s,e,t,n,i)=>(r,a)=>{const c=new WeakMap;let u=null;const f=function(){var d=(0,G.Z)(function*(p,v){let y=null,T=e(p);const x=ne(T,v);if(void 0===v.createIIRFilter?y=s(v,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):x||(T=v.createIIRFilter(a,r)),c.set(v,null===y?T:y),null!==y){if(null===u){if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");const A=new t(p.context.destination.channelCount,p.context.length,v.sampleRate);u=(0,G.Z)(function*(){return yield n(p,A,A.destination),((s,e,t,n)=>{const i=t instanceof Float64Array?t:new Float64Array(t),r=n instanceof Float64Array?n:new Float64Array(n),a=i.length,c=r.length,u=Math.min(a,c);if(1!==i[0]){for(let T=0;T<a;T+=1)r[T]/=i[0];for(let T=1;T<c;T+=1)i[T]/=i[0]}const d=new Float32Array(32),p=new Float32Array(32),v=e.createBuffer(s.numberOfChannels,s.length,s.sampleRate),y=s.numberOfChannels;for(let T=0;T<y;T+=1){const x=s.getChannelData(T),O=v.getChannelData(T);d.fill(0),p.fill(0),lo(i,a,r,c,u,d,p,0,32,x,O)}return v})(yield i(A),v,r,a)})()}const O=yield u;return y.buffer=O,y.start(0),y}return yield n(p,v,T),T});return function(v,y){return d.apply(this,arguments)}}();return{render(d,p){const v=c.get(p);return void 0!==v?Promise.resolve(v):f(d,p)}}})(Jn,Qe,Ft,It,Ys),mh=(s=>(e,t,n)=>{if(void 0===e.createIIRFilter)return s(e,t,n);const i=e.createIIRFilter(n.feedforward,n.feedback);return Rt(i,n),i})(fh),_h=((s,e,t,n,i,r)=>class extends s{constructor(c,u){const f=n(c),d=i(f),p=te(te({},Zc),u),v=e(f,d?null:c.baseLatency,p);super(c,!1,v,d?t(p.feedback,p.feedforward):null),(s=>{var e;s.getFrequencyResponse=(e=s.getFrequencyResponse,(t,n,i)=>{if(t.length!==n.length||n.length!==i.length)throw Zs();return e.call(s,t,n,i)})})(v),this._nativeIIRFilterNode=v,r(this,1)}getFrequencyResponse(c,u,f){return this._nativeIIRFilterNode.getFrequencyResponse(c,u,f)}})(yt,mh,ph,at,st,Pn),gh=((s,e,t,n,i,r,a,c)=>(u,f)=>{const d=f.listener,{forwardX:v,forwardY:y,forwardZ:T,positionX:x,positionY:O,positionZ:A,upX:L,upY:Y,upZ:oe}=void 0===d.forwardX?(()=>{const B=new Float32Array(1),U=e(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),C=a(f);let I=!1,ae=[0,0,-1,0,1,0],ke=[0,0,0];const ge=()=>{if(I)return;I=!0;const ve=n(f,256,9,0);ve.onaudioprocess=({inputBuffer:Te})=>{const Ne=[r(Te,B,0),r(Te,B,1),r(Te,B,2),r(Te,B,3),r(Te,B,4),r(Te,B,5)];Ne.some((Le,He)=>Le!==ae[He])&&(d.setOrientation(...Ne),ae=Ne);const je=[r(Te,B,6),r(Te,B,7),r(Te,B,8)];je.some((Le,He)=>Le!==ke[He])&&(d.setPosition(...je),ke=je)},U.connect(ve)},z=ve=>Te=>{Te!==ae[ve]&&(ae[ve]=Te,d.setOrientation(...ae))},Re=ve=>Te=>{Te!==ke[ve]&&(ke[ve]=Te,d.setPosition(...ke))},ee=(ve,Te,Ne)=>{const je=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Te});je.connect(U,0,ve),je.start(),Object.defineProperty(je.offset,"defaultValue",{get:()=>Te});const Le=s({context:u},C,je.offset,P,ie);return c(Le,"value",He=>()=>He.call(Le),He=>et=>{try{He.call(Le,et)}catch(lt){if(9!==lt.code)throw lt}ge(),C&&Ne(et)}),Le.cancelAndHoldAtTime=(He=Le.cancelAndHoldAtTime,C?()=>{throw i()}:(...et)=>{const lt=He.apply(Le,et);return ge(),lt}),Le.cancelScheduledValues=(He=>C?()=>{throw i()}:(...et)=>{const lt=He.apply(Le,et);return ge(),lt})(Le.cancelScheduledValues),Le.exponentialRampToValueAtTime=(He=>C?()=>{throw i()}:(...et)=>{const lt=He.apply(Le,et);return ge(),lt})(Le.exponentialRampToValueAtTime),Le.linearRampToValueAtTime=(He=>C?()=>{throw i()}:(...et)=>{const lt=He.apply(Le,et);return ge(),lt})(Le.linearRampToValueAtTime),Le.setTargetAtTime=(He=>C?()=>{throw i()}:(...et)=>{const lt=He.apply(Le,et);return ge(),lt})(Le.setTargetAtTime),Le.setValueAtTime=(He=>C?()=>{throw i()}:(...et)=>{const lt=He.apply(Le,et);return ge(),lt})(Le.setValueAtTime),Le.setValueCurveAtTime=(He=>C?()=>{throw i()}:(...et)=>{const lt=He.apply(Le,et);return ge(),lt})(Le.setValueCurveAtTime),Le;var He};return{forwardX:ee(0,0,z(0)),forwardY:ee(1,0,z(1)),forwardZ:ee(2,-1,z(2)),positionX:ee(6,0,Re(0)),positionY:ee(7,0,Re(1)),positionZ:ee(8,0,Re(2)),upX:ee(3,0,z(3)),upY:ee(4,1,z(4)),upZ:ee(5,0,z(5))}})():d;return{get forwardX(){return v},get forwardY(){return y},get forwardZ(){return T},get positionX(){return x},get positionY(){return O},get positionZ(){return A},get upX(){return L},get upY(){return Y},get upZ(){return oe}}})(an,Rn,Kn,_s,qt,vo,st,gs),No=new WeakMap,Ei=((s,e,t,n,i,r)=>class extends t{constructor(c,u){super(c),this._nativeContext=c,le.set(this,c),n(c)&&i.set(c,new Set),this._destination=new s(this,u),this._listener=e(this,c),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(c){const u="function"==typeof c?r(this,c):null;this._nativeContext.onstatechange=u;const f=this._nativeContext.onstatechange;this._onstatechange=null!==f&&f===u?c:f}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Yl,gh,ko,st,No,Qn),Fo=((s,e,t,n,i,r)=>(a,c)=>{const u=a.createOscillator();return Rt(u,c),pt(u,c,"detune"),pt(u,c,"frequency"),void 0!==c.periodicWave?u.setPeriodicWave(c.periodicWave):ct(u,c,"type"),e(t,()=>t(a))||Ti(u),e(n,()=>n(a))||r(u,a),e(i,()=>i(a))||xi(u),s(a,u),u})(Hs,Zt,Si,wo,Ai,To),vh=((s,e,t,n,i)=>()=>{const r=new WeakMap;let a=null,c=null,u=null;const f=function(){var d=(0,G.Z)(function*(p,v){let y=t(p);const T=ne(y,v);return T||(y=e(v,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,detune:y.detune.value,frequency:y.frequency.value,periodicWave:null===a?void 0:a,type:y.type}),null!==c&&y.start(c),null!==u&&y.stop(u)),r.set(v,y),T?(yield s(v,p.detune,y.detune),yield s(v,p.frequency,y.frequency)):(yield n(v,p.detune,y.detune),yield n(v,p.frequency,y.frequency)),yield i(p,v,y),y});return function(v,y){return d.apply(this,arguments)}}();return{set periodicWave(d){a=d},set start(d){c=d},set stop(d){u=d},render(d,p){const v=r.get(p);return void 0!==v?Promise.resolve(v):f(d,p)}}})(mn,Fo,Qe,_n,It),yh=((s,e,t,n,i,r,a)=>class extends s{constructor(u,f){const d=i(u),p=te(te({},nl),f),v=t(d,p),y=r(d),T=y?n():null,x=u.sampleRate/2;super(u,!1,v,T),this._detune=e(this,y,v.detune,153600,-153600),this._frequency=e(this,y,v.frequency,x,-x),this._nativeOscillatorNode=v,this._onended=null,this._oscillatorNodeRenderer=T,null!==this._oscillatorNodeRenderer&&void 0!==p.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=p.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(u){const f="function"==typeof u?a(this,u):null;this._nativeOscillatorNode.onended=f;const d=this._nativeOscillatorNode.onended;this._onended=null!==d&&d===f?u:d}get type(){return this._nativeOscillatorNode.type}set type(u){this._nativeOscillatorNode.type=u,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(u){this._nativeOscillatorNode.setPeriodicWave(u),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=u)}start(u=0){if(this._nativeOscillatorNode.start(u),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=u),"closed"!==this.context.state){l(this);const f=()=>{this._nativeOscillatorNode.removeEventListener("ended",f),W(this)&&D(this)};this._nativeOscillatorNode.addEventListener("ended",f)}}stop(u=0){this._nativeOscillatorNode.stop(u),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=u)}})(yt,an,Fo,vh,at,st,Qn),Io=(s=>(e,t)=>{const n=s(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}})(Jn),bh=((s,e,t,n,i)=>(r,f)=>{var d=f,{curve:a,oversample:c}=d,u=qs(d,["curve","oversample"]);const p=r.createWaveShaper(),v=r.createWaveShaper();Rt(p,u),Rt(v,u);const y=t(r,Be(te({},u),{gain:1})),T=t(r,Be(te({},u),{gain:-1})),x=t(r,Be(te({},u),{gain:1})),O=t(r,Be(te({},u),{gain:-1}));let A=null,L=!1,Y=null;const oe={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(C){y.channelCount=C,T.channelCount=C,p.channelCount=C,x.channelCount=C,v.channelCount=C,O.channelCount=C},get channelCountMode(){return p.channelCountMode},set channelCountMode(C){y.channelCountMode=C,T.channelCountMode=C,p.channelCountMode=C,x.channelCountMode=C,v.channelCountMode=C,O.channelCountMode=C},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(C){y.channelInterpretation=C,T.channelInterpretation=C,p.channelInterpretation=C,x.channelInterpretation=C,v.channelInterpretation=C,O.channelInterpretation=C},get context(){return p.context},get curve(){return Y},set curve(C){if(null!==C&&C.length<2)throw e();if(null===C)p.curve=C,v.curve=C;else{const I=C.length,ae=new Float32Array(I+2-I%2),ke=new Float32Array(I+2-I%2);ae[0]=C[0],ke[0]=-C[I-1];const ge=Math.ceil((I+1)/2),z=(I+1)/2-1;for(let Re=1;Re<ge;Re+=1){const ee=Re/ge*z,ve=Math.floor(ee),Te=Math.ceil(ee);ae[Re]=ve===Te?C[ve]:(1-(ee-ve))*C[ve]+(1-(Te-ee))*C[Te],ke[Re]=ve===Te?-C[I-1-ve]:-(1-(ee-ve))*C[I-1-ve]-(1-(Te-ee))*C[I-1-Te]}ae[ge]=I%2==1?C[ge-1]:(C[ge-2]+C[ge-1])/2,p.curve=ae,v.curve=ke}Y=C,L&&(n(Y)&&null===A?A=s(r,y):null!==A&&(A(),A=null))},get inputs(){return[y]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get oversample(){return p.oversample},set oversample(C){p.oversample=C,v.oversample=C},addEventListener:(...C)=>y.addEventListener(C[0],C[1],C[2]),dispatchEvent:(...C)=>y.dispatchEvent(C[0]),removeEventListener:(...C)=>y.removeEventListener(C[0],C[1],C[2])};return null!==a&&(oe.curve=a instanceof Float32Array?a:new Float32Array(a)),c!==oe.oversample&&(oe.oversample=c),i(Xn(oe,x),()=>{y.connect(p).connect(x),y.connect(T).connect(v).connect(O).connect(x),L=!0,n(Y)&&(A=s(r,y))},()=>{y.disconnect(p),p.disconnect(x),y.disconnect(T),T.disconnect(v),v.disconnect(O),O.disconnect(x),L=!1,null!==A&&(A(),A=null)})})(Io,Ct,Wt,yo,Dn),Xs=((s,e,t,n,i,r,a)=>(c,u)=>{const f=c.createWaveShaper();if(null!==r&&"webkitAudioContext"===r.name&&void 0===c.createGain().gain.automationRate)return t(c,u);Rt(f,u);const d=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==d&&d.length<2)throw e();ct(f,{curve:d},"curve"),ct(f,u,"oversample");let p=null,v=!1;return a(f,"curve",x=>()=>x.call(f),x=>O=>(x.call(f,O),v&&(n(O)&&null===p?p=s(c,f):!n(O)&&null!==p&&(p(),p=null)),O)),i(f,()=>{v=!0,n(f.curve)&&(p=s(c,f))},()=>{v=!1,null!==p&&(p(),p=null)})})(Io,Ct,bh,yo,Dn,wn,gs),wh=((s,e,t,n,i,r,a,c,u,f)=>(d,ke)=>{var ge=ke,{coneInnerAngle:p,coneOuterAngle:v,coneOuterGain:y,distanceModel:T,maxDistance:x,orientationX:O,orientationY:A,orientationZ:L,panningModel:Y,positionX:oe,positionY:B,positionZ:U,refDistance:C,rolloffFactor:I}=ge,ae=qs(ge,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]);const z=d.createPanner();if(ae.channelCount>2||"max"===ae.channelCountMode)throw a();Rt(z,ae);const Re={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},ee=t(d,Be(te({},Re),{channelInterpretation:"speakers",numberOfInputs:6})),ve=n(d,Be(te({},ae),{gain:1})),Te=n(d,Be(te({},Re),{gain:1})),Ne=n(d,Be(te({},Re),{gain:0})),je=n(d,Be(te({},Re),{gain:0})),Le=n(d,Be(te({},Re),{gain:0})),He=n(d,Be(te({},Re),{gain:0})),et=n(d,Be(te({},Re),{gain:0})),lt=i(d,256,6,1),rt=r(d,Be(te({},Re),{curve:new Float32Array([1,1]),oversample:"none"}));let jt=[O,A,L],Xt=[oe,B,U];const Gt=new Float32Array(1);lt.onaudioprocess=({inputBuffer:Fe})=>{const hs=[u(Fe,Gt,0),u(Fe,Gt,1),u(Fe,Gt,2)];hs.some((Fs,Is)=>Fs!==jt[Is])&&(z.setOrientation(...hs),jt=hs);const ds=[u(Fe,Gt,3),u(Fe,Gt,4),u(Fe,Gt,5)];ds.some((Fs,Is)=>Fs!==Xt[Is])&&(z.setPosition(...ds),Xt=ds)},Object.defineProperty(Ne.gain,"defaultValue",{get:()=>0}),Object.defineProperty(je.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Le.gain,"defaultValue",{get:()=>0}),Object.defineProperty(He.gain,"defaultValue",{get:()=>0}),Object.defineProperty(et.gain,"defaultValue",{get:()=>0});const Je={get bufferSize(){},get channelCount(){return z.channelCount},set channelCount(Fe){if(Fe>2)throw a();ve.channelCount=Fe,z.channelCount=Fe},get channelCountMode(){return z.channelCountMode},set channelCountMode(Fe){if("max"===Fe)throw a();ve.channelCountMode=Fe,z.channelCountMode=Fe},get channelInterpretation(){return z.channelInterpretation},set channelInterpretation(Fe){ve.channelInterpretation=Fe,z.channelInterpretation=Fe},get coneInnerAngle(){return z.coneInnerAngle},set coneInnerAngle(Fe){z.coneInnerAngle=Fe},get coneOuterAngle(){return z.coneOuterAngle},set coneOuterAngle(Fe){z.coneOuterAngle=Fe},get coneOuterGain(){return z.coneOuterGain},set coneOuterGain(Fe){if(Fe<0||Fe>1)throw e();z.coneOuterGain=Fe},get context(){return z.context},get distanceModel(){return z.distanceModel},set distanceModel(Fe){z.distanceModel=Fe},get inputs(){return[ve]},get maxDistance(){return z.maxDistance},set maxDistance(Fe){if(Fe<0)throw new RangeError;z.maxDistance=Fe},get numberOfInputs(){return z.numberOfInputs},get numberOfOutputs(){return z.numberOfOutputs},get orientationX(){return Te.gain},get orientationY(){return Ne.gain},get orientationZ(){return je.gain},get panningModel(){return z.panningModel},set panningModel(Fe){z.panningModel=Fe},get positionX(){return Le.gain},get positionY(){return He.gain},get positionZ(){return et.gain},get refDistance(){return z.refDistance},set refDistance(Fe){if(Fe<0)throw new RangeError;z.refDistance=Fe},get rolloffFactor(){return z.rolloffFactor},set rolloffFactor(Fe){if(Fe<0)throw new RangeError;z.rolloffFactor=Fe},addEventListener:(...Fe)=>ve.addEventListener(Fe[0],Fe[1],Fe[2]),dispatchEvent:(...Fe)=>ve.dispatchEvent(Fe[0]),removeEventListener:(...Fe)=>ve.removeEventListener(Fe[0],Fe[1],Fe[2])};return p!==Je.coneInnerAngle&&(Je.coneInnerAngle=p),v!==Je.coneOuterAngle&&(Je.coneOuterAngle=v),y!==Je.coneOuterGain&&(Je.coneOuterGain=y),T!==Je.distanceModel&&(Je.distanceModel=T),x!==Je.maxDistance&&(Je.maxDistance=x),O!==Je.orientationX.value&&(Je.orientationX.value=O),A!==Je.orientationY.value&&(Je.orientationY.value=A),L!==Je.orientationZ.value&&(Je.orientationZ.value=L),Y!==Je.panningModel&&(Je.panningModel=Y),oe!==Je.positionX.value&&(Je.positionX.value=oe),B!==Je.positionY.value&&(Je.positionY.value=B),U!==Je.positionZ.value&&(Je.positionZ.value=U),C!==Je.refDistance&&(Je.refDistance=C),I!==Je.rolloffFactor&&(Je.rolloffFactor=I),(1!==jt[0]||0!==jt[1]||0!==jt[2])&&z.setOrientation(...jt),(0!==Xt[0]||0!==Xt[1]||0!==Xt[2])&&z.setPosition(...Xt),f(Xn(Je,z),()=>{ve.connect(z),s(ve,rt,0,0),rt.connect(Te).connect(ee,0,0),rt.connect(Ne).connect(ee,0,1),rt.connect(je).connect(ee,0,2),rt.connect(Le).connect(ee,0,3),rt.connect(He).connect(ee,0,4),rt.connect(et).connect(ee,0,5),ee.connect(lt).connect(d.destination)},()=>{ve.disconnect(z),c(ve,rt,0,0),rt.disconnect(Te),Te.disconnect(ee),rt.disconnect(Ne),Ne.disconnect(ee),rt.disconnect(je),je.disconnect(ee),rt.disconnect(Le),Le.disconnect(ee),rt.disconnect(He),He.disconnect(ee),rt.disconnect(et),et.disconnect(ee),ee.disconnect(lt),lt.disconnect(d.destination)})})(vt,Ct,Rn,Wt,_s,Xs,qt,ht,vo,Dn),Po=(s=>(e,t)=>{const n=e.createPanner();return void 0===n.orientationX?s(e,t):(Rt(n,t),pt(n,t,"orientationX"),pt(n,t,"orientationY"),pt(n,t,"orientationZ"),pt(n,t,"positionX"),pt(n,t,"positionY"),pt(n,t,"positionZ"),ct(n,t,"coneInnerAngle"),ct(n,t,"coneOuterAngle"),ct(n,t,"coneOuterGain"),ct(n,t,"distanceModel"),ct(n,t,"maxDistance"),ct(n,t,"panningModel"),ct(n,t,"refDistance"),ct(n,t,"rolloffFactor"),n)})(wh),Th=((s,e,t,n,i,r,a,c,u,f)=>()=>{const d=new WeakMap;let p=null;const v=function(){var y=(0,G.Z)(function*(T,x){let O=null,A=r(T);const L={channelCount:A.channelCount,channelCountMode:A.channelCountMode,channelInterpretation:A.channelInterpretation},Y=Be(te({},L),{coneInnerAngle:A.coneInnerAngle,coneOuterAngle:A.coneOuterAngle,coneOuterGain:A.coneOuterGain,distanceModel:A.distanceModel,maxDistance:A.maxDistance,panningModel:A.panningModel,refDistance:A.refDistance,rolloffFactor:A.rolloffFactor}),oe=ne(A,x);if("bufferSize"in A)O=n(x,Be(te({},L),{gain:1}));else if(!oe){const B=Be(te({},Y),{orientationX:A.orientationX.value,orientationY:A.orientationY.value,orientationZ:A.orientationZ.value,positionX:A.positionX.value,positionY:A.positionY.value,positionZ:A.positionZ.value});A=i(x,B)}if(d.set(x,null===O?A:O),null!==O){if(null===p){if(null===a)throw new Error("Missing the native OfflineAudioContext constructor.");const z=new a(6,T.context.length,x.sampleRate),Re=e(z,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});Re.connect(z.destination),p=(0,G.Z)(function*(){const ee=yield Promise.all([T.orientationX,T.orientationY,T.orientationZ,T.positionX,T.positionY,T.positionZ].map(function(){var ve=(0,G.Z)(function*(Te,Ne){const je=t(z,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===Ne?1:0});return yield c(z,Te,je.offset),je});return function(Te,Ne){return ve.apply(this,arguments)}}()));for(let ve=0;ve<6;ve+=1)ee[ve].connect(Re,0,ve),ee[ve].start(0);return f(z)})()}const B=yield p,U=n(x,Be(te({},L),{gain:1}));yield u(T,x,U);const C=[];for(let z=0;z<B.numberOfChannels;z+=1)C.push(B.getChannelData(z));let I=[C[0][0],C[1][0],C[2][0]],ae=[C[3][0],C[4][0],C[5][0]],ke=n(x,Be(te({},L),{gain:1})),ge=i(x,Be(te({},Y),{orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:ae[0],positionY:ae[1],positionZ:ae[2]}));U.connect(ke).connect(ge.inputs[0]),ge.connect(O);for(let z=128;z<B.length;z+=128){const Re=[C[0][z],C[1][z],C[2][z]],ee=[C[3][z],C[4][z],C[5][z]];if(Re.some((ve,Te)=>ve!==I[Te])||ee.some((ve,Te)=>ve!==ae[Te])){I=Re,ae=ee;const ve=z/x.sampleRate;ke.gain.setValueAtTime(0,ve),ke=n(x,Be(te({},L),{gain:0})),ge=i(x,Be(te({},Y),{orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:ae[0],positionY:ae[1],positionZ:ae[2]})),ke.gain.setValueAtTime(1,ve),U.connect(ke).connect(ge.inputs[0]),ge.connect(O)}}return O}return oe?(yield s(x,T.orientationX,A.orientationX),yield s(x,T.orientationY,A.orientationY),yield s(x,T.orientationZ,A.orientationZ),yield s(x,T.positionX,A.positionX),yield s(x,T.positionY,A.positionY),yield s(x,T.positionZ,A.positionZ)):(yield c(x,T.orientationX,A.orientationX),yield c(x,T.orientationY,A.orientationY),yield c(x,T.orientationZ,A.orientationZ),yield c(x,T.positionX,A.positionX),yield c(x,T.positionY,A.positionY),yield c(x,T.positionZ,A.positionZ)),pn(A)?yield u(T,x,A.inputs[0]):yield u(T,x,A),A});return function(x,O){return y.apply(this,arguments)}}();return{render(y,T){const x=d.get(T);return void 0!==x?Promise.resolve(x):v(y,T)}}})(mn,Rn,Kn,Wt,Po,Qe,Ft,_n,It,Ys),xh=((s,e,t,n,i,r,a)=>class extends s{constructor(u,f){const d=i(u),p=te(te({},rl),f),v=t(d,p),y=r(d);super(u,!1,v,y?n():null),this._nativePannerNode=v,this._orientationX=e(this,y,v.orientationX,P,ie),this._orientationY=e(this,y,v.orientationY,P,ie),this._orientationZ=e(this,y,v.orientationZ,P,ie),this._positionX=e(this,y,v.positionX,P,ie),this._positionY=e(this,y,v.positionY,P,ie),this._positionZ=e(this,y,v.positionZ,P,ie),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(u){this._nativePannerNode.coneInnerAngle=u}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(u){this._nativePannerNode.coneOuterAngle=u}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(u){this._nativePannerNode.coneOuterGain=u}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(u){this._nativePannerNode.distanceModel=u}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(u){this._nativePannerNode.maxDistance=u}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(u){this._nativePannerNode.panningModel=u}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(u){this._nativePannerNode.refDistance=u}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(u){this._nativePannerNode.rolloffFactor=u}})(yt,an,Po,Th,at,st,Pn),Sh=(s=>(e,{disableNormalization:t,imag:n,real:i})=>{const r=n instanceof Float32Array?n:new Float32Array(n),a=i instanceof Float32Array?i:new Float32Array(i),c=e.createPeriodicWave(a,r,{disableNormalization:t});if(Array.from(n).length<2)throw s();return c})(De),Ah=((s,e,t,n)=>class Fa{constructor(r,a){const c=e(r),u=(s=>{const{imag:e,real:t}=s;return Be(te({},s),void 0===e?void 0===t?{imag:[0,0],real:[0,0]}:{imag:Array.from(t,()=>0),real:t}:void 0===t?{imag:e,real:Array.from(e,()=>0)}:{imag:e,real:t})})(te(te({},cl),a)),f=s(c,u);return t.add(f),f}static[Symbol.hasInstance](r){return null!==r&&"object"==typeof r&&Object.getPrototypeOf(r)===Fa.prototype||t.has(r)}})(Sh,at,new WeakSet),kh=((s,e,t,n,i,r)=>{const c=new Float32Array([1,1]),u=Math.PI/2,f={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},d=Be(te({},f),{oversample:"none"}),y=(T,x,O,A,L)=>{if(1===x)return((T,x,O,A)=>{const L=new Float32Array(16385),Y=new Float32Array(16385);for(let ae=0;ae<16385;ae+=1){const ke=ae/16384*u;L[ae]=Math.cos(ke),Y[ae]=Math.sin(ke)}const oe=t(T,Be(te({},f),{gain:0})),B=n(T,Be(te({},d),{curve:L})),U=n(T,Be(te({},d),{curve:c})),C=t(T,Be(te({},f),{gain:0})),I=n(T,Be(te({},d),{curve:Y}));return{connectGraph(){x.connect(oe),x.connect(void 0===U.inputs?U:U.inputs[0]),x.connect(C),U.connect(O),O.connect(void 0===B.inputs?B:B.inputs[0]),O.connect(void 0===I.inputs?I:I.inputs[0]),B.connect(oe.gain),I.connect(C.gain),oe.connect(A,0,0),C.connect(A,0,1)},disconnectGraph(){x.disconnect(oe),x.disconnect(void 0===U.inputs?U:U.inputs[0]),x.disconnect(C),U.disconnect(O),O.disconnect(void 0===B.inputs?B:B.inputs[0]),O.disconnect(void 0===I.inputs?I:I.inputs[0]),B.disconnect(oe.gain),I.disconnect(C.gain),oe.disconnect(A,0,0),C.disconnect(A,0,1)}}})(T,O,A,L);if(2===x)return((T,x,O,A)=>{const L=new Float32Array(16385),Y=new Float32Array(16385),oe=new Float32Array(16385),B=new Float32Array(16385),U=Math.floor(8192.5);for(let Ne=0;Ne<16385;Ne+=1)if(Ne>U){const je=(Ne-U)/(16384-U)*u;L[Ne]=Math.cos(je),Y[Ne]=Math.sin(je),oe[Ne]=0,B[Ne]=1}else{const je=Ne/(16384-U)*u;L[Ne]=1,Y[Ne]=0,oe[Ne]=Math.cos(je),B[Ne]=Math.sin(je)}const C=e(T,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),I=t(T,Be(te({},f),{gain:0})),ae=n(T,Be(te({},d),{curve:L})),ke=t(T,Be(te({},f),{gain:0})),ge=n(T,Be(te({},d),{curve:Y})),z=n(T,Be(te({},d),{curve:c})),Re=t(T,Be(te({},f),{gain:0})),ee=n(T,Be(te({},d),{curve:oe})),ve=t(T,Be(te({},f),{gain:0})),Te=n(T,Be(te({},d),{curve:B}));return{connectGraph(){x.connect(C),x.connect(void 0===z.inputs?z:z.inputs[0]),C.connect(I,0),C.connect(ke,0),C.connect(Re,1),C.connect(ve,1),z.connect(O),O.connect(void 0===ae.inputs?ae:ae.inputs[0]),O.connect(void 0===ge.inputs?ge:ge.inputs[0]),O.connect(void 0===ee.inputs?ee:ee.inputs[0]),O.connect(void 0===Te.inputs?Te:Te.inputs[0]),ae.connect(I.gain),ge.connect(ke.gain),ee.connect(Re.gain),Te.connect(ve.gain),I.connect(A,0,0),Re.connect(A,0,0),ke.connect(A,0,1),ve.connect(A,0,1)},disconnectGraph(){x.disconnect(C),x.disconnect(void 0===z.inputs?z:z.inputs[0]),C.disconnect(I,0),C.disconnect(ke,0),C.disconnect(Re,1),C.disconnect(ve,1),z.disconnect(O),O.disconnect(void 0===ae.inputs?ae:ae.inputs[0]),O.disconnect(void 0===ge.inputs?ge:ge.inputs[0]),O.disconnect(void 0===ee.inputs?ee:ee.inputs[0]),O.disconnect(void 0===Te.inputs?Te:Te.inputs[0]),ae.disconnect(I.gain),ge.disconnect(ke.gain),ee.disconnect(Re.gain),Te.disconnect(ve.gain),I.disconnect(A,0,0),Re.disconnect(A,0,0),ke.disconnect(A,0,1),ve.disconnect(A,0,1)}}})(T,O,A,L);throw i()};return(T,Y)=>{var oe=Y,{channelCount:x,channelCountMode:O,pan:A}=oe,L=qs(oe,["channelCount","channelCountMode","pan"]);if("max"===O)throw i();const B=s(T,Be(te({},L),{channelCount:1,channelCountMode:O,numberOfInputs:2})),U=t(T,Be(te({},L),{channelCount:x,channelCountMode:O,gain:1})),C=t(T,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:A});let{connectGraph:I,disconnectGraph:ae}=y(T,x,U,C,B);Object.defineProperty(C.gain,"defaultValue",{get:()=>0}),Object.defineProperty(C.gain,"maxValue",{get:()=>1}),Object.defineProperty(C.gain,"minValue",{get:()=>-1});const ke={get bufferSize(){},get channelCount(){return U.channelCount},set channelCount(ee){U.channelCount!==ee&&(ge&&ae(),({connectGraph:I,disconnectGraph:ae}=y(T,ee,U,C,B)),ge&&I()),U.channelCount=ee},get channelCountMode(){return U.channelCountMode},set channelCountMode(ee){if("clamped-max"===ee||"max"===ee)throw i();U.channelCountMode=ee},get channelInterpretation(){return U.channelInterpretation},set channelInterpretation(ee){U.channelInterpretation=ee},get context(){return U.context},get inputs(){return[U]},get numberOfInputs(){return U.numberOfInputs},get numberOfOutputs(){return U.numberOfOutputs},get pan(){return C.gain},addEventListener:(...ee)=>U.addEventListener(ee[0],ee[1],ee[2]),dispatchEvent:(...ee)=>U.dispatchEvent(ee[0]),removeEventListener:(...ee)=>U.removeEventListener(ee[0],ee[1],ee[2])};let ge=!1;return r(Xn(ke,B),()=>{I(),ge=!0},()=>{ae(),ge=!1})}})(Rn,ms,Wt,Xs,qt,Dn),qo=((s,e)=>(t,n)=>{const i=n.channelCountMode;if("clamped-max"===i)throw e();if(void 0===t.createStereoPanner)return s(t,n);const r=t.createStereoPanner();return Rt(r,n),pt(r,n,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>i,set:a=>{if(a!==i)throw e()}}),r})(kh,qt),Ch=((s,e,t,n,i)=>()=>{const r=new WeakMap,a=function(){var c=(0,G.Z)(function*(u,f){let d=t(u);const p=ne(d,f);return p||(d=e(f,{channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,pan:d.pan.value})),r.set(f,d),p?yield s(f,u.pan,d.pan):yield n(f,u.pan,d.pan),pn(d)?yield i(u,f,d.inputs[0]):yield i(u,f,d),d});return function(f,d){return c.apply(this,arguments)}}();return{render(c,u){const f=r.get(u);return void 0!==f?Promise.resolve(f):a(c,u)}}})(mn,qo,Qe,_n,It),Dh=((s,e,t,n,i,r)=>class extends s{constructor(c,u){const f=i(c),d=te(te({},gl),u),p=t(f,d),v=r(f);super(c,!1,p,v?n():null),this._pan=e(this,v,p.pan)}get pan(){return this._pan}})(yt,an,qo,Ch,at,st),Rh=((s,e,t)=>()=>{const n=new WeakMap,i=function(){var r=(0,G.Z)(function*(a,c){let u=e(a);return ne(u,c)||(u=s(c,{channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,curve:u.curve,oversample:u.oversample})),n.set(c,u),pn(u)?yield t(a,c,u.inputs[0]):yield t(a,c,u),u});return function(c,u){return r.apply(this,arguments)}}();return{render(r,a){const c=n.get(a);return void 0!==c?Promise.resolve(c):i(r,a)}}})(Xs,Qe,It),Oh=((s,e,t,n,i,r,a)=>class extends s{constructor(u,f){const d=i(u),p=te(te({},xl),f),v=t(d,p);super(u,!0,v,r(d)?n():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=v,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(u){if(null===u)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(u.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=u}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(u){this._nativeWaveShaperNode.oversample=u}})(yt,Ct,Xs,Rh,at,st,Pn),Vo=(s=>null!==s&&s.isSecureContext)(on),Ni=(s=>(e,t,n)=>{Object.defineProperties(s,{currentFrame:{configurable:!0,get:()=>Math.round(e*t)},currentTime:{configurable:!0,get:()=>e}});try{return n()}finally{null!==s&&(delete s.currentFrame,delete s.currentTime)}})(on),Lo=new WeakMap,Mh=((s,e)=>t=>{let n=s.get(t);if(void 0!==n)return n;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),s.set(t,n),n})(Lo,Ft),Eh=Vo?((s,e,t,n,i,r,a,c,u,f,d,p,v)=>{let y=0;return(T,x,O={credentials:"omit"})=>{const A=d.get(T);if(void 0!==A&&A.has(x))return Promise.resolve();const L=f.get(T);if(void 0!==L){const B=L.get(x);if(void 0!==B)return B}const Y=r(T),oe=void 0===Y.audioWorklet?i(x).then(([B,U])=>{const[C,I]=wt(B,U);return t(`${C};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${I}\n})})(window,'_AWGS')`)}).then(()=>{const B=v._AWGS.pop();if(void 0===B)throw new SyntaxError;n(Y.currentTime,Y.sampleRate,()=>B(class{},void 0,(U,C)=>{if(""===U.trim())throw e();const I=qe.get(Y);if(void 0!==I){if(I.has(U))throw e();Tt(C),Ze(C.parameterDescriptors),I.set(U,C)}else Tt(C),Ze(C.parameterDescriptors),qe.set(Y,new Map([[U,C]]))},Y.sampleRate,void 0,void 0))}):Promise.all([i(x),Promise.resolve(s(p,p))]).then(([[B,U],C])=>{const I=y+1;y=I;const[ae,ke]=wt(B,U),ve=new Blob([`${ae};((AudioWorkletProcessor,registerProcessor)=>{${ke}\n})(${C?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${C?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${C?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${I}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),Te=URL.createObjectURL(ve);return Y.audioWorklet.addModule(Te,O).then(()=>{if(c(Y))return Y;const Ne=a(Y);return Ne.audioWorklet.addModule(Te,O).then(()=>Ne)}).then(Ne=>{if(null===u)throw new SyntaxError;try{new u(Ne,`__sac${I}`)}catch(je){throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(Te))});return void 0===L?f.set(T,new Map([[x,oe]])):L.set(x,oe),oe.then(()=>{const B=d.get(T);void 0===B?d.set(T,new Set([x])):B.add(x)}).finally(()=>{const B=f.get(T);void 0!==B&&B.delete(x)}),oe}})(Zt,qt,(s=>e=>new Promise((t,n)=>{if(null===s)return void n(new SyntaxError);const i=s.document.head;if(null===i)n(new SyntaxError);else{const r=s.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),c=URL.createObjectURL(a),u=s.onerror,f=()=>{s.onerror=u,URL.revokeObjectURL(c)};s.onerror=(d,p,v,y,T)=>p===c||p===s.location.href&&1===v&&1===y?(f(),n(T),!1):null!==u?u(d,p,v,y,T):void 0,r.onerror=()=>{f(),n(new SyntaxError)},r.onload=()=>{f(),t()},r.src=c,r.type="module",i.appendChild(r)}}))(on),Ni,function(){var e=(0,G.Z)(function*(t){try{const n=yield fetch(t);if(n.ok)return[yield n.text(),n.url]}catch(n){}throw new DOMException("","AbortError")});return function(t){return e.apply(this,arguments)}}(),at,Mh,st,$n,new WeakMap,new WeakMap,((s,e)=>(0,G.Z)(function*(){if(null===s)return!0;if(null===e)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),i=URL.createObjectURL(t);let r=!1,a=!1;try{yield n.audioWorklet.addModule(i);const c=new s(n,"a",{numberOfOutputs:0}),u=n.createOscillator();c.port.onmessage=()=>r=!0,c.onprocessorerror=()=>a=!0,u.connect(c),u.start(0),yield n.startRendering()}catch(c){}finally{URL.revokeObjectURL(i)}return r&&!a}))($n,Ft),on):void 0,Nh=((s,e)=>t=>s(t)||e(t))(Ci,st),Fh=((s,e,t,n,i,r,a,c,u,f,d)=>(p,v)=>{const y=a(p)?p:r(p);if(i.has(v)){const T=new DOMException("","DataCloneError");return Promise.reject(T)}try{i.add(v)}catch(T){}return e(u,()=>u(y))?y.decodeAudioData(v).then(T=>(uo(v).catch(()=>{}),e(c,()=>c(T))||d(T),s.add(T),T)):new Promise((T,x)=>{const O=function(){var L=(0,G.Z)(function*(){try{yield uo(v)}catch(Y){}});return function(){return L.apply(this,arguments)}}(),A=L=>{x(L),O()};try{y.decodeAudioData(v,L=>{"function"!=typeof L.copyFromChannel&&(f(L),Ie(L)),s.add(L),O().then(()=>T(L))},L=>{A(null===L?new DOMException("","EncodingError"):L)})}catch(L){A(L)}})})(Ri,Zt,0,0,new WeakSet,at,Nh,H,In,Oi,Mi),Bo=((s,e,t,n,i,r,a,c,u,f,d,p,v,y,T,x,O,A,L,Y)=>class extends T{constructor(B,U){super(B,U),this._nativeContext=B,this._audioWorklet=void 0===s?void 0:{addModule:(C,I)=>s(this,C,I)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(B,U,C){return new t({length:U,numberOfChannels:B,sampleRate:C})}createBufferSource(){return new n(this)}createChannelMerger(B=6){return new r(this,{numberOfInputs:B})}createChannelSplitter(B=6){return new a(this,{numberOfOutputs:B})}createConstantSource(){return new c(this)}createConvolver(){return new u(this)}createDelay(B=1){return new d(this,{maxDelayTime:B})}createDynamicsCompressor(){return new p(this)}createGain(){return new v(this)}createIIRFilter(B,U){return new y(this,{feedback:U,feedforward:B})}createOscillator(){return new x(this)}createPanner(){return new O(this)}createPeriodicWave(B,U,C={disableNormalization:!1}){return new A(this,Be(te({},C),{imag:U,real:B}))}createStereoPanner(){return new L(this)}createWaveShaper(){return new Y(this)}decodeAudioData(B,U,C){return f(this._nativeContext,B).then(I=>("function"==typeof U&&U(I),I),I=>{throw"function"==typeof C&&C(I),I})}})(Eh,Gl,zl,Hl,Ql,Kl,th,ih,oh,Fh,ch,lh,dh,_h,Ei,yh,xh,Ah,Dh,Oh),Ih=((s,e,t,n)=>class extends s{constructor(r,a){const c=t(r),u=((s,e)=>s.createMediaElementSource(e.mediaElement))(c,a);if(n(c))throw TypeError();super(r,!0,u,null),this._nativeMediaElementAudioSourceNode=u}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(yt,0,at,st),Ph=((s,e,t,n)=>class extends s{constructor(r,a){const c=t(r);if(n(c))throw new TypeError;const f=((s,e)=>{const t=s.createMediaStreamDestination();return Rt(t,e),1===t.numberOfOutputs&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t})(c,te(te({},cu),a));super(r,!1,f,null),this._nativeMediaStreamAudioDestinationNode=f}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(yt,0,at,st),qh=((s,e,t,n)=>class extends s{constructor(r,a){const c=t(r),u=((s,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((r,a)=>r.id<a.id?-1:r.id>a.id?1:0);const n=t.slice(0,1),i=s.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(i,"mediaStream",{value:e}),i})(c,a);if(n(c))throw new TypeError;super(r,!0,u,null),this._nativeMediaStreamAudioSourceNode=u}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(yt,0,at,st),Vh=((s,e)=>(t,{mediaStreamTrack:n})=>{if("function"==typeof t.createMediaStreamTrackSource)return t.createMediaStreamTrackSource(n);const i=new MediaStream([n]),r=t.createMediaStreamSource(i);if("audio"!==n.kind)throw s();if(e(t))throw new TypeError;return r})(Ct,st),Lh=((s,e,t)=>class extends s{constructor(i,r){const a=t(i);super(i,!0,e(a,r),null)}})(yt,Vh,at),Bh=((s,e,t,n,i,r,a,c,u)=>class extends s{constructor(d={}){if(null===u)throw new Error("Missing the native AudioContext constructor.");let p;try{p=new u(d)}catch(T){throw 12===T.code&&"sampleRate is not in range"===T.message?t():T}if(null===p)throw n();if(!(s=>void 0===s||"number"==typeof s||"string"==typeof s&&("balanced"===s||"interactive"===s||"playback"===s))(d.latencyHint))throw new TypeError(`The provided value '${d.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==d.sampleRate&&p.sampleRate!==d.sampleRate)throw t();super(p,2);const{latencyHint:v}=d,{sampleRate:y}=p;if(this._baseLatency="number"==typeof p.baseLatency?p.baseLatency:"balanced"===v?512/y:"interactive"===v||void 0===v?256/y:"playback"===v?1024/y:128*Math.max(2,Math.min(128,Math.round(v*y/128)))/y,this._nativeAudioContext=p,"webkitAudioContext"===u.name?(this._nativeGainNode=p.createGain(),this._nativeOscillatorNode=p.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(p.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===p.state){this._state="suspended";const T=()=>{"suspended"===this._state&&(this._state=null),p.removeEventListener("statechange",T)};p.addEventListener("statechange",T)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw e()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Vt(this)}))}createMediaElementSource(d){return new i(this,{mediaElement:d})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(d){return new a(this,{mediaStream:d})}createMediaStreamTrackSource(d){return new c(this,{mediaStreamTrack:d})}resume(){return"suspended"===this._state?new Promise((d,p)=>{const v=()=>{this._nativeAudioContext.removeEventListener("statechange",v),"running"===this._nativeAudioContext.state?d():this.resume().then(d,p)};this._nativeAudioContext.addEventListener("statechange",v)}):this._nativeAudioContext.resume().catch(d=>{throw void 0===d||15===d.code?e():d})}suspend(){return this._nativeAudioContext.suspend().catch(d=>{throw void 0===d?e():d})}})(Bo,Ct,qt,go,Ih,Ph,qh,Lh,wn),Fi=(s=>e=>{const t=s.get(e);if(void 0===t)throw new Error("The context has no set of AudioWorkletNodes.");return t})(No),jh=(s=>(e,t)=>{s(e).add(t)})(Fi),jo=(s=>(e,t,n=0,i=0)=>{const r=e[n];if(void 0===r)throw s();return Cn(t)?r.connect(t,0,i):r.connect(t,0)})(De),Wh=(s=>(e,t)=>{s(e).delete(t)})(Fi),Wo=(s=>(e,t,n,i=0)=>void 0===t?e.forEach(r=>r.disconnect()):"number"==typeof t?zs(s,e,t).disconnect():Cn(t)?void 0===n?e.forEach(r=>r.disconnect(t)):void 0===i?zs(s,e,n).disconnect(t,0):zs(s,e,n).disconnect(t,0,i):void 0===n?e.forEach(r=>r.disconnect(t)):zs(s,e,n).disconnect(t,0))(De),Uo=new WeakMap,Uh=((s,e)=>t=>e(s,t))(Uo,Et),Gh=((s,e,t,n,i,r,a,c,u,f,d,p,v)=>(y,T,x,O)=>{if(0===O.numberOfInputs&&0===O.numberOfOutputs)throw u();const A=Array.isArray(O.outputChannelCount)?O.outputChannelCount:Array.from(O.outputChannelCount);if(A.some(Se=>Se<1))throw u();if(A.length!==O.numberOfOutputs)throw e();if("explicit"!==O.channelCountMode)throw u();const L=O.channelCount*O.numberOfInputs,Y=A.reduce((Se,Ue)=>Se+Ue,0),oe=void 0===x.parameterDescriptors?0:x.parameterDescriptors.length;if(L+oe>6||Y>6)throw u();const B=new MessageChannel,U=[],C=[];for(let Se=0;Se<O.numberOfInputs;Se+=1)U.push(a(y,{channelCount:O.channelCount,channelCountMode:O.channelCountMode,channelInterpretation:O.channelInterpretation,gain:1})),C.push(i(y,{channelCount:O.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:O.channelCount}));const I=[];if(void 0!==x.parameterDescriptors)for(const{defaultValue:Se,maxValue:Ue,minValue:Mt,name:dt}of x.parameterDescriptors){const tt=r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==O.parameterData[dt]?O.parameterData[dt]:void 0===Se?0:Se});Object.defineProperties(tt.offset,{defaultValue:{get:()=>void 0===Se?0:Se},maxValue:{get:()=>void 0===Ue?P:Ue},minValue:{get:()=>void 0===Mt?ie:Mt}}),I.push(tt)}const ae=n(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,L+oe)}),ke=fo(T,y.sampleRate),ge=c(y,ke,L+oe,Math.max(1,Y)),z=i(y,{channelCount:Math.max(1,Y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,Y)}),Re=[];for(let Se=0;Se<O.numberOfOutputs;Se+=1)Re.push(n(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:A[Se]}));for(let Se=0;Se<O.numberOfInputs;Se+=1){U[Se].connect(C[Se]);for(let Ue=0;Ue<O.channelCount;Ue+=1)C[Se].connect(ae,Ue,Se*O.channelCount+Ue)}const ee=new ao(void 0===x.parameterDescriptors?[]:x.parameterDescriptors.map(({name:Se},Ue)=>{const Mt=I[Ue];return Mt.connect(ae,0,L+Ue),Mt.start(0),[Se,Mt.offset]}));ae.connect(ge);let ve=O.channelInterpretation,Te=null;const Ne=0===O.numberOfOutputs?[ge]:Re,je={get bufferSize(){return ke},get channelCount(){return O.channelCount},set channelCount(Se){throw t()},get channelCountMode(){return O.channelCountMode},set channelCountMode(Se){throw t()},get channelInterpretation(){return ve},set channelInterpretation(Se){for(const Ue of U)Ue.channelInterpretation=Se;ve=Se},get context(){return ge.context},get inputs(){return U},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get onprocessorerror(){return Te},set onprocessorerror(Se){"function"==typeof Te&&je.removeEventListener("processorerror",Te),Te="function"==typeof Se?Se:null,"function"==typeof Te&&je.addEventListener("processorerror",Te)},get parameters(){return ee},get port(){return B.port2},addEventListener:(...Se)=>ge.addEventListener(Se[0],Se[1],Se[2]),connect:s.bind(null,Ne),disconnect:f.bind(null,Ne),dispatchEvent:(...Se)=>ge.dispatchEvent(Se[0]),removeEventListener:(...Se)=>ge.removeEventListener(Se[0],Se[1],Se[2])},Le=new Map;var Se;B.port1.addEventListener=(Se=B.port1.addEventListener,(...Ue)=>{if("message"===Ue[0]){const Mt="function"==typeof Ue[1]?Ue[1]:"object"==typeof Ue[1]&&null!==Ue[1]&&"function"==typeof Ue[1].handleEvent?Ue[1].handleEvent:null;if(null!==Mt){const dt=Le.get(Ue[1]);void 0!==dt?Ue[1]=dt:(Ue[1]=tt=>{d(y.currentTime,y.sampleRate,()=>Mt(tt))},Le.set(Mt,Ue[1]))}}return Se.call(B.port1,Ue[0],Ue[1],Ue[2])}),B.port1.removeEventListener=(Se=>(...Ue)=>{if("message"===Ue[0]){const Mt=Le.get(Ue[1]);void 0!==Mt&&(Le.delete(Ue[1]),Ue[1]=Mt)}return Se.call(B.port1,Ue[0],Ue[1],Ue[2])})(B.port1.removeEventListener);let He=null;Object.defineProperty(B.port1,"onmessage",{get:()=>He,set:Se=>{"function"==typeof He&&B.port1.removeEventListener("message",He),He="function"==typeof Se?Se:null,"function"==typeof He&&(B.port1.addEventListener("message",He),B.port1.start())}}),x.prototype.port=B.port1;let et=null;((s,e,t,n)=>{let i=fe.get(s);void 0===i&&(i=new WeakMap,fe.set(s,i));const r=Du(t,n);return i.set(e,r),r})(y,je,x,O).then(Se=>et=Se);const rt=Gs(O.numberOfInputs,O.channelCount),jt=Gs(O.numberOfOutputs,A),Xt=void 0===x.parameterDescriptors?[]:x.parameterDescriptors.reduce((Se,{name:Ue})=>Be(te({},Se),{[Ue]:new Float32Array(128)}),{});let Gt=!0;const Je=()=>{O.numberOfOutputs>0&&ge.disconnect(z);for(let Se=0,Ue=0;Se<O.numberOfOutputs;Se+=1){const Mt=Re[Se];for(let dt=0;dt<A[Se];dt+=1)z.disconnect(Mt,Ue+dt,dt);Ue+=A[Se]}},_t=new Map;ge.onaudioprocess=({inputBuffer:Se,outputBuffer:Ue})=>{if(null!==et){const Mt=p(je);for(let dt=0;dt<ke;dt+=128){for(let tt=0;tt<O.numberOfInputs;tt+=1)for(let gt=0;gt<O.channelCount;gt+=1)Us(Se,rt[tt],gt,gt,dt);void 0!==x.parameterDescriptors&&x.parameterDescriptors.forEach(({name:tt},gt)=>{Us(Se,Xt,tt,L+gt,dt)});for(let tt=0;tt<O.numberOfInputs;tt+=1)for(let gt=0;gt<A[tt];gt+=1)0===jt[tt][gt].byteLength&&(jt[tt][gt]=new Float32Array(128));try{const tt=rt.map((sn,Nn)=>{if(Mt[Nn].size>0)return _t.set(Nn,ke/128),sn;const oo=_t.get(Nn);return void 0===oo?[]:(sn.every(nf=>nf.every(sf=>0===sf))&&(1===oo?_t.delete(Nn):_t.set(Nn,oo-1)),sn)});Gt=d(y.currentTime+dt/y.sampleRate,y.sampleRate,()=>et.process(tt,jt,Xt));for(let sn=0,Nn=0;sn<O.numberOfOutputs;sn+=1){for(let Ps=0;Ps<A[sn];Ps+=1)co(Ue,jt[sn],Ps,Nn+Ps,dt);Nn+=A[sn]}}catch(tt){Gt=!1,je.dispatchEvent(new ErrorEvent("processorerror",{colno:tt.colno,filename:tt.filename,lineno:tt.lineno,message:tt.message}))}if(!Gt){for(let tt=0;tt<O.numberOfInputs;tt+=1){U[tt].disconnect(C[tt]);for(let gt=0;gt<O.channelCount;gt+=1)C[dt].disconnect(ae,gt,tt*O.channelCount+gt)}if(void 0!==x.parameterDescriptors){const tt=x.parameterDescriptors.length;for(let gt=0;gt<tt;gt+=1){const sn=I[gt];sn.disconnect(ae,0,L+gt),sn.stop()}}ae.disconnect(ge),ge.onaudioprocess=null,Pt?Je():ds();break}}}};let Pt=!1;const Fe=a(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),hs=()=>ge.connect(Fe).connect(y.destination),ds=()=>{ge.disconnect(Fe),Fe.disconnect()};return hs(),v(je,()=>{if(Gt){ds(),O.numberOfOutputs>0&&ge.connect(z);for(let Se=0,Ue=0;Se<O.numberOfOutputs;Se+=1){const Mt=Re[Se];for(let dt=0;dt<A[Se];dt+=1)z.connect(Mt,Ue+dt,dt);Ue+=A[Se]}}Pt=!0},()=>{Gt&&(hs(),Je()),Pt=!1})})(jo,De,Ct,Rn,ms,Kn,Wt,_s,qt,Wo,Ni,Uh,Dn),zh=((s,e,t,n,i)=>(r,a,c,u,f,d)=>{if(null!==c)try{const p=new c(r,u,d),v=new Map;let y=null;if(Object.defineProperties(p,{channelCount:{get:()=>d.channelCount,set:()=>{throw s()}},channelCountMode:{get:()=>"explicit",set:()=>{throw s()}},onprocessorerror:{get:()=>y,set:T=>{"function"==typeof y&&p.removeEventListener("processorerror",y),y="function"==typeof T?T:null,"function"==typeof y&&p.addEventListener("processorerror",y)}}}),p.addEventListener=(T=p.addEventListener,(...x)=>{if("processorerror"===x[0]){const O="function"==typeof x[1]?x[1]:"object"==typeof x[1]&&null!==x[1]&&"function"==typeof x[1].handleEvent?x[1].handleEvent:null;if(null!==O){const A=v.get(x[1]);void 0!==A?x[1]=A:(x[1]=L=>{"error"===L.type?(Object.defineProperties(L,{type:{value:"processorerror"}}),O(L)):O(new ErrorEvent(x[0],te({},L)))},v.set(O,x[1]))}}return T.call(p,"error",x[1],x[2]),T.call(p,...x)}),p.removeEventListener=(T=>(...x)=>{if("processorerror"===x[0]){const O=v.get(x[1]);void 0!==O&&(v.delete(x[1]),x[1]=O)}return T.call(p,"error",x[1],x[2]),T.call(p,x[0],x[1],x[2])})(p.removeEventListener),0!==d.numberOfOutputs){const T=t(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return p.connect(T).connect(r.destination),i(p,()=>T.disconnect(),()=>T.connect(r.destination))}return p}catch(p){throw 11===p.code?n():p}var T;if(void 0===f)throw n();return(s=>{const{port1:e}=new MessageChannel;try{e.postMessage(s)}finally{e.close()}})(d),e(r,a,f,d)})(Ct,Gh,Wt,qt,Dn),Zh=((s,e,t,n,i,r,a,c,u,f,d,p,v,y,T,x)=>(O,A,L)=>{const Y=new WeakMap;let oe=null;const B=function(){var U=(0,G.Z)(function*(C,I){let ae=d(C),ke=null;const ge=ne(ae,I),z=Array.isArray(A.outputChannelCount)?A.outputChannelCount:Array.from(A.outputChannelCount);if(null===p){const Re=z.reduce((Ne,je)=>Ne+je,0),ee=i(I,{channelCount:Math.max(1,Re),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,Re)}),ve=[];for(let Ne=0;Ne<C.numberOfOutputs;Ne+=1)ve.push(n(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:z[Ne]}));const Te=a(I,{channelCount:A.channelCount,channelCountMode:A.channelCountMode,channelInterpretation:A.channelInterpretation,gain:1});Te.connect=e.bind(null,ve),Te.disconnect=u.bind(null,ve),ke=[ee,ve,Te]}else ge||(ae=new p(I,O));if(Y.set(I,null===ke?ae:ke[2]),null!==ke){if(null===oe){if(void 0===L)throw new Error("Missing the processor constructor.");if(null===v)throw new Error("Missing the native OfflineAudioContext constructor.");const je=C.channelCount*C.numberOfInputs,Le=void 0===L.parameterDescriptors?0:L.parameterDescriptors.length,He=je+Le;oe=za(C,0===He?null:yield function(){var lt=(0,G.Z)(function*(){const rt=new v(He,128*Math.ceil(C.context.length/128),I.sampleRate),jt=[],Xt=[];for(let _t=0;_t<A.numberOfInputs;_t+=1)jt.push(a(rt,{channelCount:A.channelCount,channelCountMode:A.channelCountMode,channelInterpretation:A.channelInterpretation,gain:1})),Xt.push(i(rt,{channelCount:A.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:A.channelCount}));const Gt=yield Promise.all(Array.from(C.parameters.values()).map(function(){var _t=(0,G.Z)(function*(Pt){const Fe=r(rt,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Pt.value});return yield y(rt,Pt,Fe.offset),Fe});return function(Pt){return _t.apply(this,arguments)}}())),Je=n(rt,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,je+Le)});for(let _t=0;_t<A.numberOfInputs;_t+=1){jt[_t].connect(Xt[_t]);for(let Pt=0;Pt<A.channelCount;Pt+=1)Xt[_t].connect(Je,Pt,_t*A.channelCount+Pt)}for(const[_t,Pt]of Gt.entries())Pt.connect(Je,0,je+_t),Pt.start(0);return Je.connect(rt.destination),yield Promise.all(jt.map(_t=>T(C,rt,_t))),x(rt)});return function(){return lt.apply(this,arguments)}}()(),I,A,z,L,f)}const Re=yield oe,ee=t(I,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[ve,Te,Ne]=ke;null!==Re&&(ee.buffer=Re,ee.start(0)),ee.connect(ve);for(let je=0,Le=0;je<C.numberOfOutputs;je+=1){const He=Te[je];for(let et=0;et<z[je];et+=1)ve.connect(He,Le+et,et);Le+=z[je]}return Ne}if(ge)for(const[Re,ee]of C.parameters.entries())yield s(I,ee,ae.parameters.get(Re));else for(const[Re,ee]of C.parameters.entries())yield y(I,ee,ae.parameters.get(Re));return yield T(C,I,ae),ae});return function(I,ae){return U.apply(this,arguments)}}();return{render(U,C){c(C,U);const I=Y.get(C);return void 0!==I?Promise.resolve(I):B(U,C)}}})(mn,jo,Jn,Rn,ms,Kn,Wt,Wh,Wo,Ni,Qe,$n,Ft,_n,It,Ys),Hh=(s=>e=>s.get(e))(Lo),Yh=(s=>(e,t)=>{s.set(e,t)})(Uo),Go=Vo?((s,e,t,n,i,r,a,c,u,f,d,p,v,y)=>class extends e{constructor(x,O,A){var L;const Y=c(x),oe=u(Y),B=(s=>Be(te({},s),{outputChannelCount:void 0!==s.outputChannelCount?s.outputChannelCount:1===s.numberOfInputs&&1===s.numberOfOutputs?[s.channelCount]:Array.from({length:s.numberOfOutputs},()=>1)}))(te(te({},Wa),A));(s=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(s)}finally{e.close(),t.close()}})(B);const U=qe.get(Y),C=null==U?void 0:U.get(O),I=oe||"closed"!==Y.state?Y:null!==(L=a(Y))&&void 0!==L?L:Y,ae=i(I,oe?null:x.baseLatency,f,O,C,B);super(x,!0,ae,oe?n(O,B,C):null);const ge=[];ae.parameters.forEach((Re,ee)=>{const ve=t(this,oe,Re);ge.push([ee,ve])}),this._nativeAudioWorkletNode=ae,this._onprocessorerror=null,this._parameters=new ao(ge),oe&&s(Y,this);const{activeInputs:z}=r(this);p(ae,z)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(x){const O="function"==typeof x?y(this,x):null;this._nativeAudioWorkletNode.onprocessorerror=O;const A=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==A&&A===O?x:A}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(jh,yt,an,Zh,zh,ot,Hh,at,st,$n,0,Yh,0,Qn):void 0,zo=((s,e)=>(t,n,i)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,n,i)}catch(r){throw"SyntaxError"===r.name?s():r}})(qt,Ft),Zo=((s,e,t,n,i,r,a,c)=>(u,f)=>t(u).render(u,f).then(()=>Promise.all(Array.from(n(f)).map(d=>t(d).render(d,f)))).then(()=>i(f)).then(d=>("function"!=typeof d.copyFromChannel?(a(d),Ie(d)):e(r,()=>r(d))||c(d),s.add(d),d)))(Ri,Zt,ki,Fi,Ys,H,Oi,Mi),Xh=((s,e,t,n,i)=>class extends s{constructor(a,c,u){let f;if("number"==typeof a&&void 0!==c&&void 0!==u)f={length:c,numberOfChannels:a,sampleRate:u};else{if("object"!=typeof a)throw new Error("The given parameters are not valid.");f=a}const{length:d,numberOfChannels:p,sampleRate:v}=te(te({},el),f),y=n(p,d,v);e(In,()=>In(y))||y.addEventListener("statechange",(()=>{let T=0;const x=O=>{"running"===this._state&&(T>0?(y.removeEventListener("statechange",x),O.stopImmediatePropagation(),this._waitForThePromiseToSettle(O)):T+=1)};return x})()),super(y,p),this._length=d,this._nativeOfflineAudioContext=y,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(t()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,Vt(this)}))}_waitForThePromiseToSettle(a){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}})(Bo,Zt,Ct,zo,Zo),Qh=((s,e)=>t=>{const n=s.get(t);return e(n)||e(t)})(le,Ci),$h=((s,e)=>t=>s.has(t)||e(t))(me,Di),Jh=((s,e)=>t=>s.has(t)||e(t))(Z,Co),Kh=((s,e)=>t=>{const n=s.get(t);return e(n)||e(t)})(le,st);var s;function ze(s,e){if(!s)throw new Error(e)}function On(s,e,t=1/0){if(!(e<=s&&s<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${s}`)}function Ho(s){!s.isOffline&&"running"!==s.state&&Yo('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Ii=console;function Yo(...s){Ii.warn(...s)}function en(s){return void 0===s}function $e(s){return!en(s)}function qn(s){return"number"==typeof s}function Vn(s){return"[object Object]"===Object.prototype.toString.call(s)&&s.constructor===Object}function cn(s){return Array.isArray(s)}function gn(s){return"string"==typeof s}function Qs(s){return gn(s)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(s)}function id(s,e,t){return new Xh(s,e,t)}const Ln="object"==typeof self?self:null,rd=Ln&&(Ln.hasOwnProperty("AudioContext")||Ln.hasOwnProperty("webkitAudioContext"));class ad{constructor(e,t,n){this._callback=e,this._type=t,this._updateInterval=n,this._createClock()}_createWorker(){const e=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(e){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*e,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function Bn(s){return Jh(s)}function Mn(s){return $h(s)}function $s(s){return Kh(s)}function es(s){return Qh(s)}function Xo(s){return s instanceof AudioBuffer}function cd(s,e){return"value"===s||Bn(e)||Mn(e)||Xo(e)}function ts(s,...e){if(!e.length)return s;const t=e.shift();if(Vn(s)&&Vn(t))for(const n in t)cd(n,t[n])?s[n]=t[n]:Vn(t[n])?(s[n]||Object.assign(s,{[n]:{}}),ts(s[n],t[n])):Object.assign(s,{[n]:t[n]});return ts(s,...e)}function _e(s,e,t=[],n){const i={},r=Array.from(e);if(Vn(r[0])&&n&&!Reflect.has(r[0],n)&&(Object.keys(r[0]).some(c=>Reflect.has(s,c))||(ts(i,{[n]:r[0]}),t.splice(t.indexOf(n),1),r.shift())),1===r.length&&Vn(r[0]))ts(i,r[0]);else for(let a=0;a<t.length;a++)$e(r[a])&&(i[t[a]]=r[a]);return ts(s,i)}function ns(s,e){return en(s)?e:s}function Qo(s,e){return e.forEach(t=>{Reflect.has(s,t)&&delete s[t]}),s}let En=(()=>{class s{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Ln&&this.toString()===Ln.TONE_DEBUG_CLASS)&&function ed(...s){Ii.log(...s)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}return s.version=Me,s})();const Pi=1e-6;function Js(s,e){return s>e+Pi}function qi(s,e){return Js(s,e)||un(s,e)}function $o(s,e){return s+Pi<e}function un(s,e){return Math.abs(s-e)<Pi}class vn extends En{constructor(){super(),this.name="Timeline",this._timeline=[];const e=_e(vn.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(ze(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length)ze(qi(e.time,this._timeline[this.length-1].time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e);else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}return this.length>this.memory&&this._timeline.splice(0,this.length-this.memory),this}remove(e){const t=this._timeline.indexOf(e);return-1!==t&&this._timeline.splice(t,1),this}get(e,t="time"){const n=this._search(e,t);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const n=this._search(e);return n-1>=0?this._timeline[n-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(un(this._timeline[t].time,e)){for(let n=t;n>=0&&un(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else 1===this._timeline.length&&qi(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let r=i;if(i>0&&this._timeline[i-1][t]<=e)return i-1;for(;n<r;){let a=Math.floor(n+(r-n)/2);const c=this._timeline[a],u=this._timeline[a+1];if(un(c[t],e)){for(let f=a;f<this._timeline.length&&un(this._timeline[f][t],e);f++)a=f;return a}if($o(c[t],e)&&Js(u[t],e))return a;Js(c[t],e)?r=a:n=a+1}return-1}_iterate(e,t=0,n=this._timeline.length-1){this._timeline.slice(t,n+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const n=this._search(e);return-1!==n&&this._iterate(t,0,n),this}forEachAfter(e,t){const n=this._search(e);return this._iterate(t,n+1),this}forEachBetween(e,t,n){let i=this._search(e),r=this._search(t);return-1!==i&&-1!==r?(this._timeline[i].time!==e&&(i+=1),this._timeline[r].time===t&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}forEachFrom(e,t){let n=this._search(e);for(;n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}forEachAtTime(e,t){const n=this._search(e);if(-1!==n&&un(this._timeline[n].time,e)){let i=n;for(let r=n;r>=0&&un(this._timeline[r].time,e);r--)i=r;this._iterate(r=>{t(r)},i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Jo=[];function Ks(s){Jo.push(s)}const Ko=[];function ei(s){Ko.push(s)}class vs extends En{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(i=>{en(this._events)&&(this._events={}),this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(t)}),this}once(e,t){const n=(...i)=>{t(...i),this.off(e,n)};return this.on(e,n),this}off(e,t){return e.split(/\W+/).forEach(i=>{if(en(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(en(t))this._events[e]=[];else{const r=this._events[e];for(let a=r.length-1;a>=0;a--)r[a]===t&&r.splice(a,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const n=this._events[e].slice(0);for(let i=0,r=n.length;i<r;i++)n[i].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const n=Object.getOwnPropertyDescriptor(vs.prototype,t);Object.defineProperty(e.prototype,t,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class ea extends vs{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class ys extends ea{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new vn,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const e=_e(ys.getDefaults(),arguments,["context"]);this._context=e.context?e.context:function sd(s){return new Bh(s)}({latencyHint:e.latencyHint}),this._ticker=new ad(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(function dd(s){Jo.forEach(e=>e(s))}(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,n){return this._context.createBuffer(e,t,n)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,n){return this._context.createPeriodicWave(e,t,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return ze(es(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return ze(es(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return ze(es(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){ze(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){ze(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){ze(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){ze(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return function od(s,e,t){return ze($e(Go),"This node only works in a secure context (https or localhost)"),new Go(s,e,t)}(this.rawContext,e,t)}addAudioWorkletModule(e,t){return(0,k.mG)(this,void 0,void 0,function*(){ze($e(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(t)})}workletsAreReady(){return(0,k.mG)(this,void 0,void 0,function*(){const e=[];this._workletModules.forEach(t=>e.push(t)),yield Promise.all(e)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let t=0;if(this._latencyHint=e,gn(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25}this.lookAhead=t,this.updateInterval=t/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return es(this._context)?this._context.resume():Promise.resolve()}close(){return(0,k.mG)(this,void 0,void 0,function*(){es(this._context)&&(yield this._context.close()),this._initialized&&function fd(s){Ko.forEach(e=>e(s))}(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0);for(let r=0;r<n.length;r++)n[r]=e;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=t,i.loop=!0,i.start(0),this._constants.set(e,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const n=++this._timeoutIds,i=()=>{const r=this.now();this._timeouts.add({callback:()=>{e(),i()},id:n,time:r+t})};return i(),n}}function mt(s,e){cn(e)?e.forEach(t=>mt(s,t)):Object.defineProperty(s,e,{enumerable:!0,writable:!1})}function ta(s,e){cn(e)?e.forEach(t=>ta(s,t)):Object.defineProperty(s,e,{writable:!0})}const it=()=>{};let Tn=(()=>{class s extends En{constructor(){super(),this.name="ToneAudioBuffer",this.onload=it;const t=_e(s.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&Xo(t.url)||t.url instanceof s?this.set(t.url):gn(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:it,onload:it,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:ln().sampleRate}set(t){return t instanceof s?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return(0,k.mG)(this,void 0,void 0,function*(){const n=s.load(t).then(i=>{this.set(i),this.onload(this)});s.downloads.push(n);try{yield n}finally{const i=s.downloads.indexOf(n);s.downloads.splice(i,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const n=cn(t)&&t[0].length>0,i=n?t.length:1,r=n?t[0].length:t.length,a=ln(),c=a.createBuffer(i,r,a.sampleRate),u=n||1!==i?t:[t];for(let f=0;f<i;f++)c.copyToChannel(u[f],f);return this._buffer=c,this}toMono(t){if(qn(t))this.fromArray(this.toArray(t));else{let n=new Float32Array(this.length);const i=this.numberOfChannels;for(let r=0;r<i;r++){const a=this.toArray(r);for(let c=0;c<a.length;c++)n[c]+=a[c]}n=n.map(r=>r/i),this.fromArray(n)}return this}toArray(t){if(qn(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const n=[];for(let i=0;i<this.numberOfChannels;i++)n[i]=this.getChannelData(i);return n}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,n=this.duration){const i=Math.floor(t*this.sampleRate),r=Math.floor(n*this.sampleRate);ze(i<r,"The start time must be less than the end time");const a=r-i,c=ln().createBuffer(this.numberOfChannels,a,this.sampleRate);for(let u=0;u<this.numberOfChannels;u++)c.copyToChannel(this.getChannelData(u).subarray(i,r),u);return new s(c)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new s).fromArray(t)}static fromUrl(t){return(0,k.mG)(this,void 0,void 0,function*(){return yield(new s).load(t)})}static load(t){return(0,k.mG)(this,void 0,void 0,function*(){const n=t.match(/\[([^\]\[]+\|.+)\]$/);if(n){const u=n[1].split("|");let f=u[0];for(const d of u)if(s.supportsType(d)){f=d;break}t=t.replace(n[0],f)}const i=""===s.baseUrl||s.baseUrl.endsWith("/")?s.baseUrl:s.baseUrl+"/",r=yield fetch(i+t);if(!r.ok)throw new Error(`could not load url: ${t}`);const a=yield r.arrayBuffer();return yield ln().decodeAudioData(a)})}static supportsType(t){const n=t.split("."),i=n[n.length-1];return""!==document.createElement("audio").canPlayType("audio/"+i)}static loaded(){return(0,k.mG)(this,void 0,void 0,function*(){for(yield Promise.resolve();s.downloads.length;)yield s.downloads[0]})}}return s.baseUrl="",s.downloads=[],s})();class Vi extends ys{constructor(){super({clockSource:"offline",context:$s(arguments[0])?arguments[0]:id(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:$s(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=$s(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return(0,k.mG)(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const n=Math.floor(this.sampleRate/128);e&&t%n==0&&(yield new Promise(i=>setTimeout(i,1)))}})}render(e=!0){return(0,k.mG)(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new Tn(t)})}close(){return Promise.resolve()}}const na=new class pd extends ea{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,n){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e,t){return(0,k.mG)(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}};let ss=na;function ln(){return ss===na&&rd&&function md(s){ss=es(s)?new ys(s):$s(s)?new Vi(s):s}(new ys),ss}function sa(){return ss.resume()}if(Ln&&!Ln.TONE_SILENCE_LOGGING){console.log(`%c * Tone.js ${"v"}${Me} * `,"background: #000; color: #fff")}function ia(s){return Math.pow(2,s/12)}let ti=440;function Li(s){return Math.round(ra(s))}function ra(s){return 69+12*Math.log2(s/ti)}class Bi extends En{constructor(e,t,n){super(),this.defaultUnits="s",this._val=t,this._units=n,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const n=parseInt(e,10),i="."===t?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(3*Math.floor(t)))},regexp:/^(\d+)t$/i},tr:{method:(e,t,n)=>{let i=0;return e&&"0"!==e&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(i+=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Bi&&this.fromType(this._val),en(this._val))return this._noArg();if(gn(this._val)&&en(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(Vn(this._val)){let e=0;for(const t in this._val)if($e(this._val[t])){const n=this._val[t];e+=new this.constructor(this.context,t).valueOf()*n}return e}if($e(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}return gn(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class tn extends Bi{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new tn(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const n=new this.constructor(this.context,e).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let r=1;r<9;r++){const a=Math.pow(2,r);t.push(a+"n."),t.push(a+"n"),t.push(a+"t")}t.push("0");let n=t[0],i=new tn(this.context,t[0]).toSeconds();return t.forEach(r=>{const a=new tn(this.context,r).toSeconds();Math.abs(a-e)<Math.abs(i-e)&&(n=r,i=a)}),n}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const n=Math.floor(t/this._getTimeSignature());let i=t%1*4;t=Math.floor(t)%this._getTimeSignature();const r=i.toString();return r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3))),[n,t,i].join(":")}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Li(this.toFrequency())}_now(){return this.context.now()}}class Ht extends tn{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return function vd(){return ti}()}static set A4(e){!function yd(s){ti=s}(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return"midi"===this.defaultUnits?e:Ht.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,t){const i=wd[e.toLowerCase()]+12*(parseInt(t,10)+1);return"midi"===this.defaultUnits?i:Ht.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,n){let i=1;return e&&"0"!==e&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(i*=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(e){return new Ht(this.context,this.valueOf()*ia(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return Li(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/Ht.A4);let n=Math.round(12*t)+57;const i=Math.floor(n/12);return i<0&&(n+=-12*i),Td[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(60*e/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return function bd(s){return ti*Math.pow(2,(s-69)/12)}(e)}static ftom(e){return Li(e)}}const wd={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Td=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class is extends tn{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Ut extends En{constructor(){super();const e=_e(Ut.getDefaults(),arguments,["context"]);this.context=this.defaultContext?this.defaultContext:e.context}static getDefaults(){return{context:ln()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new tn(this.context,e).toSeconds()}toFrequency(e){return new Ht(this.context,e).toFrequency()}toTicks(e){return new is(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(n=>{en(e[n])&&delete t[n]}),t}get(){const e=function ld(s){return s.constructor.getDefaults()}(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const n=this[t];$e(n)&&$e(n.value)&&$e(n.setValueAtTime)?e[t]=n.value:n instanceof Ut?e[t]=n._getPartialProperties(e[t]):cn(n)||qn(n)||gn(n)||function nd(s){return"boolean"==typeof s}(n)?e[t]=n:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&$e(this[t])&&(this[t]&&$e(this[t].value)&&$e(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof Ut?this[t].set(e[t]):this[t]=e[t])}),this}}class ji extends vn{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return null!==t?t.state:this._initial}setStateAtTime(e,t,n){return On(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}getLastState(e,t){for(let i=this._search(t);i>=0;i--){const r=this._timeline[i];if(r.state===e)return r}}getNextState(e,t){const n=this._search(t);if(-1!==n)for(let i=n;i<this._timeline.length;i++){const r=this._timeline[i];if(r.state===e)return r}}}class ut extends Ut{constructor(){super(_e(ut.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const e=_e(ut.getDefaults(),arguments,["param","units","convert"]);for(ze($e(e.param)&&(Bn(e.param)||e.param instanceof ut),"param must be an AudioParam");!Bn(e.param);)e.param=e.param._param;this._swappable=!!$e(e.swappable)&&e.swappable,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new vn(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,$e(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Ut.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return $e(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return $e(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return $e(this.maxValue)&&$e(this.minValue)&&On(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?function _d(s){return Math.pow(10,s/20)}(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&"decibels"===this.units?function gd(s){return Math.log(s)/Math.LN10*20}(e):e}setValueAtTime(e,t){const n=this.toSeconds(t),i=this._fromType(e);return ze(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),i=this._events.get(t);let r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let a=i.value;if("setTargetAtTime"===i.type){const c=this._events.getBefore(i.time);a=null===c?this._initialValue:c.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,a,n.time,n.value,t):this._exponentialInterpolate(i.time,a,n.time,n.value,t)}else r=i.value;else{const a=this._events.getBefore(i.time);let c;c=null===a?this._initialValue:a.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,c,i.value,i.constant,t))}return this._toType(r)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),0===this._fromType(t)&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const n=this._fromType(e),i=this.toSeconds(t);return ze(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(e,t){let n=this._fromType(e);n=un(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(t);return ze(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}linearRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}targetRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}exponentialApproachValueAtTime(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,i),this.cancelAndHoldAtTime(t+.9*n),this.linearRampToValueAtTime(e,t+n),this}setTargetAtTime(e,t,n){const i=this._fromType(e);ze(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(t);return this._assertRange(i),ze(isFinite(i)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",e,r,n),this._param.setTargetAtTime(i,r,n),this}setValueCurveAtTime(e,t,n,i=1){n=this.toSeconds(n),t=this.toSeconds(t);const r=this._fromType(e[0])*i;this.setValueAtTime(this._toType(r),t);const a=n/(e.length-1);for(let c=1;c<e.length;c++){const u=this._fromType(e[c])*i;this.linearRampToValueAtTime(this._toType(u),t+c*a)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return ze(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));ze(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);const i=this._events.get(t),r=this._events.getAfter(t);return i&&un(i.time,t)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),t):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}rampTo(e,t=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const n=this._events.get(t);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),r=i?i.time:t+2,a=(r-t)/10;for(let c=t;c<r;c+=a)e.linearRampToValueAtTime(this.getValueAtTime(c),c)}return this._events.forEachAfter(this.context.currentTime,i=>{"cancelScheduledValues"===i.type?e.cancelScheduledValues(i.time):"setTargetAtTime"===i.type?e.setTargetAtTime(i.value,i.time,i.constant):e[i.type](i.value,i.time)}),this}setParam(e){ze(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,n,i,r){return n+(t-n)*Math.exp(-(r-e)/i)}_linearInterpolate(e,t,n,i,r){return t+(r-e)/(n-e)*(i-t)}_exponentialInterpolate(e,t,n,i,r){return t*Math.pow(i/t,(r-e)/(n-e))}}class Xe extends Ut{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return $e(this.input)?Bn(this.input)||this.input instanceof ut?1:this.input.numberOfInputs:0}get numberOfOutputs(){return $e(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return $e(e)&&(e instanceof Xe||Mn(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(n=>{n.channelCount=e.channelCount,n.channelCountMode=e.channelCountMode,n.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();ze(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,n=0){return rs(this,e,t,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Yo("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,n=0){return function xd(s,e,t=0,n=0){if($e(e))for(;e instanceof Xe;)e=e.input;for(;!Mn(s);)$e(s.output)&&(s=s.output);Bn(e)?s.disconnect(e,t):Mn(e)?s.disconnect(e,t,n):s.disconnect()}(this,e,t,n),this}chain(...e){return Wi(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),$e(this.input)&&(this.input instanceof Xe?this.input.dispose():Mn(this.input)&&this.input.disconnect()),$e(this.output)&&(this.output instanceof Xe?this.output.dispose():Mn(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Wi(...s){const e=s.shift();s.reduce((t,n)=>(t instanceof Xe?t.connect(n):Mn(t)&&rs(t,n),n),e)}function rs(s,e,t=0,n=0){for(ze($e(s),"Cannot connect from undefined node"),ze($e(e),"Cannot connect to undefined node"),(e instanceof Xe||Mn(e))&&ze(e.numberOfInputs>0,"Cannot connect to node with no inputs"),ze(s.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Xe||e instanceof ut;)$e(e.input)&&(e=e.input);for(;s instanceof Xe;)$e(s.output)&&(s=s.output);Bn(e)?s.connect(e,t):s.connect(e,t,n)}class Bt extends Xe{constructor(){super(_e(Bt.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const e=_e(Bt.getDefaults(),arguments,["gain","units"]);this.gain=new ut({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),mt(this,"gain")}static getDefaults(){return Object.assign(Xe.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class os extends Xe{constructor(e){super(e),this.onended=it,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Bt({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const n=this.toSeconds(t);return-1!==this._startTime&&n>=this._startTime&&(-1===this._stopTime||n<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(Xe.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:it})}_startGain(e,t=1){ze(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){ze(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.context.currentTime),t>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const n="exponential"===this._curve?2*t:0;this._stopSource(this.now()+n),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==it&&(this.onended(this),this.onended=it,!this.context.isOffline)){const e=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),ze(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class ni extends os{constructor(){super(_e(ni.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const e=_e(ni.getDefaults(),arguments,["offset"]);rs(this._source,this._gainNode),this.offset=new ut({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(os.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Ot extends Xe{constructor(){super(_e(Ot.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const e=_e(Ot.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new ni({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Xe.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,n=0){return Ui(this,e,t,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,n){return this._param.exponentialRampTo(e,t,n),this}linearRampTo(e,t,n){return this._param.linearRampTo(e,t,n),this}targetRampTo(e,t,n){return this._param.targetRampTo(e,t,n),this}exponentialApproachValueAtTime(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}setTargetAtTime(e,t,n){return this._param.setTargetAtTime(e,t,n),this}setValueCurveAtTime(e,t,n,i){return this._param.setValueCurveAtTime(e,t,n,i),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,n){return this._param.rampTo(e,t,n),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function Ui(s,e,t,n){(e instanceof ut||Bn(e)||e instanceof Ot&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Ot&&(e.overridden=!0)),rs(s,e,t,n)}class si extends ut{constructor(){super(_e(si.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new vn(1/0),this._multiplier=1;const e=_e(si.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ut.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);const i=this._fromType(e),r=this._events.get(t),a=Math.round(Math.max(1/n,1));for(let c=0;c<=a;c++){const u=n*c+t,f=this._exponentialApproach(r.time,r.value,i,n,u);this.linearRampToValueAtTime(this._toType(f),u)}return this}setValueAtTime(e,t){const n=this.toSeconds(t);super.setValueAtTime(e,t);const i=this._events.get(n),r=this._events.previousEvent(i),a=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,t){const n=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const i=this._events.get(n),r=this._events.previousEvent(i),a=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const n=this._fromType(e),i=this._events.get(t),r=Math.round(Math.max(10*(t-i.time),1)),a=(t-i.time)/r;for(let c=0;c<=r;c++){const u=a*c+i.time,f=this._exponentialInterpolate(i.time,i.value,t,n,u);this.linearRampToValueAtTime(this._toType(f),u)}return this}_getTicksUntilEvent(e,t){if(null===e)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(en(e.ticks)){const a=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(a,e.time)}const n=this._fromType(this.getValueAtTime(e.time));let i=this._fromType(this.getValueAtTime(t));const r=this._events.get(t);return r&&r.time===t&&"setValueAtTime"===r.type&&(i=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(n+i)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}getDurationOfTicks(e,t){const n=this.toSeconds(t),i=this.getTicksAtTime(t);return this.getTimeOfTick(i+e)-n}getTimeOfTick(e){const t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&"linearRampToValueAtTime"===n.type&&t.value!==n.value){const i=this._fromType(this.getValueAtTime(t.time)),a=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-t.time),c=Math.sqrt(Math.pow(i,2)-2*a*(t.ticks-e)),u=(-i+c)/a,f=(-i-c)/a;return(u>0?u:f)+t.time}return t?0===t.value?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const n=this.toSeconds(t),i=this.toSeconds(e),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}_fromType(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class ii extends Ot{constructor(){super(_e(ii.getDefaults(),arguments,["value"])),this.name="TickSignal";const e=_e(ii.getDefaults(),arguments,["value"]);this.input=this._param=new si({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Ot.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class ri extends Ut{constructor(){super(_e(ri.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new ji,this._tickOffset=new vn;const e=_e(ri.getDefaults(),arguments,["frequency"]);this.frequency=new ii({context:this.context,units:e.units,value:e.frequency}),mt(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Ut.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const n=this.toSeconds(e);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),$e(t)&&this.setTicksAtTime(t,n)),this}stop(e){const t=this.toSeconds(e);if("stopped"===this._state.getValueAtTime(t)){const n=this._state.get(t);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}pause(e){const t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&this._state.setStateAtTime("paused",t),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),n=this._state.getLastState("stopped",t),i={state:"paused",time:t};this._state.add(i);let r=n,a=0;return this._state.forEachBetween(n.time,t+this.sampleTime,c=>{let u=r.time;const f=this._tickOffset.get(c.time);f&&f.time>=r.time&&(a=f.ticks,u=f.time),"started"===r.state&&"started"!==c.state&&(a+=this.frequency.getTicksAtTime(c.time)-this.frequency.getTicksAtTime(u)),r=c}),this._state.remove(i),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);let i=t,r=0;return this._state.forEachBetween(t.time,e+this.sampleTime,a=>{let c=i.time;const u=this._tickOffset.get(a.time);u&&u.time>=i.time&&(r=u.seconds,c=u.time),"started"===i.state&&"started"!==a.state&&(r+=a.time-c),i=a}),this._state.remove(n),r}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const n=this._tickOffset.get(t),i=this._state.get(t),r=Math.max(n.time,i.time),a=this.frequency.getTicksAtTime(r)+e-n.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,t,n){let i=this._state.get(e);this._state.forEachBetween(e,t,a=>{i&&"started"===i.state&&"started"!==a.state&&this.forEachTickBetween(Math.max(i.time,e),a.time-this.sampleTime,n),i=a});let r=null;if(i&&"started"===i.state){const a=Math.max(i.time,e),c=this.frequency.getTicksAtTime(a),f=c-this.frequency.getTicksAtTime(i.time);let d=Math.ceil(f)-f;d=un(d,1)?0:d;let p=this.frequency.getTimeOfTick(c+d);for(;p<t;){try{n(p,Math.round(this.getTicksAtTime(p)))}catch(v){r=v;break}p+=this.frequency.getDurationOfTicks(1,p)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class bs extends Ut{constructor(){super(_e(bs.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=it,this._lastUpdate=0,this._state=new ji("stopped"),this._boundLoop=this._loop.bind(this);const e=_e(bs.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new ri({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,mt(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Ut.getDefaults(),{callback:it,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){Ho(this.context);const n=this.toSeconds(e);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const n=this.toSeconds(t),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+e,n)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,n=>{switch(n.state){case"started":const i=this._tickSource.getTicksAtTime(n.time);this.emit("start",n.time,i);break;case"stopped":0!==n.time&&this.emit("stop",n.time);break;case"paused":this.emit("pause",n.time)}}),this._tickSource.forEachTickBetween(e,t,(n,i)=>{this.callback(n,i)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}vs.mixin(bs);class zi extends En{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=_e(zi.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++,this.add(t,e.urls[t],this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:it,onload:it,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return ze(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,0===this._loadingCount&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,n=it,i=it){return gn(t)?this._buffers.set(e.toString(),new Tn(this.baseUrl+t,n,i)):this._buffers.set(e.toString(),new Tn(t,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class yn extends is{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Sd extends Ut{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new vn,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Ks(s=>{s.draw=new Sd({context:s})}),ei(s=>{s.draw.dispose()});class Ad extends En{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){ze($e(e.time),"Events must have a time property"),ze($e(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new kd(e.time,e.time+e.duration,e);for(null===this._root?this._root=t:this._root.insert(t),this._length++;null!==t;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(null!==this._root){const t=[];this._root.search(e.time,t);for(const n of t)if(n.event===e){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(e,t){null!==e.parent?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(null===e.left&&null===e.right)this._replaceNodeInParent(e,null);else if(null===e.right)this._replaceNodeInParent(e,e.left);else if(null===e.left)this._replaceNodeInParent(e,e.right);else{let n,i=null;if(e.getBalance()>0)if(null===e.left.right)n=e.left,n.right=e.right,i=n;else{for(n=e.left.right;null!==n.right;)n=n.right;n.parent&&(n.parent.right=n.left,i=n.parent,n.left=e.left,n.right=e.right)}else if(null===e.right.left)n=e.right,n.left=e.left,i=n;else{for(n=e.right.left;null!==n.left;)n=n.left;n.parent&&(n.parent.left=n.right,i=n.parent,n.left=e.left,n.right=e.right)}null!==e.parent?e.isLeftChild()?e.parent.left=n:e.parent.right=n:this._setRoot(n),i&&this._rebalance(i)}e.dispose()}_rotateLeft(e){const t=e.parent,n=e.isLeftChild(),i=e.right;i&&(e.right=i.left,i.left=e),null!==t?n?t.left=i:t.right=i:this._setRoot(i)}_rotateRight(e){const t=e.parent,n=e.isLeftChild(),i=e.left;i&&(e.left=i.right,i.right=e),null!==t?n?t.left=i:t.right=i:this._setRoot(i)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(null!==this._root){const t=[];if(this._root.search(e,t),t.length>0){let n=t[0];for(let i=1;i<t.length;i++)t[i].low>n.low&&(n=t[i]);return n.event}}return null}forEach(e){if(null!==this._root){const t=[];this._root.traverse(n=>t.push(n)),t.forEach(n=>{n.event&&e(n.event)})}return this}forEachAtTime(e,t){if(null!==this._root){const n=[];this._root.search(e,n),n.forEach(i=>{i.event&&t(i.event)})}return this}forEachFrom(e,t){if(null!==this._root){const n=[];this._root.searchAfter(e,n),n.forEach(i=>{i.event&&t(i.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class kd{constructor(e,t,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?null===this.left?this.left=e:this.left.insert(e):null===this.right?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(null!==this.left&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&null!==this.right&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),null!==this.left&&this.left.searchAfter(e,t)),null!==this.right&&this.right.searchAfter(e,t)}traverse(e){e(this),null!==this.left&&this.left.traverse(e),null!==this.right&&this.right.traverse(e)}updateHeight(){this.height=null!==this.left&&null!==this.right?Math.max(this.left.height,this.right.height)+1:null!==this.right?this.right.height+1:null!==this.left?this.left.height+1:0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return null!==this.left&&null!==this.right?e=this.left.height-this.right.height:null!==this.left?e=this.left.height+1:null!==this.right&&(e=-(this.right.height+1)),e}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class jn extends Xe{constructor(){super(_e(jn.getDefaults(),arguments,["volume"])),this.name="Volume";const e=_e(jn.getDefaults(),arguments,["volume"]);this.input=this.output=new Bt({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,mt(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(Xe.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class oi extends Xe{constructor(){super(_e(oi.getDefaults(),arguments)),this.name="Destination",this.input=new jn({context:this.context}),this.output=new Bt({context:this.context}),this.volume=this.input.volume;const e=_e(oi.getDefaults(),arguments);Wi(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Xe.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),Wi(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Ks(s=>{s.destination=new oi({context:s})}),ei(s=>{s.destination.dispose()});class Cd extends En{constructor(e){super(),this.name="TimelineValue",this._timeline=new vn({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}let ai=(()=>{class s{constructor(t,n){this.id=s._eventId++;const i=Object.assign(s.getDefaults(),n);this.transport=t,this.callback=i.callback,this._once=i.once,this.time=i.time}static getDefaults(){return{callback:it,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}return s._eventId=0,s})();class Hi extends ai{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(Hi.getDefaults(),t);this.duration=new yn(e.context,n.duration).valueOf(),this._interval=new yn(e.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},ai.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){const t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new yn(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new yn(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new yn(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class ws extends Ut{constructor(){super(_e(ws.getDefaults(),arguments)),this.name="Transport",this._loop=new Cd(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new vn,this._repeatedEvents=new Ad,this._syncedSignals=[],this._swingAmount=0;const e=_e(ws.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new bs({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),mt(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(Ut.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!=0&&t%(2*this._swingTicks)!=0){const i=Math.sin(t%(2*this._swingTicks)/(2*this._swingTicks)*Math.PI)*this._swingAmount;e+=new yn(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(t,n=>n.invoke(e))}schedule(e,t){const n=new ai(this,{callback:e,time:new is(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(e,t,n,i=1/0){const r=new Hi(this,{callback:e,duration:new tn(this.context,i).toTicks(),interval:new tn(this.context,t).toTicks(),time:new is(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(e,t){const n=new ai(this,{callback:e,once:!0,time:new is(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,n=>this.clear(n.id)),this._repeatedEvents.forEachFrom(t,n=>this.clear(n.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new yn(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let n;return $e(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),"started"!==this._clock.getStateAtTime(e)?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){cn(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new tn(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new tn(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new yn(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new yn(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(t),r=t+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,t);this.emit("stop",r),this._clock.setTicksAtTime(e,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),"started"!==this.state)return 0;{const t=this.now(),n=this.getTicksAtTime(t);return this._clock.nextTickTime(e-n%e,t)}}syncSignal(e,t){if(!t){const i=this.now();if(0!==e.getValueAtTime(i)){const a=1/(60/this.bpm.getValueAtTime(i)/this.PPQ);t=e.getValueAtTime(i)/a}else t=0}const n=new Bt(t);return this.bpm.connect(n),n.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:n,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const n=this._syncedSignals[t];n.signal===e&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),ta(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}vs.mixin(ws),Ks(s=>{s.transport=new ws({context:s})}),ei(s=>{s.transport.dispose()});class Yt extends Xe{constructor(e){super(e),this.input=void 0,this._state=new ji("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=it,this._syncedStop=it,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new jn({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,mt(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(Xe.getDefaults(),{mute:!1,onstop:it,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,n){let i=en(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const r=this._state.get(i);r&&(r.offset=this.toSeconds(ns(t,0)),r.duration=n?this.toSeconds(n):void 0);const a=this.context.transport.schedule(c=>{this._start(c,t,n)},i);this._scheduled.push(a),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else Ho(this.context),this._start(i,t,n);else ze(Js(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,t,n);return this}stop(e){let t=en(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),"started"===this._state.getValueAtTime(t)||$e(this._state.getNextState("started",t))){if(this.log("stop",t),this._synced){const n=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(n)}else this._stop(t);this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,n){return e=this.toSeconds(e),"started"===this._state.getValueAtTime(e)&&(this._state.cancel(e),this._restart(e,t,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(t>0){const n=this._state.get(t);if(n&&"started"===n.state&&n.time!==t){const i=t-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-i),this._start(e,this.toSeconds(n.offset)+i,r)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));"started"===this._state.getValueAtTime(t)&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=it,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Ts extends os{constructor(){super(_e(Ts.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const e=_e(Ts.getDefaults(),arguments,["url","onload"]);rs(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new ut({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Tn(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(os.getDefaults(),{url:new Tn,loop:!1,loopEnd:0,loopStart:0,onload:it,onerror:it,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,n,i=1){ze(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(e);this._startGain(r,i),t=ns(t,this.loop?this.loopStart:0);let a=Math.max(this.toSeconds(t),0);if(this.loop){const c=this.toSeconds(this.loopEnd)||this.buffer.duration,u=this.toSeconds(this.loopStart),f=c-u;qi(a,c)&&(a=(a-u)%f+u),un(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,$o(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,a)),$e(n)){let c=this.toSeconds(n);c=Math.max(c,0),this.stop(r+c)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function Wn(s,e){return(0,k.mG)(this,void 0,void 0,function*(){const t=e/s.context.sampleRate,n=new Vi(1,t,s.context.sampleRate);return new s.constructor(Object.assign(s.get(),{frequency:2/t,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)})}class ci extends os{constructor(){super(_e(ci.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const e=_e(ci.getDefaults(),arguments,["frequency","type"]);rs(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new ut({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new ut({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),mt(this,["frequency","detune"])}static getDefaults(){return Object.assign(os.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}let nn=(()=>{class s extends Yt{constructor(){super(_e(s.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=_e(s.getDefaults(),arguments,["frequency","type"]);this.frequency=new Ot({context:this.context,units:"frequency",value:t.frequency}),mt(this,"frequency"),this.detune=new Ot({context:this.context,units:"cents",value:t.detune}),mt(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Yt.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const n=this.toSeconds(t),i=new ci({context:this.context,onended:()=>this.onstop(this)});this._oscillator=i,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}_stop(t){const n=this.toSeconds(t);this._oscillator&&this._oscillator.stop(n)}_restart(t){const n=this.toSeconds(t);return this.log("restart",n),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(n),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type)return s._periodicWaveCache.find(n=>n.phase===this._phase&&function ud(s,e){return s.length===e.length&&s.every((t,n)=>e[n]===t)}(n.partials,this._partials));{const t=s._periodicWaveCache.find(n=>n.type===this._type&&n.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const n=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&n)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const i=this._getCachedPeriodicWave();if($e(i)){const{partials:r,wave:a}=i;this._wave=a,this._partials=r,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[r,a]=this._getRealImaginary(t,this._phase),c=this.context.createPeriodicWave(r,a);this._wave=c,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),s._periodicWaveCache.push({imag:a,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type,wave:this._wave}),s._periodicWaveCache.length>100&&s._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.type=this.partialCount&&"custom"!==this._type&&"custom"!==t?t+this.partialCount:t}get partialCount(){return this._partialCount}set partialCount(t){On(t,0);let n=this._type;const i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(i&&(n=i[1]),"custom"!==this._type)this.type=0===t?n:n+t.toString();else{const r=new Float32Array(t);this._partials.forEach((a,c)=>r[c]=a),this._partials=Array.from(r),this.type=this._type}}_getRealImaginary(t,n){let r=2048;const a=new Float32Array(r),c=new Float32Array(r);let u=1;if("custom"===t){if(u=this._partials.length+1,this._partialCount=this._partials.length,r=u,0===this._partials.length)return[a,c]}else{const f=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);f?(u=parseInt(f[2],10)+1,this._partialCount=parseInt(f[2],10),t=f[1],u=Math.max(u,2),r=u):this._partialCount=0,this._partials=[]}for(let f=1;f<r;++f){const d=2/(f*Math.PI);let p;switch(t){case"sine":p=f<=u?1:0,this._partials[f-1]=p;break;case"square":p=1&f?2*d:0,this._partials[f-1]=p;break;case"sawtooth":p=d*(1&f?1:-1),this._partials[f-1]=p;break;case"triangle":p=1&f?d*d*2*(f-1>>1&1?-1:1):0,this._partials[f-1]=p;break;case"custom":p=this._partials[f-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==p?(a[f]=-p*Math.sin(n*f),c[f]=p*Math.cos(n*f)):(a[f]=0,c[f]=0)}return[a,c]}_inverseFFT(t,n,i){let r=0;const a=t.length;for(let c=0;c<a;c++)r+=t[c]*Math.cos(c*i)+n[c]*Math.sin(c*i);return r}getInitialValue(){const[t,n]=this._getRealImaginary(this._type,0);let i=0;const r=2*Math.PI;for(let c=0;c<32;c++)i=Math.max(this._inverseFFT(t,n,c/32*r),i);return function hd(s,e,t){return Math.max(Math.min(s,t),e)}(-this._inverseFFT(t,n,this._phase)/i,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return(0,k.mG)(this,void 0,void 0,function*(){return Wn(this,t)})}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}return s._periodicWaveCache=[],s})();class ui extends Xe{constructor(){super(Object.assign(_e(ui.getDefaults(),arguments,["context"])))}connect(e,t=0,n=0){return Ui(this,e,t,n),this}}class Ss extends ui{constructor(){super(Object.assign(_e(Ss.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const e=_e(Ss.getDefaults(),arguments,["mapping","length"]);cn(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):function td(s){return"function"==typeof s}(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Ot.getDefaults(),{length:1024})}setMap(e,t=1024){const n=new Float32Array(t);for(let i=0,r=t;i<r;i++)n[i]=e(i/(r-1)*2-1,i);return this.curve=n,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){ze(["none","2x","4x"].some(n=>n.includes(e)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Dd extends ui{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Ss({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Un extends Ot{constructor(){super(Object.assign(_e(Un.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const e=_e(Un.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Bt({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Ot.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class As extends Yt{constructor(){super(_e(As.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Dd({context:this.context}),this._modulationNode=new Bt({context:this.context});const e=_e(As.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new nn({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new nn({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Un({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),mt(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(nn.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return(0,k.mG)(this,void 0,void 0,function*(){return Wn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ks extends Yt{constructor(){super(_e(ks.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Bt({context:this.context,gain:0});const e=_e(ks.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new nn({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Ot({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new nn({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Un({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Un({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),mt(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(nn.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return(0,k.mG)(this,void 0,void 0,function*(){return Wn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class cs extends Yt{constructor(){super(_e(cs.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Bt({context:this.context,gain:0}),this._thresh=new Ss({context:this.context,mapping:t=>t<=0?-1:1});const e=_e(cs.getDefaults(),arguments,["frequency","width"]);this.width=new Ot({context:this.context,units:"audioRange",value:e.width}),this._triangle=new nn({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),mt(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Yt.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return(0,k.mG)(this,void 0,void 0,function*(){return Wn(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Cs extends Yt{constructor(){super(_e(Cs.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const e=_e(Cs.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Ot({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Ot({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,mt(this,["frequency","detune"])}static getDefaults(){return Object.assign(nn.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,n=e/(this._oscillators.length-1);this._forEach((i,r)=>i.detune.value=t+n*r)}}get count(){return this._oscillators.length}set count(e){if(On(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const n=new nn({context:this.context,volume:-6-1.1*e,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:0===t?()=>this.onstop(this):it});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[t]=n}this.spread=this._spread,"started"===this.state&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,n)=>t.phase=this._phase+n/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return(0,k.mG)(this,void 0,void 0,function*(){return Wn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class Ds extends Yt{constructor(){super(_e(Ds.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Un({context:this.context,value:2});const e=_e(Ds.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new cs({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new nn({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),mt(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Yt.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return(0,k.mG)(this,void 0,void 0,function*(){return Wn(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const aa={am:As,fat:Cs,fm:ks,oscillator:nn,pulse:cs,pwm:Ds};class Rs extends Yt{constructor(){super(_e(Rs.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const e=_e(Rs.getDefaults(),arguments,["frequency","type"]);this.frequency=new Ot({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Ot({context:this.context,units:"cents",value:e.detune}),mt(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(nn.getDefaults(),ks.getDefaults(),As.getDefaults(),Cs.getDefaults(),cs.getDefaults(),Ds.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){"fm"===e.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"am"===e.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"fat"===e.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):"pwm"===e?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===e?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=aa[e],n=this.now();if(this._oscillator){const i=this._oscillator;i.stop(n),this.context.setTimeout(()=>i.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(t=this._oscillator.type),"fm"===e?this.type="fm"+t:"am"===e?this.type="am"+t:"fat"===e?this.type="fat"+t:"oscillator"===e?this.type=t:"pulse"===e?this.type="pulse":"pwm"===e&&(this.type="pwm")}_getOscType(e,t){return e instanceof aa[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&"pulse"!==e&&"pwm"!==e&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&qn(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&qn(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&gn(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return(0,k.mG)(this,void 0,void 0,function*(){return Wn(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function la(s,e=1/0){const t=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(r){On(r,s,e),t.set(this,r)}})}}function Sn(s,e=1/0){const t=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(r){On(this.toSeconds(r),s,e),t.set(this,r)}})}}class Os extends Yt{constructor(){super(_e(Os.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const e=_e(Os.getDefaults(),arguments,["url","onload"]);this._buffer=new Tn({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Yt.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:it,onerror:it,playbackRate:1,reverse:!1})}load(e){return(0,k.mG)(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=it){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),0===this._activeSources.size&&!this._synced&&"started"===this._state.getValueAtTime(this.now())&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,n){return super.start(e,t,n),this}_start(e,t,n){t=ns(t,this._loop?this._loopStart:0);const i=this.toSeconds(t),r=n;n=ns(n,Math.max(this._buffer.duration-i,0));let a=this.toSeconds(n);a/=this._playbackRate,e=this.toSeconds(e);const c=new Ts({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(c),this._loop&&en(r)?c.start(e,i):c.start(e,i,a-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(n=>n.stop(t))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){this._stop(e),this._start(e,t,n)}seek(e,t){const n=this.toSeconds(t);if("started"===this._state.getValueAtTime(n)){const i=this.toSeconds(e);this._stop(n),this._start(n,i)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&On(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&On(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(i=>i.cancelStop())),this._activeSources.forEach(i=>{i.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}(0,k.gn)([Sn(0)],Os.prototype,"fadeIn",void 0),(0,k.gn)([Sn(0)],Os.prototype,"fadeOut",void 0);class An extends Xe{constructor(){super(_e(An.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Ot({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const e=_e(An.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(Xe.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(gn(e))return e;{let n;for(n in li)if(li[n][t]===e)return n;return e}}_setCurve(e,t,n){if(gn(n)&&Reflect.has(li,n)){const i=li[n];Vn(i)?"_decayCurve"!==e&&(this[e]=i[t]):this[e]=i}else{if(!cn(n)||"_decayCurve"===e)throw new Error("Envelope: invalid curve: "+n);this[e]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){ze(["linear","exponential"].some(t=>t===e),`Invalid envelope curve: ${e}`),this._decayCurve=e}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let i=this.toSeconds(this.attack);const r=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0&&(i=(1-a)/(1/i)),i<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if("linear"===this._attackCurve)this._sig.linearRampTo(t,i,e);else if("exponential"===this._attackCurve)this._sig.targetRampTo(t,i,e);else{this._sig.cancelAndHoldAtTime(e);let c=this._attackCurve;for(let u=1;u<c.length;u++)if(c[u-1]<=a&&a<=c[u]){c=this._attackCurve.slice(u),c[0]=a;break}this._sig.setValueCurveAtTime(c,e,i,t)}if(r&&this.sustain<1){const c=t*this.sustain,u=e+i;this.log("decay",u),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(c,r+u):this._sig.exponentialApproachValueAtTime(c,u,r)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,e):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,e):(ze(cn(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,n=1){return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,n=0){return Ui(this,e,t,n),this}asArray(e=1024){return(0,k.mG)(this,void 0,void 0,function*(){const t=e/this.context.sampleRate,n=new Vi(1,t,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),a=.1*r,c=r+a,u=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/c,decay:t*this.toSeconds(this.decay)/c,release:t*this.toSeconds(this.release)/c,context:n}));return u._sig.toDestination(),u.triggerAttackRelease(t*(i+a)/c,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}(0,k.gn)([Sn(0)],An.prototype,"attack",void 0),(0,k.gn)([Sn(0)],An.prototype,"decay",void 0),(0,k.gn)([la(0,1)],An.prototype,"sustain",void 0),(0,k.gn)([Sn(0)],An.prototype,"release",void 0);const li=(()=>{let e,t;const n=[];for(e=0;e<128;e++)n[e]=Math.sin(e/127*(Math.PI/2));const i=[];for(e=0;e<127;e++){t=e/127;const v=Math.sin(t*(2*Math.PI)*6.4-Math.PI/2)+1;i[e]=v/10+.83*t}i[127]=1;const a=[];for(e=0;e<128;e++)a[e]=Math.ceil(e/127*5)/5;const u=[];for(e=0;e<128;e++)t=e/127,u[e]=.5*(1-Math.cos(Math.PI*t));const f=[];for(e=0;e<128;e++){t=e/127;const v=4*Math.pow(t,3)+.2,y=Math.cos(v*Math.PI*2*t);f[e]=Math.abs(y*(1-t))}function d(v){const y=new Array(v.length);for(let T=0;T<v.length;T++)y[T]=1-v[T];return y}return{bounce:{In:d(f),Out:f},cosine:{In:n,Out:function p(v){return v.slice(0).reverse()}(n)},exponential:"exponential",linear:"linear",ripple:{In:i,Out:d(i)},sine:{In:u,Out:d(u)},step:{In:a,Out:d(a)}}})();class Gn extends Xe{constructor(){super(_e(Gn.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const e=_e(Gn.getDefaults(),arguments);this._volume=this.output=new jn({context:this.context,volume:e.volume}),this.volume=this._volume.volume,mt(this,"volume")}static getDefaults(){return Object.assign(Xe.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const n=this["_original_"+e]=this[e];this[e]=(...i)=>{const a=this.context.transport.schedule(c=>{i[t]=c,n.apply(this,i)},i[t]);this._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,t,n,i){const r=this.toSeconds(n),a=this.toSeconds(t);return this.triggerAttack(e,r,i),this.triggerRelease(r+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class zn extends Gn{constructor(){super(_e(zn.getDefaults(),arguments));const e=_e(zn.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Gn.getDefaults(),{detune:0,onsilence:it,portamento:0})}triggerAttack(e,t,n=1){this.log("triggerAttack",e,t,n);const i=this.toSeconds(t);return this._triggerEnvelopeAttack(i,n),this.setNote(e,i),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const n=this.toSeconds(t),i=e instanceof Ht?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const r=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,r,n)}else this.frequency.setValueAtTime(i,n);return this}}(0,k.gn)([Sn(0)],zn.prototype,"portamento",void 0);class sr extends An{constructor(){super(_e(sr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Bt({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class us extends zn{constructor(){super(_e(us.getDefaults(),arguments)),this.name="Synth";const e=_e(us.getDefaults(),arguments);this.oscillator=new Rs(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new sr(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),mt(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(zn.getDefaults(),{envelope:Object.assign(Qo(An.getDefaults(),Object.keys(Xe.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Qo(Rs.getDefaults(),[...Object.keys(Yt.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),0===this.envelope.sustain){const n=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+i)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Ms extends us{constructor(){super(_e(Ms.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const e=_e(Ms.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,mt(this,["oscillator","envelope"])}static getDefaults(){return ts(zn.getDefaults(),us.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const n=this.toSeconds(t),i=this.toFrequency(e instanceof Ht?e.toFrequency():e);return this.oscillator.frequency.setValueAtTime(i*this.octaves,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}(0,k.gn)([la(0)],Ms.prototype,"octaves",void 0),(0,k.gn)([Sn(0)],Ms.prototype,"pitchDecay",void 0);const fr=new Set;function pr(s){fr.add(s)}function ma(s,e){fr.add(`registerProcessor("${s}", ${e})`)}pr('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n'),pr("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n"),pr("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n"),ma("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Es extends Gn{constructor(){super(_e(Es.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const e=_e(Es.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(n=>{const i=parseInt(n,10);if(ze(Qs(n)||qn(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),Qs(n)){const r=new Ht(this.context,n).toMidi();t[r]=e.urls[n]}else qn(i)&&isFinite(i)&&(t[i]=e.urls[i])}),this._buffers=new zi({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Gn.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:it,onerror:it,release:.1,urls:{}})}_findClosest(e){let n=0;for(;n<96;){if(this._buffers.has(e+n))return-n;if(this._buffers.has(e-n))return n;n++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,n=1){return this.log("triggerAttack",e,t,n),Array.isArray(e)||(e=[e]),e.forEach(i=>{const r=ra(new Ht(this.context,i).toFrequency()),a=Math.round(r),c=r-a,u=this._findClosest(a),d=this._buffers.get(a-u),p=ia(u+c),v=new Ts({url:d,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:p}).connect(this.output);v.start(t,0,d.duration/p,n),cn(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(v),v.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){const y=this._activeSources.get(a),T=y.indexOf(v);-1!==T&&y.splice(T,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(n=>{const i=new Ht(this.context,n).toMidi();if(this._activeSources.has(i)&&this._activeSources.get(i).length){const r=this._activeSources.get(i);t=this.toSeconds(t),r.forEach(a=>{a.stop(t)}),this._activeSources.set(i,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(n=>{for(;n.length;)n.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,n,i=1){const r=this.toSeconds(n);return this.triggerAttack(e,r,i),cn(t)?(ze(cn(e),"notes must be an array when duration is array"),e.forEach((a,c)=>{const u=t[Math.min(c,t.length-1)];this.triggerRelease(a,r+this.toSeconds(u))})):this.triggerRelease(e,r+this.toSeconds(t)),this}add(e,t,n){if(ze(Qs(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Qs(e)){const i=new Ht(this.context,e).toMidi();this._buffers.add(i,t,n)}else this._buffers.add(e,t,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}(0,k.gn)([Sn(0)],Es.prototype,"attack",void 0),(0,k.gn)([Sn(0)],Es.prototype,"release",void 0);class di extends Xe{constructor(){super(Object.assign(_e(di.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const e=_e(di.getDefaults(),arguments,["pan"]);this.pan=new ut({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",mt(this,"pan")}static getDefaults(){return Object.assign(Xe.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}ma("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class bt extends Xe{constructor(){super(_e(bt.getDefaults(),arguments,["solo"])),this.name="Solo";const e=_e(bt.getDefaults(),arguments,["solo"]);this.input=this.output=new Bt({context:this.context}),bt._allSolos.has(this.context)||bt._allSolos.set(this.context,new Set),bt._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(Xe.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),bt._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){bt._soloed.has(this.context)||bt._soloed.set(this.context,new Set),bt._soloed.get(this.context).add(this)}_removeSolo(){bt._soloed.has(this.context)&&bt._soloed.get(this.context).delete(this)}_isSoloed(){return bt._soloed.has(this.context)&&bt._soloed.get(this.context).has(this)}_noSolos(){return!bt._soloed.has(this.context)||bt._soloed.has(this.context)&&0===bt._soloed.get(this.context).size}_updateSolo(){this.input.gain.value=this._isSoloed()||this._noSolos()?1:0}dispose(){return super.dispose(),bt._allSolos.get(this.context).delete(this),this._removeSolo(),this}}bt._allSolos=new Map,bt._soloed=new Map;class pi extends Xe{constructor(){super(_e(pi.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const e=_e(pi.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new di({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new jn({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,mt(this,["pan","volume"])}static getDefaults(){return Object.assign(Xe.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Zn extends Xe{constructor(){super(_e(Zn.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const e=_e(Zn.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new bt({solo:e.solo,context:this.context}),this._panVol=this.output=new pi({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),mt(this,["pan","volume"])}static getDefaults(){return Object.assign(Xe.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Zn.buses.has(e)||Zn.buses.set(e,new Bt({context:this.context})),Zn.buses.get(e)}send(e,t=0){const n=this._getBus(e),i=new Bt({context:this.context,units:"decibels",gain:t});return this.connect(i),i.connect(n),i}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Zn.buses=new Map;class Vd extends Xe{constructor(){super(...arguments),this.name="Listener",this.positionX=new ut({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new ut({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new ut({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new ut({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new ut({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new ut({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new ut({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new ut({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new ut({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Xe.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Ks(s=>{s.listener=new Vd({context:s})}),ei(s=>{s.listener.dispose()});const hn=ln().transport;ln(),ln(),ln(),ln(),ln();var _i=re(6461);const Ld=["slideRuler"];let Bd=(()=>{class s{constructor(t){this.pickerCtrl=t,this.noOfBeats=4,this.beatValue=4,this.btnCheck=!1,this.soundIsPlaying=!1}ngOnInit(){this._renderSlideRuler()}showPicker(t){return(0,k.mG)(this,void 0,void 0,function*(){if("beats"==t){let n={buttons:[{text:"Cancel",role:"cancel"},{text:"Done",role:"done"}],columns:[{name:"noOfBeats",options:[{text:"1",value:"1"},{text:"2",value:"2"},{text:"3",value:"3"},{text:"4",value:"4"},{text:"5",value:"5"},{text:"6",value:"6"},{text:"7",value:"7"},{text:"8",value:"8"},{text:"9",value:"9"},{text:"10",value:"10"},{text:"11",value:"11"},{text:"12",value:"12"}]}],cssClass:"timeSignaturePicker"};const i=yield this.pickerCtrl.create(n);yield i.present();const r=yield i.onDidDismiss();"done"===r.role&&(this.noOfBeats=r.data.noOfBeats.value,this.soundIsPlaying?(this.stop(),this.startMetronome(this.noOfBeats,this.beatValue)):this.startMetronome(this.noOfBeats,this.beatValue))}else{let n={buttons:[{text:"Cancel",role:"cancel"},{text:"Done",role:"done"}],columns:[{name:"beatValue",options:[{text:"2",value:"2"},{text:"4",value:"4"},{text:"8",value:"8"},{text:"16",value:"16"}]}],cssClass:"timeSignaturePicker"};const i=yield this.pickerCtrl.create(n);yield i.present();const r=yield i.onDidDismiss();"done"===r.role&&(this.beatValue=r.data.beatValue.value,this.soundIsPlaying?(this.stop(),this.startMetronome(this.noOfBeats,this.beatValue)):this.startMetronome(this.noOfBeats,this.beatValue))}})}_renderSlideRuler(){return console.log("slider: ",this.slideRuler),new(X())({el:this.slideRuler.nativeElement,maxValue:250,minValue:32,currentValue:60,handleValue:this.handleValue,precision:.5})}handleValue(t){hn.bpm.value=t}getBtnValue(t){t.detail.checked?(this.startMetronome(this.noOfBeats,this.beatValue),sa(),this.btnCheck=!0):(this.btnCheck=!1,this.soundIsPlaying=!1,this.stop())}startMetronome(t,n){console.log("no Of Beats: ",t),console.log("beat Value: ",n);var i=0;hn.bpm.value=60,hn.start();var r=new _i.Howl({src:["assets/sounds/metronome/woodblock.wav"],onplayerror:function(){r.once("unlock",function(){r.play()})}});hn.scheduleRepeat(function(){r.play(),i+=1,console.log("bar count: ",i),i==t&&(i=0),1==i&&(console.log("bar counter is 1"),new _i.Howl({src:["assets/sounds/metronome/woodblockFirstBeat.wav"]}).play())},"4n"),this.soundIsPlaying=!0}start(){hn.start()}stop(){hn.cancel(),this.soundIsPlaying=!1}}return s.\u0275fac=function(t){return new(t||s)(_.Y36(m.up))},s.\u0275cmp=_.Xpm({type:s,selectors:[["app-metronome"]],viewQuery:function(t,n){if(1&t&&_.Gf(Ld,7,_.SBq),2&t){let i;_.iGM(i=_.CRH())&&(n.slideRuler=i.first)}},decls:17,vars:3,consts:[[1,"Toolbar"],["slot","end"],["color","primary",3,"checked","ionChange"],["id","timeSigniture"],["color","light",3,"click"],["slideRuler",""],["id","values"],["id","app"]],template:function(t,n){1&t&&(_.TgZ(0,"ion-toolbar",0)(1,"ion-label")(2,"h1"),_._uU(3,"Metronome"),_.qZA()(),_.TgZ(4,"ion-buttons",1)(5,"ion-toggle",2),_.NdJ("ionChange",function(r){return n.getBtnValue(r)}),_.qZA()()(),_.TgZ(6,"ion-content")(7,"div",3)(8,"ion-card",4),_.NdJ("click",function(){return n.showPicker("beats")}),_._uU(9),_.qZA(),_.TgZ(10,"ion-card",4),_.NdJ("click",function(){return n.showPicker("value")}),_._uU(11),_.qZA()(),_.TgZ(12,"ion-item"),_._UZ(13,"div",null,5)(15,"div",6)(16,"div",7),_.qZA()()),2&t&&(_.xp6(5),_.Q6J("checked",n.btnCheck),_.xp6(4),_.Oqu(n.noOfBeats),_.xp6(2),_.Oqu(n.beatValue))},directives:[m.sr,m.Q$,m.Sm,m.ho,m.w,m.W2,m.PM,m.Ie],styles:[""],encapsulation:2}),s})(),Aa=(()=>{class s{constructor(){this.rotation=0,this.zoomScale="page-width",this.newRotation=new _.vpe,this.newZoomScale=new _.vpe}emitRotationChangeEvent(t){"l"==t?(this.rotation=this.rotation-90,this.newRotation.emit(this.rotation)):"r"==t&&(this.rotation=this.rotation+90,this.newRotation.emit(this.rotation))}getRotationChangeEmitter(){return this.newRotation}emitScaleChangeEvent(t){"page-width"==t?(this.zoomScale="page-width",this.newZoomScale.emit(this.zoomScale)):"page-fit"==t?(this.zoomScale="page-fit",this.newZoomScale.emit(this.zoomScale)):"page-height"==t&&(this.zoomScale="page-height",this.newZoomScale.emit(this.zoomScale))}geZoomScaleChangeEmitter(){return this.newZoomScale}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=_.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),jd=(()=>{class s{constructor(t){this.tools=t}ngOnInit(){}rotateLeft(){console.log("rotate left"),this.tools.emitRotationChangeEvent("l")}rotateRight(){this.tools.emitRotationChangeEvent("r")}zoomScale(t){this.tools.emitScaleChangeEvent(t)}}return s.\u0275fac=function(t){return new(t||s)(_.Y36(Aa))},s.\u0275cmp=_.Xpm({type:s,selectors:[["app-page-scale"]],inputs:{rotation:"rotation"},decls:15,vars:0,consts:[[1,"Toolbar"],["slot","start",3,"click"],["data-icon","ic:baseline-rotate-left",1,"iconify"],["slot","end",3,"click"],["data-icon","ic:baseline-rotate-right",1,"iconify"],[3,"click"]],template:function(t,n){1&t&&(_.TgZ(0,"ion-toolbar",0)(1,"ion-button",1),_.NdJ("click",function(){return n.rotateLeft()}),_._UZ(2,"span",2),_.qZA(),_.TgZ(3,"ion-button",3),_.NdJ("click",function(){return n.rotateRight()}),_._UZ(4,"span",4),_.qZA()(),_.TgZ(5,"ion-content")(6,"ion-item",5),_.NdJ("click",function(){return n.zoomScale("page-fit")}),_.TgZ(7,"ion-label"),_._uU(8,"Fit to screen"),_.qZA()(),_.TgZ(9,"ion-item",5),_.NdJ("click",function(){return n.zoomScale("page-width")}),_.TgZ(10,"ion-label"),_._uU(11,"Fit to width"),_.qZA()(),_.TgZ(12,"ion-item",5),_.NdJ("click",function(){return n.zoomScale("page-height")}),_.TgZ(13,"ion-label"),_._uU(14,"Fit to height"),_.qZA()()())},directives:[m.sr,m.YG,m.W2,m.Ie,m.Q$],styles:[""]}),s})();var ka=re(2313),ro=re(546);function Wd(s,e){if(1&s){const t=_.EpF();_.TgZ(0,"ion-item")(1,"ion-label",2),_.NdJ("click",function(){const r=_.CHM(t).$implicit;return _.oxw().playRec(r)}),_._uU(2),_.qZA()()}if(2&s){const t=e.$implicit;_.xp6(2),_.Oqu(t.name)}}let Ud=(()=>{class s{constructor(t,n,i){this.domSanitizer=t,this.ensembleService=n,this.modalCtrl2=i,this.currentRecording={id:0,scoreID:0,partID:0,name:"",base64:""},this.isRecording=!1,this.sound=new Audio,this.start=!0,this.stopIn=2e3,this.stopTime=0,this.stop=!1,this.timeTillStop=0}ngOnInit(){this.selectedPart&&(this.partID=this.selectedPart.partID),this.recordingCount=this.ensembleService.getRecordingsLength(),console.log("recording Count ngOnInit: ",this.recordingCount),this.recordings=this.ensembleService.getRecordingsByScoreID(this.scoreID),console.log("recording in score: ",this.recordings)}playRec(t){this.sound?(this.sound.src=t.base64,this.sound.play(),console.log("Part ID of the audio played: ",t.partID),console.log("sound playing: ",this.sound)):(this.sound.pause(),this.sound.currentTime=0)}closeModal(){this.modalCtrl2.dismiss("recordingClick")}ngOnDestroy(){this.currentRecording={id:0,scoreID:0,partID:0,name:"",base64:""},this.stop=!0}}return s.\u0275fac=function(t){return new(t||s)(_.Y36(ka.H7),_.Y36(ro.Z),_.Y36(m.IN))},s.\u0275cmp=_.Xpm({type:s,selectors:[["app-recording"]],inputs:{scoreID:"scoreID",selectedPart:"selectedPart"},decls:5,vars:1,consts:[[4,"ngFor","ngForOf"],["id","recording Buttons",3,"click"],[3,"click"]],template:function(t,n){1&t&&(_.TgZ(0,"ion-list"),_.YNc(1,Wd,3,1,"ion-item",0),_.qZA(),_.TgZ(2,"ion-item",1),_.NdJ("click",function(){return n.closeModal()}),_.TgZ(3,"ion-label"),_._uU(4,"New recording"),_.qZA()()),2&t&&(_.xp6(1),_.Q6J("ngForOf",n.recordings))},directives:[m.q_,J.sg,m.Ie,m.Q$],styles:[""]}),s})(),Gd=(()=>{class s{constructor(){this.btnCheck=!1,this.soundIsPlaying=!1}ngOnInit(){}playNote(t){this.currentlySelected=t,this.btnCheck=!0,this.soundIsPlaying&&(this.soundIsPlaying=!1,this.synth.triggerRelease("0")),this.synth=new us({volume:1}).toDestination(),this.synth.triggerAttackRelease(t,5),this.soundIsPlaying=!0}getBtnValue(t){t.detail.checked?this.btnCheck=!0:(this.btnCheck=!1,this.soundIsPlaying=!1,this.currentlySelected=null,this.synth.triggerRelease("0"))}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=_.Xpm({type:s,selectors:[["app-tuner"]],decls:19,vars:9,consts:[["color","primary","slot","end",3,"checked","ionChange"],[3,"click"]],template:function(t,n){1&t&&(_.TgZ(0,"ion-toolbar")(1,"ion-toggle",0),_.NdJ("ionChange",function(r){return n.getBtnValue(r)}),_.qZA()(),_.TgZ(2,"ion-list")(3,"ion-item",1),_.NdJ("click",function(){return n.playNote("C4")}),_.TgZ(4,"ion-label")(5,"h1"),_._uU(6,"C"),_.qZA()()(),_.TgZ(7,"ion-item",1),_.NdJ("click",function(){return n.playNote("D#4")}),_.TgZ(8,"ion-label")(9,"h1"),_._uU(10,"E\u266d"),_.qZA()()(),_.TgZ(11,"ion-item",1),_.NdJ("click",function(){return n.playNote("A5")}),_.TgZ(12,"ion-label")(13,"h1"),_._uU(14,"A"),_.qZA()()(),_.TgZ(15,"ion-item",1),_.NdJ("click",function(){return n.playNote("A#5")}),_.TgZ(16,"ion-label")(17,"h1"),_._uU(18,"B\u266d"),_.qZA()()()()),2&t&&(_.xp6(1),_.Q6J("checked",n.btnCheck),_.xp6(2),_.ekj("selected","C4"===n.currentlySelected),_.xp6(4),_.ekj("selected","D#4"===n.currentlySelected),_.xp6(4),_.ekj("selected","A5"===n.currentlySelected),_.xp6(4),_.ekj("selected","A#5"===n.currentlySelected))},directives:[m.sr,m.ho,m.w,m.q_,m.Ie,m.Q$],styles:["ion-item.selected[_ngcontent-%COMP%]{background-color:var(--ion-color-primary-light)}"]}),s})(),zd=(()=>{class s{constructor(t,n){this.ensembleSerivce=t,this.modalController=n,this.recordingName=""}ngOnInit(){console.log("current recording in confirm modal: ",this.currentRecording)}confirm(){console.log("change: ",this.recordingName),this.currentRecording.name=this.recordingName,this.ensembleSerivce.saveRecording("Recordings",this.currentRecording),this.modalController.dismiss()}ngOnDestroy(){this.currentRecording=void 0,this.recordingName=""}}return s.\u0275fac=function(t){return new(t||s)(_.Y36(ro.Z),_.Y36(m.IN))},s.\u0275cmp=_.Xpm({type:s,selectors:[["app-recording"]],inputs:{currentRecording:"currentRecording"},decls:7,vars:1,consts:[["id","nameInput","fill","solid"],["position","floating"],["clearInput","",3,"ngModel","ngModelChange"],["id","saveButton"],["expand","full","color","primary",3,"click"]],template:function(t,n){1&t&&(_.TgZ(0,"ion-item",0)(1,"ion-label",1),_._uU(2,"Name"),_.qZA(),_.TgZ(3,"ion-input",2),_.NdJ("ngModelChange",function(r){return n.recordingName=r}),_.qZA()(),_.TgZ(4,"ion-footer",3)(5,"ion-button",4),_.NdJ("click",function(){return n.confirm()}),_._uU(6,"Save"),_.qZA()()),2&t&&(_.xp6(3),_.Q6J("ngModel",n.recordingName))},directives:[m.Ie,m.Q$,m.pK,m.j9,q.JJ,q.On,m.fr,m.YG],styles:[""]}),s})();var Zd=re(5108),Ca=re(1737);function Hd(s,e){if(1&s){const t=_.EpF();_.TgZ(0,"div",7)(1,"div",8)(2,"ion-grid")(3,"ion-row")(4,"ion-col",9),_.NdJ("click",function(){return _.CHM(t),_.oxw().back()}),_.qZA(),_.TgZ(5,"ion-col",9),_.NdJ("click",function(){return _.CHM(t),_.oxw().forward()}),_.qZA()()()(),_.TgZ(6,"pdf-viewer",10),_.NdJ("pages-initialized",function(i){return _.CHM(t),_.oxw().pageInitialized(i)}),_.qZA()()}if(2&s){const t=_.oxw();_.xp6(6),_.Q6J("src",t.pdfSrc)("rotation",t.rotation)("original-size",!1)("show-all",!1)("fit-to-page",!1)("zoom",t.zoom)("zoom-scale",t.zoomScale)("stick-to-page",!1)("render-text",!0)("external-link-target","blank")("autoresize",!0)("show-borders",!1)("page",t.currentPage)}}const Da=function(s){return["/tabs","tab2",s]};function Yd(s,e){if(1&s){const t=_.EpF();_.TgZ(0,"ion-footer")(1,"ion-toolbar",11)(2,"ion-row")(3,"ion-col",12),_._UZ(4,"span",13),_.qZA(),_.TgZ(5,"ion-col",14),_.NdJ("click",function(){return _.CHM(t),_.oxw().recordingModal()}),_._UZ(6,"ion-icon",15),_.qZA(),_.TgZ(7,"ion-col",14),_.NdJ("click",function(){return _.CHM(t),_.oxw().showMetornomeModal()}),_._UZ(8,"span",16),_.qZA(),_.TgZ(9,"ion-col"),_._UZ(10,"ion-icon",17),_.qZA(),_.TgZ(11,"ion-col"),_._UZ(12,"span",18),_.qZA(),_.TgZ(13,"ion-col"),_._UZ(14,"ion-icon",19),_.qZA(),_.TgZ(15,"ion-col"),_._UZ(16,"ion-icon",20),_.qZA()()()()}if(2&s){const t=_.oxw();_.xp6(3),_.Q6J("routerLink",_.VKq(1,Da,t.scoreID))}}function Xd(s,e){if(1&s&&(_.TgZ(0,"div",26),_._uU(1),_.qZA()),2&s){const t=_.oxw(3);_.xp6(1),_.Oqu(t.timeTillStop)}}function Qd(s,e){if(1&s){const t=_.EpF();_.TgZ(0,"ion-col",14),_.NdJ("click",function(){return _.CHM(t),_.oxw(2).recordingModal()}),_._UZ(1,"ion-icon",15),_.YNc(2,Xd,2,1,"div",25),_.qZA()}if(2&s){const t=_.oxw(2);_.xp6(2),_.Q6J("ngIf",t.timeTillStop>0)}}function $d(s,e){if(1&s){const t=_.EpF();_.TgZ(0,"ion-col",27),_.NdJ("click",function(){return _.CHM(t),_.oxw(2).stopRecording()}),_._UZ(1,"ion-icon",28),_.qZA()}}function Jd(s,e){if(1&s){const t=_.EpF();_.TgZ(0,"ion-footer")(1,"ion-toolbar",11)(2,"ion-row")(3,"ion-col",12),_._UZ(4,"span",13),_.qZA(),_.YNc(5,Qd,3,1,"ion-col",21),_.YNc(6,$d,2,0,"ion-col",22),_.TgZ(7,"ion-col",14),_.NdJ("click",function(){return _.CHM(t),_.oxw().showMetornomeModal()}),_._UZ(8,"span",16),_.qZA(),_.TgZ(9,"ion-col",14),_.NdJ("click",function(i){return _.CHM(t),_.oxw().showTunerPopover(i)}),_._UZ(10,"span",23),_.qZA(),_.TgZ(11,"ion-col",14),_.NdJ("click",function(i){return _.CHM(t),_.oxw().pageOptions(i)}),_._UZ(12,"ion-icon",24),_.qZA(),_.TgZ(13,"ion-col"),_._UZ(14,"ion-icon",20),_.qZA()()()()}if(2&s){const t=_.oxw();_.xp6(3),_.Q6J("routerLink",_.VKq(3,Da,t.scoreID)),_.xp6(2),_.Q6J("ngIf",!t.isRecording),_.xp6(1),_.Q6J("ngIf",t.isRecording)}}let Ra=(()=>{class s{constructor(t,n,i,r,a,c,u){this.route=t,this.ensembleService=n,this.tools=i,this.popoverController=r,this.modalCtrl=a,this.modalCtrl2=c,this.domSanitizer=u,this.rotation=0,this.zoom=1,this.currentPage=1,this.currentRecording={id:0,scoreID:0,partID:0,name:"",base64:""},this.isRecording=!1,this.sound=new Audio,this.metronomeIsPlaying=!1,this.countdownBegan=!1,this.stopIn=5e3,this.stopTime=0,this.stop=!1,this.timeTillStop=0}handleValue(t){console.log(t)}ngOnInit(){if(this.countdownBegan=!1,console.log("in score page"),this.scoreID=parseInt(this.route.snapshot.params.scoreID),this.selectedScore=this.ensembleService.getScoreByID(this.scoreID),this.partID=parseInt(this.route.snapshot.params.scorePart),console.log("PARTID: ",this.partID),0==this.partID?(console.log("PART ID IS: ",this.partID),this.pdfSrc=this.selectedScore.fullScorePath):this.selectedPart=this.selectedScore.parts[this.partID-1],"static"==this.selectedScore.type&&(console.log("static score"),0!=this.partID&&(this.pdfSrc=this.selectedPart.partPath,console.log("Selected score: ",this.selectedScore))),"interactive"==this.selectedScore.type){console.log("interactive score");const t=document.getElementById("sheetmusic"),n=new(ue())(t,{embedParams:{appId:"62042cdc7544f10012e789e6",controlsPosition:"top",layout:"responsive",videoPosition:"top",branding:"false",controlDisplay:"true",controlsParts:"true",themePrimary:"#0B1A33"}});fetch(this.selectedScore.fullScorePath).then(i=>i.text()).then(i=>n.loadMusicXML(i)).then(()=>n.setTrack({id:"aflat",type:"youtube",mediaId:this.selectedScore.videoPath,synchronizationPoints:[{type:"measure",time:this.selectedScore.videoStart,location:{measureIdx:0}},{type:"end",time:this.selectedScore.videoEnd}]})).then(()=>n.useTrack({id:"aflat"})).catch(i=>console.error(i))}}back(){1!=this.currentPage&&(this.currentPage=this.currentPage-1)}forward(){this.currentPage!=this.noOfPages&&(this.currentPage=this.currentPage+1)}pageInitialized(t){this.noOfPages=t.source._pages.length}showMetornomeModal(){return(0,k.mG)(this,void 0,void 0,function*(){yield(yield this.modalCtrl.create({component:Bd,cssClass:"metronomeModal"})).present()})}startMetronome(t,n){sa();var i=0;hn.bpm.value=60,hn.start();var r=new _i.Howl({src:["assets/sounds/metronome/woodblock.wav"],onplayerror:function(){r.once("unlock",function(){r.play()})}});hn.scheduleRepeat(function(){r.play(),i+=1,console.log("bar count: ",i),i==t&&(i=0),1==i&&(console.log("bar counter is 1"),new _i.Howl({src:["assets/sounds/metronome/woodblockFirstBeat.wav"]}).play())},"4n"),this.metronomeIsPlaying=!0}startPlaying(){hn.start()}stopMetronome(){hn.cancel(),this.metronomeIsPlaying=!1}showTunerPopover(t){return(0,k.mG)(this,void 0,void 0,function*(){const n=yield this.popoverController.create({component:Gd,cssClass:"tunerPopover",event:t,translucent:!0});yield n.present();const{role:i}=yield n.onDidDismiss();console.log("onDidDismiss resolved with role",i)})}pageOptions(t){return(0,k.mG)(this,void 0,void 0,function*(){const n=yield this.popoverController.create({component:jd,componentProps:{rotation:this.rotation},cssClass:"pageScalePopover",event:t,translucent:!0});yield n.present(),this.rotationSubscription=this.tools.getRotationChangeEmitter().subscribe(i=>this.selectedRotation(i)),this.zoomScale="page-width",this.zoomScaleSubscription=this.tools.geZoomScaleChangeEmitter().subscribe(i=>this.selectedZoomScale(i)),yield n.onDidDismiss().then(i=>this.ngOnDestroy(),i=>console.log("Error: ",i))})}selectedRotation(t){this.rotation=t,console.log("currently in selectedRotation func")}selectedZoomScale(t){this.zoomScale=t,console.log("selecged zoom scale func: ",this.zoomScale)}recordingModal(){return(0,k.mG)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:Ud,componentProps:{scoreID:this.scoreID,selectedPart:this.selectedPart},cssClass:"recordingModal"});yield t.present(),t.onDidDismiss().then(n=>{"recordingClick"==n.data&&(this.startCountdown(),this.countdownBegan=!0)})})}startCountdown(){requestAnimationFrame(this.update.bind(this)),this.startMetronome(4,4)}update(t){this.countdownBegan?(this.stopTime=t+this.stopIn,this.countdownBegan=!1):t>=this.stopTime&&(this.stop=!0),this.timeTillStop=this.stopTime-t,console.log("time: ",Math.floor(this.timeTillStop/1e3)),this.timeTillStop=Math.floor(this.timeTillStop/1e3),this.stop?(console.log("countdown end"),this.initiateRecording()):requestAnimationFrame(this.update.bind(this))}initiateRecording(){this.isRecording=!0,navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(this.successCallback.bind(this),this.errorCallback.bind(this))}successCallback(t){this.tempRecord=new(0,Zd.StereoAudioRecorder)(t,{mimeType:"audio/wav",numberOfAudioChannels:1,desiredSampRate:16e3}),this.tempRecord.record()}stopRecording(){this.isRecording=!1,this.tempRecord.stop(this.processRecording.bind(this)),this.stopMetronome()}processRecording(t){return(0,k.mG)(this,void 0,void 0,function*(){this.url=URL.createObjectURL(t),console.log("blob: ",t),console.log(" url: ",this.url),console.log("view: ",this.tempRecord.view),console.log("newRecord: ",this.tempRecord),this.base64=yield this.blobToBase64(t),this.currentRecording.id=this.recordingCount+1,this.currentRecording.scoreID=this.scoreID,this.currentRecording.partID=this.partID,console.log("current recording part id: ",this.currentRecording.partID),this.currentRecording.name=this.newRecordingName,this.currentRecording.base64=this.base64,this.recordingconfirmModal(),this.currentRecording={id:0,scoreID:0,partID:0,name:"",base64:""},this.recordingCount=this.ensembleService.getRecordingsLength()})}blobToBase64(t){return new Promise((n,i)=>{const r=new FileReader;r.onerror=i,r.onloadend=()=>n(r.result),r.readAsDataURL(t),console.log("base64 in function:",r)})}sanitize(t){console.log("url: ",t),this.domSanitizer.bypassSecurityTrustResourceUrl(t)}errorCallback(t){this.error="Can not play audio in your browser"}recordingconfirmModal(){return(0,k.mG)(this,void 0,void 0,function*(){yield(yield this.modalCtrl2.create({component:zd,componentProps:{currentRecording:this.currentRecording},cssClass:"recordingConfirmModal"})).present()})}ngOnDestroy(){null!=this.rotationSubscription&&this.rotationSubscription.unsubscribe(),null!=this.zoomScaleSubscription&&this.zoomScaleSubscription.unsubscribe(),this.isRecording&&this.stopRecording(),this.metronomeIsPlaying&&this.stopMetronome()}}return s.\u0275fac=function(t){return new(t||s)(_.Y36(E.gz),_.Y36(ro.Z),_.Y36(Aa),_.Y36(m.Dh),_.Y36(m.IN),_.Y36(m.IN),_.Y36(ka.H7))},s.\u0275cmp=_.Xpm({type:s,selectors:[["app-score"]],decls:9,vars:4,consts:[[3,"fullscreen"],["class","pdf-container",4,"ngIf"],["id","sheetmusic"],["slideRuler",""],["id","values"],["id","app"],[4,"ngIf"],[1,"pdf-container"],["id","pageSelector"],["size","6",3,"click"],[3,"src","rotation","original-size","show-all","fit-to-page","zoom","zoom-scale","stick-to-page","render-text","external-link-target","autoresize","show-borders","page","pages-initialized"],["color","light"],[3,"routerLink"],["data-icon","ic:baseline-home",1,"iconify"],[3,"click"],["name","mic"],["data-icon","mdi:metronome",1,"iconify"],["name","play-circle"],["data-icon","mdi:brush",1,"iconify"],["name","volume-medium"],["name","information-circle"],[3,"click",4,"ngIf"],["id","stopButton",3,"click",4,"ngIf"],["data-icon","arcticons:universal-tuner",1,"iconify"],["name","document"],["id","countdownNumber",4,"ngIf"],["id","countdownNumber"],["id","stopButton",3,"click"],["name","stop-circle","color","danger"]],template:function(t,n){1&t&&(_.TgZ(0,"ion-content",0),_.YNc(1,Hd,7,13,"div",1),_._UZ(2,"div",2),_.qZA(),_._UZ(3,"div",null,3)(5,"div",4)(6,"div",5),_.YNc(7,Yd,17,3,"ion-footer",6),_.YNc(8,Jd,15,5,"ion-footer",6)),2&t&&(_.Q6J("fullscreen",!0),_.xp6(1),_.Q6J("ngIf","static"==n.selectedScore.type),_.xp6(6),_.Q6J("ngIf","interactive"==n.selectedScore.type),_.xp6(1),_.Q6J("ngIf","static"==n.selectedScore.type))},directives:[m.W2,J.O5,m.jY,m.Nd,m.wI,Ca.rQ,m.fr,m.sr,m.YI,E.rH,m.gu],styles:["ion-content[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0}#sheetmusic[_ngcontent-%COMP%]{height:100%}ion-row[_ngcontent-%COMP%]{position:relative}#pageSelector[_ngcontent-%COMP%]{position:absolute;height:100vh;width:100%;z-index:1000}#pageSelector[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:100% 0}ion-tab-bar[_ngcontent-%COMP%]{display:none!important}#countdownNumber[_ngcontent-%COMP%]{color:red;display:inline-block;font-weight:500}"]}),s})();const Kd=[{path:"",children:[{path:"",component:Ra},{path:":scoreID",component:Ra}]}];let ef=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=_.oAB({type:s}),s.\u0275inj=_.cJS({imports:[[E.Bz.forChild(Kd),J.ez],E.Bz,J.ez]}),s})(),tf=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=_.oAB({type:s}),s.\u0275inj=_.cJS({imports:[[J.ez,q.u5,m.Pc,ef,Ca.xC]]}),s})()},8021:function(xe,Oe,re){!function(J,q,m,E){"use strict";function k(Ve){return Ve&&"object"==typeof Ve&&"default"in Ve?Ve:{default:Ve}}var he=k(q),ue=k(m),_=k(E),se=function(ye,w,l){return{endTime:w,insertTime:l,type:"exponentialRampToValue",value:ye}},X=function(ye,w,l){return{endTime:w,insertTime:l,type:"linearRampToValue",value:ye}},Me=function(ye,w){return{startTime:w,type:"setValue",value:ye}},o=function(ye,w,l){return{duration:l,startTime:w,type:"setValueCurve",values:ye}},h=function(ye,w,l){var D=l.target;return D+(w-D)*Math.exp((l.startTime-ye)/l.timeConstant)},g=function(ye){return"exponentialRampToValue"===ye.type},S=function(ye){return"linearRampToValue"===ye.type},F=function(ye){return g(ye)||S(ye)},V=function(ye){return"setValue"===ye.type},M=function(ye){return"setValueCurve"===ye.type},me=function Ve(ye,w,l,b){var D=ye[w];return void 0===D?b:F(D)||V(D)?D.value:M(D)?D.values[D.values.length-1]:h(l,Ve(ye,w-1,D.startTime,b),D)},Ee=function(ye,w,l,b,D){return void 0===l?[b.insertTime,D]:F(l)?[l.endTime,l.value]:V(l)?[l.startTime,l.value]:M(l)?[l.startTime+l.duration,l.values[l.values.length-1]]:[l.startTime,me(ye,w-1,l.startTime,D)]},Z=function(ye){return"cancelAndHold"===ye.type},le=function(ye){return"cancelScheduledValues"===ye.type},be=function(ye){return Z(ye)||le(ye)?ye.cancelTime:g(ye)||S(ye)?ye.endTime:ye.startTime},Pe=function(ye,w,l,b){var j=b.value;return l===j?j:0<l&&0<j||l<0&&j<0?l*Math.pow(j/l,(ye-w)/(b.endTime-w)):0},qe=function(ye,w,l,b){return l+(ye-w)/(b.endTime-w)*(b.value-l)},Ye=function(ye,w){var D=w.values;return function(ye,w){var l=Math.floor(w),b=Math.ceil(w);return l===b?ye[l]:(1-(w-l))*ye[l]+(1-(b-w))*ye[b]}(D,(ye-w.startTime)/w.duration*(D.length-1))},We=function(ye){return"setTarget"===ye.type},nt=function(Ve){function ye(w){ue.default(this,ye),this._automationEvents=[],this._currenTime=0,this._defaultValue=w}return _.default(ye,[{key:Ve,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(l){var b=be(l);if(Z(l)||le(l)){var D=this._automationEvents.findIndex(function(ce){return le(l)&&M(ce)?ce.startTime+ce.duration>=b:be(ce)>=b}),j=this._automationEvents[D];if(-1!==D&&(this._automationEvents=this._automationEvents.slice(0,D)),Z(l)){var R=this._automationEvents[this._automationEvents.length-1];if(void 0!==j&&F(j)){if(We(R))throw new Error("The internal list is malformed.");var Q=M(R)?R.startTime+R.duration:be(R),N=M(R)?R.values[R.values.length-1]:R.value,de=g(j)?Pe(b,Q,N,j):qe(b,Q,N,j),Ce=g(j)?se(de,b,this._currenTime):X(de,b,this._currenTime);this._automationEvents.push(Ce)}void 0!==R&&We(R)&&this._automationEvents.push(Me(this.getValue(b),b)),void 0!==R&&M(R)&&R.startTime+R.duration>b&&(this._automationEvents[this._automationEvents.length-1]=o(new Float32Array([6,7]),R.startTime,b-R.startTime))}}else{var K=this._automationEvents.findIndex(function(ce){return be(ce)>b}),G=-1===K?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[K-1];if(void 0!==G&&M(G)&&be(G)+G.duration>b)return!1;var ne=g(l)?se(l.value,l.endTime,this._currenTime):S(l)?X(l.value,b,this._currenTime):l;if(-1===K)this._automationEvents.push(ne);else{if(M(l)&&b+l.duration>be(this._automationEvents[K]))return!1;this._automationEvents.splice(K,0,ne)}}return!0}},{key:"flush",value:function(l){var b=this._automationEvents.findIndex(function(R){return be(R)>l});if(b>1){var D=this._automationEvents.slice(b-1),j=D[0];We(j)&&D.unshift(Me(me(this._automationEvents,b-2,j.startTime,this._defaultValue),j.startTime)),this._automationEvents=D}}},{key:"getValue",value:function(l){if(0===this._automationEvents.length)return this._defaultValue;var b=this._automationEvents.findIndex(function(H){return be(H)>l}),D=this._automationEvents[b],j=(-1===b?this._automationEvents.length:b)-1,R=this._automationEvents[j];if(void 0!==R&&We(R)&&(void 0===D||!F(D)||D.insertTime>l))return h(l,me(this._automationEvents,j-1,R.startTime,this._defaultValue),R);if(void 0!==R&&V(R)&&(void 0===D||!F(D)))return R.value;if(void 0!==R&&M(R)&&(void 0===D||!F(D)||R.startTime+R.duration>l))return l<R.startTime+R.duration?Ye(l,R):R.values[R.values.length-1];if(void 0!==R&&F(R)&&(void 0===D||!F(D)))return R.value;if(void 0!==D&&g(D)){var Q=Ee(this._automationEvents,j,R,D,this._defaultValue),N=he.default(Q,2);return Pe(l,N[0],N[1],D)}if(void 0!==D&&S(D)){var K=Ee(this._automationEvents,j,R,D,this._defaultValue),G=he.default(K,2);return qe(l,G[0],G[1],D)}return this._defaultValue}}]),ye}(Symbol.iterator);J.AutomationEventList=nt,J.createCancelAndHoldAutomationEvent=function(ye){return{cancelTime:ye,type:"cancelAndHold"}},J.createCancelScheduledValuesAutomationEvent=function(ye){return{cancelTime:ye,type:"cancelScheduledValues"}},J.createExponentialRampToValueAutomationEvent=function(ye,w){return{endTime:w,type:"exponentialRampToValue",value:ye}},J.createLinearRampToValueAutomationEvent=function(ye,w){return{endTime:w,type:"linearRampToValue",value:ye}},J.createSetTargetAutomationEvent=function(ye,w,l){return{startTime:w,target:ye,timeConstant:l,type:"setTarget"}},J.createSetValueAutomationEvent=Me,J.createSetValueCurveAutomationEvent=o,Object.defineProperty(J,"__esModule",{value:!0})}(Oe,re(1428),re(785),re(2919))},6461:(xe,Oe)=>{var J;!function(){"use strict";var q=function(){this.init()};q.prototype={init:function(){var o=this||m;return o._counter=1e3,o._html5AudioPool=[],o.html5PoolSize=10,o._codecs={},o._howls=[],o._muted=!1,o._volume=1,o._canPlayEvent="canplaythrough",o._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,o.masterGain=null,o.noAudio=!1,o.usingWebAudio=!0,o.autoSuspend=!0,o.ctx=null,o.autoUnlock=!0,o._setup(),o},volume:function(o){var h=this||m;if(o=parseFloat(o),h.ctx||Me(),void 0!==o&&o>=0&&o<=1){if(h._volume=o,h._muted)return h;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(o,m.ctx.currentTime);for(var g=0;g<h._howls.length;g++)if(!h._howls[g]._webAudio)for(var S=h._howls[g]._getSoundIds(),F=0;F<S.length;F++){var V=h._howls[g]._soundById(S[F]);V&&V._node&&(V._node.volume=V._volume*o)}return h}return h._volume},mute:function(o){var h=this||m;h.ctx||Me(),h._muted=o,h.usingWebAudio&&h.masterGain.gain.setValueAtTime(o?0:h._volume,m.ctx.currentTime);for(var g=0;g<h._howls.length;g++)if(!h._howls[g]._webAudio)for(var S=h._howls[g]._getSoundIds(),F=0;F<S.length;F++){var V=h._howls[g]._soundById(S[F]);V&&V._node&&(V._node.muted=!!o||V._muted)}return h},stop:function(){for(var o=this||m,h=0;h<o._howls.length;h++)o._howls[h].stop();return o},unload:function(){for(var o=this||m,h=o._howls.length-1;h>=0;h--)o._howls[h].unload();return o.usingWebAudio&&o.ctx&&void 0!==o.ctx.close&&(o.ctx.close(),o.ctx=null,Me()),o},codecs:function(o){return(this||m)._codecs[o.replace(/^x-/,"")]},_setup:function(){var o=this||m;if(o.state=o.ctx&&o.ctx.state||"suspended",o._autoSuspend(),!o.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(o._canPlayEvent="canplay")}catch(g){o.noAudio=!0}else o.noAudio=!0;try{(new Audio).muted&&(o.noAudio=!0)}catch(g){}return o.noAudio||o._setupCodecs(),o},_setupCodecs:function(){var o=this||m,h=null;try{h="undefined"!=typeof Audio?new Audio:null}catch(Z){return o}if(!h||"function"!=typeof h.canPlayType)return o;var g=h.canPlayType("audio/mpeg;").replace(/^no$/,""),S=o._navigator?o._navigator.userAgent:"",F=S.match(/OPR\/([0-6].)/g),V=F&&parseInt(F[0].split("/")[1],10)<33,M=-1!==S.indexOf("Safari")&&-1===S.indexOf("Chrome"),me=S.match(/Version\/(.*?) /),Ee=M&&me&&parseInt(me[1],10)<15;return o._codecs={mp3:!(V||!g&&!h.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!g,opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(h.canPlayType('audio/wav; codecs="1"')||h.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!h.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(h.canPlayType("audio/x-m4b;")||h.canPlayType("audio/m4b;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(Ee||!h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(Ee||!h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!h.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(h.canPlayType("audio/x-flac;")||h.canPlayType("audio/flac;")).replace(/^no$/,"")},o},_unlockAudio:function(){var o=this||m;if(!o._audioUnlocked&&o.ctx){o._audioUnlocked=!1,o.autoUnlock=!1,!o._mobileUnloaded&&44100!==o.ctx.sampleRate&&(o._mobileUnloaded=!0,o.unload()),o._scratchBuffer=o.ctx.createBuffer(1,1,22050);var h=function(g){for(;o._html5AudioPool.length<o.html5PoolSize;)try{var S=new Audio;S._unlocked=!0,o._releaseHtml5Audio(S)}catch(Z){o.noAudio=!0;break}for(var F=0;F<o._howls.length;F++)if(!o._howls[F]._webAudio)for(var V=o._howls[F]._getSoundIds(),M=0;M<V.length;M++){var me=o._howls[F]._soundById(V[M]);me&&me._node&&!me._node._unlocked&&(me._node._unlocked=!0,me._node.load())}o._autoResume();var Ee=o.ctx.createBufferSource();Ee.buffer=o._scratchBuffer,Ee.connect(o.ctx.destination),void 0===Ee.start?Ee.noteOn(0):Ee.start(0),"function"==typeof o.ctx.resume&&o.ctx.resume(),Ee.onended=function(){Ee.disconnect(0),o._audioUnlocked=!0,document.removeEventListener("touchstart",h,!0),document.removeEventListener("touchend",h,!0),document.removeEventListener("click",h,!0),document.removeEventListener("keydown",h,!0);for(var Z=0;Z<o._howls.length;Z++)o._howls[Z]._emit("unlock")}};return document.addEventListener("touchstart",h,!0),document.addEventListener("touchend",h,!0),document.addEventListener("click",h,!0),document.addEventListener("keydown",h,!0),o}},_obtainHtml5Audio:function(){var o=this||m;if(o._html5AudioPool.length)return o._html5AudioPool.pop();var h=(new Audio).play();return h&&"undefined"!=typeof Promise&&(h instanceof Promise||"function"==typeof h.then)&&h.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(o){var h=this||m;return o._unlocked&&h._html5AudioPool.push(o),h},_autoSuspend:function(){var o=this;if(o.autoSuspend&&o.ctx&&void 0!==o.ctx.suspend&&m.usingWebAudio){for(var h=0;h<o._howls.length;h++)if(o._howls[h]._webAudio)for(var g=0;g<o._howls[h]._sounds.length;g++)if(!o._howls[h]._sounds[g]._paused)return o;return o._suspendTimer&&clearTimeout(o._suspendTimer),o._suspendTimer=setTimeout(function(){if(o.autoSuspend){o._suspendTimer=null,o.state="suspending";var S=function(){o.state="suspended",o._resumeAfterSuspend&&(delete o._resumeAfterSuspend,o._autoResume())};o.ctx.suspend().then(S,S)}},3e4),o}},_autoResume:function(){var o=this;if(o.ctx&&void 0!==o.ctx.resume&&m.usingWebAudio)return"running"===o.state&&"interrupted"!==o.ctx.state&&o._suspendTimer?(clearTimeout(o._suspendTimer),o._suspendTimer=null):"suspended"===o.state||"running"===o.state&&"interrupted"===o.ctx.state?(o.ctx.resume().then(function(){o.state="running";for(var h=0;h<o._howls.length;h++)o._howls[h]._emit("resume")}),o._suspendTimer&&(clearTimeout(o._suspendTimer),o._suspendTimer=null)):"suspending"===o.state&&(o._resumeAfterSuspend=!0),o}};var m=new q,E=function(o){o.src&&0!==o.src.length?this.init(o):console.error("An array of source files must be passed with any new Howl.")};E.prototype={init:function(o){var h=this;return m.ctx||Me(),h._autoplay=o.autoplay||!1,h._format="string"!=typeof o.format?o.format:[o.format],h._html5=o.html5||!1,h._muted=o.mute||!1,h._loop=o.loop||!1,h._pool=o.pool||5,h._preload="boolean"!=typeof o.preload&&"metadata"!==o.preload||o.preload,h._rate=o.rate||1,h._sprite=o.sprite||{},h._src="string"!=typeof o.src?o.src:[o.src],h._volume=void 0!==o.volume?o.volume:1,h._xhr={method:o.xhr&&o.xhr.method?o.xhr.method:"GET",headers:o.xhr&&o.xhr.headers?o.xhr.headers:null,withCredentials:!(!o.xhr||!o.xhr.withCredentials)&&o.xhr.withCredentials},h._duration=0,h._state="unloaded",h._sounds=[],h._endTimers={},h._queue=[],h._playLock=!1,h._onend=o.onend?[{fn:o.onend}]:[],h._onfade=o.onfade?[{fn:o.onfade}]:[],h._onload=o.onload?[{fn:o.onload}]:[],h._onloaderror=o.onloaderror?[{fn:o.onloaderror}]:[],h._onplayerror=o.onplayerror?[{fn:o.onplayerror}]:[],h._onpause=o.onpause?[{fn:o.onpause}]:[],h._onplay=o.onplay?[{fn:o.onplay}]:[],h._onstop=o.onstop?[{fn:o.onstop}]:[],h._onmute=o.onmute?[{fn:o.onmute}]:[],h._onvolume=o.onvolume?[{fn:o.onvolume}]:[],h._onrate=o.onrate?[{fn:o.onrate}]:[],h._onseek=o.onseek?[{fn:o.onseek}]:[],h._onunlock=o.onunlock?[{fn:o.onunlock}]:[],h._onresume=[],h._webAudio=m.usingWebAudio&&!h._html5,void 0!==m.ctx&&m.ctx&&m.autoUnlock&&m._unlockAudio(),m._howls.push(h),h._autoplay&&h._queue.push({event:"play",action:function(){h.play()}}),h._preload&&"none"!==h._preload&&h.load(),h},load:function(){var o=this,h=null;if(m.noAudio)o._emit("loaderror",null,"No audio support.");else{"string"==typeof o._src&&(o._src=[o._src]);for(var g=0;g<o._src.length;g++){var S,F;if(o._format&&o._format[g])S=o._format[g];else{if("string"!=typeof(F=o._src[g])){o._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(S=/^data:audio\/([^;,]+);/i.exec(F))||(S=/\.([^.]+)$/.exec(F.split("?",1)[0])),S&&(S=S[1].toLowerCase())}if(S||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),S&&m.codecs(S)){h=o._src[g];break}}if(h)return o._src=h,o._state="loading","https:"===window.location.protocol&&"http:"===h.slice(0,5)&&(o._html5=!0,o._webAudio=!1),new k(o),o._webAudio&&ue(o),o;o._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(o,h){var g=this,S=null;if("number"==typeof o)S=o,o=null;else{if("string"==typeof o&&"loaded"===g._state&&!g._sprite[o])return null;if(void 0===o&&(o="__default",!g._playLock)){for(var F=0,V=0;V<g._sounds.length;V++)g._sounds[V]._paused&&!g._sounds[V]._ended&&(F++,S=g._sounds[V]._id);1===F?o=null:S=null}}var M=S?g._soundById(S):g._inactiveSound();if(!M)return null;if(S&&!o&&(o=M._sprite||"__default"),"loaded"!==g._state){M._sprite=o,M._ended=!1;var me=M._id;return g._queue.push({event:"play",action:function(){g.play(me)}}),me}if(S&&!M._paused)return h||g._loadQueue("play"),M._id;g._webAudio&&m._autoResume();var Ee=Math.max(0,M._seek>0?M._seek:g._sprite[o][0]/1e3),Z=Math.max(0,(g._sprite[o][0]+g._sprite[o][1])/1e3-Ee),le=1e3*Z/Math.abs(M._rate),be=g._sprite[o][0]/1e3,Pe=(g._sprite[o][0]+g._sprite[o][1])/1e3;M._sprite=o,M._ended=!1;var qe=function(){M._paused=!1,M._seek=Ee,M._start=be,M._stop=Pe,M._loop=!(!M._loop&&!g._sprite[o][2])};if(!(Ee>=Pe)){var fe=M._node;if(g._webAudio){var Ye=function(){g._playLock=!1,qe(),g._refreshBuffer(M),fe.gain.setValueAtTime(M._muted||g._muted?0:M._volume,m.ctx.currentTime),M._playStart=m.ctx.currentTime,void 0===fe.bufferSource.start?fe.bufferSource.noteGrainOn(0,Ee,M._loop?86400:Z):fe.bufferSource.start(0,Ee,M._loop?86400:Z),le!==1/0&&(g._endTimers[M._id]=setTimeout(g._ended.bind(g,M),le)),h||setTimeout(function(){g._emit("play",M._id),g._loadQueue()},0)};"running"===m.state&&"interrupted"!==m.ctx.state?Ye():(g._playLock=!0,g.once("resume",Ye),g._clearTimer(M._id))}else{var We=function(){fe.currentTime=Ee,fe.muted=M._muted||g._muted||m._muted||fe.muted,fe.volume=M._volume*m.volume(),fe.playbackRate=M._rate;try{var Ze=fe.play();if(Ze&&"undefined"!=typeof Promise&&(Ze instanceof Promise||"function"==typeof Ze.then)?(g._playLock=!0,qe(),Ze.then(function(){g._playLock=!1,fe._unlocked=!0,h?g._loadQueue():g._emit("play",M._id)}).catch(function(){g._playLock=!1,g._emit("playerror",M._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),M._ended=!0,M._paused=!0})):h||(g._playLock=!1,qe(),g._emit("play",M._id)),fe.playbackRate=M._rate,fe.paused)return void g._emit("playerror",M._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==o||M._loop?g._endTimers[M._id]=setTimeout(g._ended.bind(g,M),le):(g._endTimers[M._id]=function(){g._ended(M),fe.removeEventListener("ended",g._endTimers[M._id],!1)},fe.addEventListener("ended",g._endTimers[M._id],!1))}catch(Tt){g._emit("playerror",M._id,Tt)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===fe.src&&(fe.src=g._src,fe.load());var nt=window&&window.ejecta||!fe.readyState&&m._navigator.isCocoonJS;if(fe.readyState>=3||nt)We();else{g._playLock=!0,g._state="loading";var wt=function(){g._state="loaded",We(),fe.removeEventListener(m._canPlayEvent,wt,!1)};fe.addEventListener(m._canPlayEvent,wt,!1),g._clearTimer(M._id)}}return M._id}g._ended(M)},pause:function(o){var h=this;if("loaded"!==h._state||h._playLock)return h._queue.push({event:"pause",action:function(){h.pause(o)}}),h;for(var g=h._getSoundIds(o),S=0;S<g.length;S++){h._clearTimer(g[S]);var F=h._soundById(g[S]);if(F&&!F._paused&&(F._seek=h.seek(g[S]),F._rateSeek=0,F._paused=!0,h._stopFade(g[S]),F._node))if(h._webAudio){if(!F._node.bufferSource)continue;void 0===F._node.bufferSource.stop?F._node.bufferSource.noteOff(0):F._node.bufferSource.stop(0),h._cleanBuffer(F._node)}else(!isNaN(F._node.duration)||F._node.duration===1/0)&&F._node.pause();arguments[1]||h._emit("pause",F?F._id:null)}return h},stop:function(o,h){var g=this;if("loaded"!==g._state||g._playLock)return g._queue.push({event:"stop",action:function(){g.stop(o)}}),g;for(var S=g._getSoundIds(o),F=0;F<S.length;F++){g._clearTimer(S[F]);var V=g._soundById(S[F]);V&&(V._seek=V._start||0,V._rateSeek=0,V._paused=!0,V._ended=!0,g._stopFade(S[F]),V._node&&(g._webAudio?V._node.bufferSource&&(void 0===V._node.bufferSource.stop?V._node.bufferSource.noteOff(0):V._node.bufferSource.stop(0),g._cleanBuffer(V._node)):(!isNaN(V._node.duration)||V._node.duration===1/0)&&(V._node.currentTime=V._start||0,V._node.pause(),V._node.duration===1/0&&g._clearSound(V._node))),h||g._emit("stop",V._id))}return g},mute:function(o,h){var g=this;if("loaded"!==g._state||g._playLock)return g._queue.push({event:"mute",action:function(){g.mute(o,h)}}),g;if(void 0===h){if("boolean"!=typeof o)return g._muted;g._muted=o}for(var S=g._getSoundIds(h),F=0;F<S.length;F++){var V=g._soundById(S[F]);V&&(V._muted=o,V._interval&&g._stopFade(V._id),g._webAudio&&V._node?V._node.gain.setValueAtTime(o?0:V._volume,m.ctx.currentTime):V._node&&(V._node.muted=!!m._muted||o),g._emit("mute",V._id))}return g},volume:function(){var g,S,M,o=this,h=arguments;if(0===h.length)return o._volume;if(1===h.length||2===h.length&&void 0===h[1]){var F=o._getSoundIds(),V=F.indexOf(h[0]);V>=0?S=parseInt(h[0],10):g=parseFloat(h[0])}else h.length>=2&&(g=parseFloat(h[0]),S=parseInt(h[1],10));if(!(void 0!==g&&g>=0&&g<=1))return(M=S?o._soundById(S):o._sounds[0])?M._volume:0;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,h)}}),o;void 0===S&&(o._volume=g),S=o._getSoundIds(S);for(var me=0;me<S.length;me++)(M=o._soundById(S[me]))&&(M._volume=g,h[2]||o._stopFade(S[me]),o._webAudio&&M._node&&!M._muted?M._node.gain.setValueAtTime(g,m.ctx.currentTime):M._node&&!M._muted&&(M._node.volume=g*m.volume()),o._emit("volume",M._id));return o},fade:function(o,h,g,S){var F=this;if("loaded"!==F._state||F._playLock)return F._queue.push({event:"fade",action:function(){F.fade(o,h,g,S)}}),F;o=Math.min(Math.max(0,parseFloat(o)),1),h=Math.min(Math.max(0,parseFloat(h)),1),g=parseFloat(g),F.volume(o,S);for(var V=F._getSoundIds(S),M=0;M<V.length;M++){var me=F._soundById(V[M]);if(me){if(S||F._stopFade(V[M]),F._webAudio&&!me._muted){var Ee=m.ctx.currentTime,Z=Ee+g/1e3;me._volume=o,me._node.gain.setValueAtTime(o,Ee),me._node.gain.linearRampToValueAtTime(h,Z)}F._startFadeInterval(me,o,h,g,V[M],void 0===S)}}return F},_startFadeInterval:function(o,h,g,S,F,V){var M=this,me=h,Ee=g-h,Z=Math.abs(Ee/.01),le=Math.max(4,Z>0?S/Z:S),be=Date.now();o._fadeTo=g,o._interval=setInterval(function(){var Pe=(Date.now()-be)/S;be=Date.now(),me+=Ee*Pe,me=Math.round(100*me)/100,me=Ee<0?Math.max(g,me):Math.min(g,me),M._webAudio?o._volume=me:M.volume(me,o._id,!0),V&&(M._volume=me),(g<h&&me<=g||g>h&&me>=g)&&(clearInterval(o._interval),o._interval=null,o._fadeTo=null,M.volume(g,o._id),M._emit("fade",o._id))},le)},_stopFade:function(o){var h=this,g=h._soundById(o);return g&&g._interval&&(h._webAudio&&g._node.gain.cancelScheduledValues(m.ctx.currentTime),clearInterval(g._interval),g._interval=null,h.volume(g._fadeTo,o),g._fadeTo=null,h._emit("fade",o)),h},loop:function(){var g,S,F,o=this,h=arguments;if(0===h.length)return o._loop;if(1===h.length){if("boolean"!=typeof h[0])return!!(F=o._soundById(parseInt(h[0],10)))&&F._loop;o._loop=g=h[0]}else 2===h.length&&(g=h[0],S=parseInt(h[1],10));for(var V=o._getSoundIds(S),M=0;M<V.length;M++)(F=o._soundById(V[M]))&&(F._loop=g,o._webAudio&&F._node&&F._node.bufferSource&&(F._node.bufferSource.loop=g,g&&(F._node.bufferSource.loopStart=F._start||0,F._node.bufferSource.loopEnd=F._stop,o.playing(V[M])&&(o.pause(V[M],!0),o.play(V[M],!0)))));return o},rate:function(){var g,S,M,o=this,h=arguments;if(0===h.length)S=o._sounds[0]._id;else if(1===h.length){var F=o._getSoundIds(),V=F.indexOf(h[0]);V>=0?S=parseInt(h[0],10):g=parseFloat(h[0])}else 2===h.length&&(g=parseFloat(h[0]),S=parseInt(h[1],10));if("number"!=typeof g)return(M=o._soundById(S))?M._rate:o._rate;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,h)}}),o;void 0===S&&(o._rate=g),S=o._getSoundIds(S);for(var me=0;me<S.length;me++)if(M=o._soundById(S[me])){o.playing(S[me])&&(M._rateSeek=o.seek(S[me]),M._playStart=o._webAudio?m.ctx.currentTime:M._playStart),M._rate=g,o._webAudio&&M._node&&M._node.bufferSource?M._node.bufferSource.playbackRate.setValueAtTime(g,m.ctx.currentTime):M._node&&(M._node.playbackRate=g);var Ee=o.seek(S[me]),Z=(o._sprite[M._sprite][0]+o._sprite[M._sprite][1])/1e3-Ee,le=1e3*Z/Math.abs(M._rate);(o._endTimers[S[me]]||!M._paused)&&(o._clearTimer(S[me]),o._endTimers[S[me]]=setTimeout(o._ended.bind(o,M),le)),o._emit("rate",M._id)}return o},seek:function(){var g,S,o=this,h=arguments;if(0===h.length)o._sounds.length&&(S=o._sounds[0]._id);else if(1===h.length){var F=o._getSoundIds(),V=F.indexOf(h[0]);V>=0?S=parseInt(h[0],10):o._sounds.length&&(S=o._sounds[0]._id,g=parseFloat(h[0]))}else 2===h.length&&(g=parseFloat(h[0]),S=parseInt(h[1],10));if(void 0===S)return 0;if("number"==typeof g&&("loaded"!==o._state||o._playLock))return o._queue.push({event:"seek",action:function(){o.seek.apply(o,h)}}),o;var M=o._soundById(S);if(M){if(!("number"==typeof g&&g>=0)){if(o._webAudio){var le=o.playing(S)?m.ctx.currentTime-M._playStart:0,be=M._rateSeek?M._rateSeek-M._seek:0;return M._seek+(be+le*Math.abs(M._rate))}return M._node.currentTime}var me=o.playing(S);me&&o.pause(S,!0),M._seek=g,M._ended=!1,o._clearTimer(S),!o._webAudio&&M._node&&!isNaN(M._node.duration)&&(M._node.currentTime=g);var Ee=function(){me&&o.play(S,!0),o._emit("seek",S)};if(me&&!o._webAudio){var Z=function(){o._playLock?setTimeout(Z,0):Ee()};setTimeout(Z,0)}else Ee()}return o},playing:function(o){var h=this;if("number"==typeof o){var g=h._soundById(o);return!!g&&!g._paused}for(var S=0;S<h._sounds.length;S++)if(!h._sounds[S]._paused)return!0;return!1},duration:function(o){var h=this,g=h._duration,S=h._soundById(o);return S&&(g=h._sprite[S._sprite][1]/1e3),g},state:function(){return this._state},unload:function(){for(var o=this,h=o._sounds,g=0;g<h.length;g++)h[g]._paused||o.stop(h[g]._id),o._webAudio||(o._clearSound(h[g]._node),h[g]._node.removeEventListener("error",h[g]._errorFn,!1),h[g]._node.removeEventListener(m._canPlayEvent,h[g]._loadFn,!1),h[g]._node.removeEventListener("ended",h[g]._endFn,!1),m._releaseHtml5Audio(h[g]._node)),delete h[g]._node,o._clearTimer(h[g]._id);var S=m._howls.indexOf(o);S>=0&&m._howls.splice(S,1);var F=!0;for(g=0;g<m._howls.length;g++)if(m._howls[g]._src===o._src||o._src.indexOf(m._howls[g]._src)>=0){F=!1;break}return he&&F&&delete he[o._src],m.noAudio=!1,o._state="unloaded",o._sounds=[],o=null,null},on:function(o,h,g,S){return"function"==typeof h&&this["_on"+o].push(S?{id:g,fn:h,once:S}:{id:g,fn:h}),this},off:function(o,h,g){var S=this,F=S["_on"+o],V=0;if("number"==typeof h&&(g=h,h=null),h||g)for(V=0;V<F.length;V++){var M=g===F[V].id;if(h===F[V].fn&&M||!h&&M){F.splice(V,1);break}}else if(o)S["_on"+o]=[];else{var me=Object.keys(S);for(V=0;V<me.length;V++)0===me[V].indexOf("_on")&&Array.isArray(S[me[V]])&&(S[me[V]]=[])}return S},once:function(o,h,g){return this.on(o,h,g,1),this},_emit:function(o,h,g){for(var S=this,F=S["_on"+o],V=F.length-1;V>=0;V--)(!F[V].id||F[V].id===h||"load"===o)&&(setTimeout(function(M){M.call(this,h,g)}.bind(S,F[V].fn),0),F[V].once&&S.off(o,F[V].fn,F[V].id));return S._loadQueue(o),S},_loadQueue:function(o){var h=this;if(h._queue.length>0){var g=h._queue[0];g.event===o&&(h._queue.shift(),h._loadQueue()),o||g.action()}return h},_ended:function(o){var h=this,g=o._sprite;if(!h._webAudio&&o._node&&!o._node.paused&&!o._node.ended&&o._node.currentTime<o._stop)return setTimeout(h._ended.bind(h,o),100),h;var S=!(!o._loop&&!h._sprite[g][2]);if(h._emit("end",o._id),!h._webAudio&&S&&h.stop(o._id,!0).play(o._id),h._webAudio&&S){h._emit("play",o._id),o._seek=o._start||0,o._rateSeek=0,o._playStart=m.ctx.currentTime;var F=1e3*(o._stop-o._start)/Math.abs(o._rate);h._endTimers[o._id]=setTimeout(h._ended.bind(h,o),F)}return h._webAudio&&!S&&(o._paused=!0,o._ended=!0,o._seek=o._start||0,o._rateSeek=0,h._clearTimer(o._id),h._cleanBuffer(o._node),m._autoSuspend()),!h._webAudio&&!S&&h.stop(o._id,!0),h},_clearTimer:function(o){var h=this;if(h._endTimers[o]){if("function"!=typeof h._endTimers[o])clearTimeout(h._endTimers[o]);else{var g=h._soundById(o);g&&g._node&&g._node.removeEventListener("ended",h._endTimers[o],!1)}delete h._endTimers[o]}return h},_soundById:function(o){for(var h=this,g=0;g<h._sounds.length;g++)if(o===h._sounds[g]._id)return h._sounds[g];return null},_inactiveSound:function(){var o=this;o._drain();for(var h=0;h<o._sounds.length;h++)if(o._sounds[h]._ended)return o._sounds[h].reset();return new k(o)},_drain:function(){var o=this,h=o._pool,g=0,S=0;if(!(o._sounds.length<h)){for(S=0;S<o._sounds.length;S++)o._sounds[S]._ended&&g++;for(S=o._sounds.length-1;S>=0;S--){if(g<=h)return;o._sounds[S]._ended&&(o._webAudio&&o._sounds[S]._node&&o._sounds[S]._node.disconnect(0),o._sounds.splice(S,1),g--)}}},_getSoundIds:function(o){if(void 0===o){for(var g=[],S=0;S<this._sounds.length;S++)g.push(this._sounds[S]._id);return g}return[o]},_refreshBuffer:function(o){return o._node.bufferSource=m.ctx.createBufferSource(),o._node.bufferSource.buffer=he[this._src],o._node.bufferSource.connect(o._panner?o._panner:o._node),o._node.bufferSource.loop=o._loop,o._loop&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop||0),o._node.bufferSource.playbackRate.setValueAtTime(o._rate,m.ctx.currentTime),this},_cleanBuffer:function(o){var g=m._navigator&&m._navigator.vendor.indexOf("Apple")>=0;if(m._scratchBuffer&&o.bufferSource&&(o.bufferSource.onended=null,o.bufferSource.disconnect(0),g))try{o.bufferSource.buffer=m._scratchBuffer}catch(S){}return o.bufferSource=null,this},_clearSound:function(o){/MSIE |Trident\//.test(m._navigator&&m._navigator.userAgent)||(o.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var k=function(o){this._parent=o,this.init()};k.prototype={init:function(){var o=this,h=o._parent;return o._muted=h._muted,o._loop=h._loop,o._volume=h._volume,o._rate=h._rate,o._seek=0,o._paused=!0,o._ended=!0,o._sprite="__default",o._id=++m._counter,h._sounds.push(o),o.create(),o},create:function(){var o=this,h=o._parent,g=m._muted||o._muted||o._parent._muted?0:o._volume;return h._webAudio?(o._node=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),o._node.gain.setValueAtTime(g,m.ctx.currentTime),o._node.paused=!0,o._node.connect(m.masterGain)):m.noAudio||(o._node=m._obtainHtml5Audio(),o._errorFn=o._errorListener.bind(o),o._node.addEventListener("error",o._errorFn,!1),o._loadFn=o._loadListener.bind(o),o._node.addEventListener(m._canPlayEvent,o._loadFn,!1),o._endFn=o._endListener.bind(o),o._node.addEventListener("ended",o._endFn,!1),o._node.src=h._src,o._node.preload=!0===h._preload?"auto":h._preload,o._node.volume=g*m.volume(),o._node.load()),o},reset:function(){var o=this,h=o._parent;return o._muted=h._muted,o._loop=h._loop,o._volume=h._volume,o._rate=h._rate,o._seek=0,o._rateSeek=0,o._paused=!0,o._ended=!0,o._sprite="__default",o._id=++m._counter,o},_errorListener:function(){var o=this;o._parent._emit("loaderror",o._id,o._node.error?o._node.error.code:0),o._node.removeEventListener("error",o._errorFn,!1)},_loadListener:function(){var o=this,h=o._parent;h._duration=Math.ceil(10*o._node.duration)/10,0===Object.keys(h._sprite).length&&(h._sprite={__default:[0,1e3*h._duration]}),"loaded"!==h._state&&(h._state="loaded",h._emit("load"),h._loadQueue()),o._node.removeEventListener(m._canPlayEvent,o._loadFn,!1)},_endListener:function(){var o=this,h=o._parent;h._duration===1/0&&(h._duration=Math.ceil(10*o._node.duration)/10,h._sprite.__default[1]===1/0&&(h._sprite.__default[1]=1e3*h._duration),h._ended(o)),o._node.removeEventListener("ended",o._endFn,!1)}};var he={},ue=function(o){var h=o._src;if(he[h])return o._duration=he[h].duration,void X(o);if(/^data:[^;]+;base64,/.test(h)){for(var g=atob(h.split(",")[1]),S=new Uint8Array(g.length),F=0;F<g.length;++F)S[F]=g.charCodeAt(F);se(S.buffer,o)}else{var V=new XMLHttpRequest;V.open(o._xhr.method,h,!0),V.withCredentials=o._xhr.withCredentials,V.responseType="arraybuffer",o._xhr.headers&&Object.keys(o._xhr.headers).forEach(function(M){V.setRequestHeader(M,o._xhr.headers[M])}),V.onload=function(){var M=(V.status+"")[0];"0"===M||"2"===M||"3"===M?se(V.response,o):o._emit("loaderror",null,"Failed loading audio file with status: "+V.status+".")},V.onerror=function(){o._webAudio&&(o._html5=!0,o._webAudio=!1,o._sounds=[],delete he[h],o.load())},_(V)}},_=function(o){try{o.send()}catch(h){o.onerror()}},se=function(o,h){var g=function(){h._emit("loaderror",null,"Decoding audio data failed.")},S=function(F){F&&h._sounds.length>0?(he[h._src]=F,X(h,F)):g()};"undefined"!=typeof Promise&&1===m.ctx.decodeAudioData.length?m.ctx.decodeAudioData(o).then(S).catch(g):m.ctx.decodeAudioData(o,S,g)},X=function(o,h){h&&!o._duration&&(o._duration=h.duration),0===Object.keys(o._sprite).length&&(o._sprite={__default:[0,1e3*o._duration]}),"loaded"!==o._state&&(o._state="loaded",o._emit("load"),o._loadQueue())},Me=function(){if(m.usingWebAudio){try{"undefined"!=typeof AudioContext?m.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?m.ctx=new webkitAudioContext:m.usingWebAudio=!1}catch(F){m.usingWebAudio=!1}m.ctx||(m.usingWebAudio=!1);var o=/iP(hone|od|ad)/.test(m._navigator&&m._navigator.platform),h=m._navigator&&m._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),g=h?parseInt(h[1],10):null;if(o&&g&&g<9){var S=/safari/.test(m._navigator&&m._navigator.userAgent.toLowerCase());m._navigator&&!S&&(m.usingWebAudio=!1)}m.usingWebAudio&&(m.masterGain=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),m.masterGain.gain.setValueAtTime(m._muted?0:m._volume,m.ctx.currentTime),m.masterGain.connect(m.ctx.destination)),m._setup()}};void 0!==(J=function(){return{Howler:m,Howl:E}}.apply(Oe,[]))&&(xe.exports=J),Oe.Howler=m,Oe.Howl=E,"undefined"!=typeof global?(global.HowlerGlobal=q,global.Howler=m,global.Howl=E,global.Sound=k):"undefined"!=typeof window&&(window.HowlerGlobal=q,window.Howler=m,window.Howl=E,window.Sound=k)}(),function(){"use strict";var m;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(m){var E=this;if(!E.ctx||!E.ctx.listener)return E;for(var k=E._howls.length-1;k>=0;k--)E._howls[k].stereo(m);return E},HowlerGlobal.prototype.pos=function(m,E,k){var he=this;return he.ctx&&he.ctx.listener?"number"!=typeof m?he._pos:(he._pos=[m,E="number"!=typeof E?he._pos[1]:E,k="number"!=typeof k?he._pos[2]:k],void 0!==he.ctx.listener.positionX?(he.ctx.listener.positionX.setTargetAtTime(he._pos[0],Howler.ctx.currentTime,.1),he.ctx.listener.positionY.setTargetAtTime(he._pos[1],Howler.ctx.currentTime,.1),he.ctx.listener.positionZ.setTargetAtTime(he._pos[2],Howler.ctx.currentTime,.1)):he.ctx.listener.setPosition(he._pos[0],he._pos[1],he._pos[2]),he):he},HowlerGlobal.prototype.orientation=function(m,E,k,he,ue,_){var se=this;if(!se.ctx||!se.ctx.listener)return se;var X=se._orientation;return"number"!=typeof m?X:(se._orientation=[m,E="number"!=typeof E?X[1]:E,k="number"!=typeof k?X[2]:k,he="number"!=typeof he?X[3]:he,ue="number"!=typeof ue?X[4]:ue,_="number"!=typeof _?X[5]:_],void 0!==se.ctx.listener.forwardX?(se.ctx.listener.forwardX.setTargetAtTime(m,Howler.ctx.currentTime,.1),se.ctx.listener.forwardY.setTargetAtTime(E,Howler.ctx.currentTime,.1),se.ctx.listener.forwardZ.setTargetAtTime(k,Howler.ctx.currentTime,.1),se.ctx.listener.upX.setTargetAtTime(he,Howler.ctx.currentTime,.1),se.ctx.listener.upY.setTargetAtTime(ue,Howler.ctx.currentTime,.1),se.ctx.listener.upZ.setTargetAtTime(_,Howler.ctx.currentTime,.1)):se.ctx.listener.setOrientation(m,E,k,he,ue,_),se)},Howl.prototype.init=(m=Howl.prototype.init,function(E){var k=this;return k._orientation=E.orientation||[1,0,0],k._stereo=E.stereo||null,k._pos=E.pos||null,k._pannerAttr={coneInnerAngle:void 0!==E.coneInnerAngle?E.coneInnerAngle:360,coneOuterAngle:void 0!==E.coneOuterAngle?E.coneOuterAngle:360,coneOuterGain:void 0!==E.coneOuterGain?E.coneOuterGain:0,distanceModel:void 0!==E.distanceModel?E.distanceModel:"inverse",maxDistance:void 0!==E.maxDistance?E.maxDistance:1e4,panningModel:void 0!==E.panningModel?E.panningModel:"HRTF",refDistance:void 0!==E.refDistance?E.refDistance:1,rolloffFactor:void 0!==E.rolloffFactor?E.rolloffFactor:1},k._onstereo=E.onstereo?[{fn:E.onstereo}]:[],k._onpos=E.onpos?[{fn:E.onpos}]:[],k._onorientation=E.onorientation?[{fn:E.onorientation}]:[],m.call(this,E)}),Howl.prototype.stereo=function(m,E){var k=this;if(!k._webAudio)return k;if("loaded"!==k._state)return k._queue.push({event:"stereo",action:function(){k.stereo(m,E)}}),k;var he=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===E){if("number"!=typeof m)return k._stereo;k._stereo=m,k._pos=[m,0,0]}for(var ue=k._getSoundIds(E),_=0;_<ue.length;_++){var se=k._soundById(ue[_]);if(se){if("number"!=typeof m)return se._stereo;se._stereo=m,se._pos=[m,0,0],se._node&&(se._pannerAttr.panningModel="equalpower",(!se._panner||!se._panner.pan)&&q(se,he),"spatial"===he?void 0!==se._panner.positionX?(se._panner.positionX.setValueAtTime(m,Howler.ctx.currentTime),se._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),se._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):se._panner.setPosition(m,0,0):se._panner.pan.setValueAtTime(m,Howler.ctx.currentTime)),k._emit("stereo",se._id)}}return k},Howl.prototype.pos=function(m,E,k,he){var ue=this;if(!ue._webAudio)return ue;if("loaded"!==ue._state)return ue._queue.push({event:"pos",action:function(){ue.pos(m,E,k,he)}}),ue;if(E="number"!=typeof E?0:E,k="number"!=typeof k?-.5:k,void 0===he){if("number"!=typeof m)return ue._pos;ue._pos=[m,E,k]}for(var _=ue._getSoundIds(he),se=0;se<_.length;se++){var X=ue._soundById(_[se]);if(X){if("number"!=typeof m)return X._pos;X._pos=[m,E,k],X._node&&((!X._panner||X._panner.pan)&&q(X,"spatial"),void 0!==X._panner.positionX?(X._panner.positionX.setValueAtTime(m,Howler.ctx.currentTime),X._panner.positionY.setValueAtTime(E,Howler.ctx.currentTime),X._panner.positionZ.setValueAtTime(k,Howler.ctx.currentTime)):X._panner.setPosition(m,E,k)),ue._emit("pos",X._id)}}return ue},Howl.prototype.orientation=function(m,E,k,he){var ue=this;if(!ue._webAudio)return ue;if("loaded"!==ue._state)return ue._queue.push({event:"orientation",action:function(){ue.orientation(m,E,k,he)}}),ue;if(E="number"!=typeof E?ue._orientation[1]:E,k="number"!=typeof k?ue._orientation[2]:k,void 0===he){if("number"!=typeof m)return ue._orientation;ue._orientation=[m,E,k]}for(var _=ue._getSoundIds(he),se=0;se<_.length;se++){var X=ue._soundById(_[se]);if(X){if("number"!=typeof m)return X._orientation;X._orientation=[m,E,k],X._node&&(X._panner||(X._pos||(X._pos=ue._pos||[0,0,-.5]),q(X,"spatial")),void 0!==X._panner.orientationX?(X._panner.orientationX.setValueAtTime(m,Howler.ctx.currentTime),X._panner.orientationY.setValueAtTime(E,Howler.ctx.currentTime),X._panner.orientationZ.setValueAtTime(k,Howler.ctx.currentTime)):X._panner.setOrientation(m,E,k)),ue._emit("orientation",X._id)}}return ue},Howl.prototype.pannerAttr=function(){var k,he,ue,m=this,E=arguments;if(!m._webAudio)return m;if(0===E.length)return m._pannerAttr;if(1===E.length){if("object"!=typeof E[0])return(ue=m._soundById(parseInt(E[0],10)))?ue._pannerAttr:m._pannerAttr;k=E[0],void 0===he&&(k.pannerAttr||(k.pannerAttr={coneInnerAngle:k.coneInnerAngle,coneOuterAngle:k.coneOuterAngle,coneOuterGain:k.coneOuterGain,distanceModel:k.distanceModel,maxDistance:k.maxDistance,refDistance:k.refDistance,rolloffFactor:k.rolloffFactor,panningModel:k.panningModel}),m._pannerAttr={coneInnerAngle:void 0!==k.pannerAttr.coneInnerAngle?k.pannerAttr.coneInnerAngle:m._coneInnerAngle,coneOuterAngle:void 0!==k.pannerAttr.coneOuterAngle?k.pannerAttr.coneOuterAngle:m._coneOuterAngle,coneOuterGain:void 0!==k.pannerAttr.coneOuterGain?k.pannerAttr.coneOuterGain:m._coneOuterGain,distanceModel:void 0!==k.pannerAttr.distanceModel?k.pannerAttr.distanceModel:m._distanceModel,maxDistance:void 0!==k.pannerAttr.maxDistance?k.pannerAttr.maxDistance:m._maxDistance,refDistance:void 0!==k.pannerAttr.refDistance?k.pannerAttr.refDistance:m._refDistance,rolloffFactor:void 0!==k.pannerAttr.rolloffFactor?k.pannerAttr.rolloffFactor:m._rolloffFactor,panningModel:void 0!==k.pannerAttr.panningModel?k.pannerAttr.panningModel:m._panningModel})}else 2===E.length&&(k=E[0],he=parseInt(E[1],10));for(var _=m._getSoundIds(he),se=0;se<_.length;se++)if(ue=m._soundById(_[se])){var X=ue._pannerAttr;X={coneInnerAngle:void 0!==k.coneInnerAngle?k.coneInnerAngle:X.coneInnerAngle,coneOuterAngle:void 0!==k.coneOuterAngle?k.coneOuterAngle:X.coneOuterAngle,coneOuterGain:void 0!==k.coneOuterGain?k.coneOuterGain:X.coneOuterGain,distanceModel:void 0!==k.distanceModel?k.distanceModel:X.distanceModel,maxDistance:void 0!==k.maxDistance?k.maxDistance:X.maxDistance,refDistance:void 0!==k.refDistance?k.refDistance:X.refDistance,rolloffFactor:void 0!==k.rolloffFactor?k.rolloffFactor:X.rolloffFactor,panningModel:void 0!==k.panningModel?k.panningModel:X.panningModel};var Me=ue._panner;Me?(Me.coneInnerAngle=X.coneInnerAngle,Me.coneOuterAngle=X.coneOuterAngle,Me.coneOuterGain=X.coneOuterGain,Me.distanceModel=X.distanceModel,Me.maxDistance=X.maxDistance,Me.refDistance=X.refDistance,Me.rolloffFactor=X.rolloffFactor,Me.panningModel=X.panningModel):(ue._pos||(ue._pos=m._pos||[0,0,-.5]),q(ue,"spatial"))}return m},Sound.prototype.init=function(m){return function(){var E=this,k=E._parent;E._orientation=k._orientation,E._stereo=k._stereo,E._pos=k._pos,E._pannerAttr=k._pannerAttr,m.call(this),E._stereo?k.stereo(E._stereo):E._pos&&k.pos(E._pos[0],E._pos[1],E._pos[2],E._id)}}(Sound.prototype.init),Sound.prototype.reset=function(m){return function(){var E=this,k=E._parent;return E._orientation=k._orientation,E._stereo=k._stereo,E._pos=k._pos,E._pannerAttr=k._pannerAttr,E._stereo?k.stereo(E._stereo):E._pos?k.pos(E._pos[0],E._pos[1],E._pos[2],E._id):E._panner&&(E._panner.disconnect(0),E._panner=void 0,k._refreshBuffer(E)),m.call(this)}}(Sound.prototype.reset);var q=function(m,E){"spatial"===(E=E||"spatial")?(m._panner=Howler.ctx.createPanner(),m._panner.coneInnerAngle=m._pannerAttr.coneInnerAngle,m._panner.coneOuterAngle=m._pannerAttr.coneOuterAngle,m._panner.coneOuterGain=m._pannerAttr.coneOuterGain,m._panner.distanceModel=m._pannerAttr.distanceModel,m._panner.maxDistance=m._pannerAttr.maxDistance,m._panner.refDistance=m._pannerAttr.refDistance,m._panner.rolloffFactor=m._pannerAttr.rolloffFactor,m._panner.panningModel=m._pannerAttr.panningModel,void 0!==m._panner.positionX?(m._panner.positionX.setValueAtTime(m._pos[0],Howler.ctx.currentTime),m._panner.positionY.setValueAtTime(m._pos[1],Howler.ctx.currentTime),m._panner.positionZ.setValueAtTime(m._pos[2],Howler.ctx.currentTime)):m._panner.setPosition(m._pos[0],m._pos[1],m._pos[2]),void 0!==m._panner.orientationX?(m._panner.orientationX.setValueAtTime(m._orientation[0],Howler.ctx.currentTime),m._panner.orientationY.setValueAtTime(m._orientation[1],Howler.ctx.currentTime),m._panner.orientationZ.setValueAtTime(m._orientation[2],Howler.ctx.currentTime)):m._panner.setOrientation(m._orientation[0],m._orientation[1],m._orientation[2])):(m._panner=Howler.ctx.createStereoPanner(),m._panner.pan.setValueAtTime(m._stereo,Howler.ctx.currentTime)),m._panner.connect(m._node),m._paused||m._parent.pause(m._id,!0).play(m._id,!0)}}()},5108:(xe,Oe)=>{"use strict";var J,w;function q(w,l){if(!w)throw"First parameter is required.";l=new m(w,l=l||{type:"video"});var b=this;function j(pe){pe&&(l.initCallback=function(){pe(),pe=l.initCallback=null});var $=new E(w,l);(H=new $(w,l)).record(),G("recording"),l.disableLogs||console.log("Initialized recorderType:",H.constructor.name,"for output-type:",l.type)}function R(pe){if(pe=pe||function(){},H){if("paused"===b.state)return b.resumeRecording(),void setTimeout(function(){R(pe)},1);"recording"!==b.state&&!l.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',b.state),l.disableLogs||console.log("Stopped recording "+l.type+" stream."),"gif"!==l.type?H.stop($):(H.stop(),$()),G("stopped")}else ce();function $(ie){if(H){Object.keys(H).forEach(function(we){"function"!=typeof H[we]&&(b[we]=H[we])});var P=H.blob;if(!P){if(!ie)throw"Recording failed.";H.blob=P=ie}if(P&&!l.disableLogs&&console.log(P.type,"->",M(P.size)),pe){var W;try{W=Me.createObjectURL(P)}catch(we){}"function"==typeof pe.call?pe.call(b,W):pe(W)}!l.autoWriteToDisk||Ce(function(we){var Ae={};Ae[l.type+"Blob"]=we,Ze.Store(Ae)})}else"function"==typeof pe.call?pe.call(b,""):pe("")}}function de(pe){postMessage((new FileReaderSync).readAsDataURL(pe))}function Ce(pe,$){if(!pe)throw"Pass a callback function over getDataURL.";var ie=$?$.blob:(H||{}).blob;if(!ie)return l.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout(function(){Ce(pe,$)},1e3);if("undefined"==typeof Worker||navigator.mozGetUserMedia){var W=new FileReader;W.readAsDataURL(ie),W.onload=function(Ae){pe(Ae.target.result)}}else{var P=function we(Ae){try{var Ke=Me.createObjectURL(new Blob([Ae.toString(),"this.onmessage =  function (eee) {"+Ae.name+"(eee.data);}"],{type:"application/javascript"})),Ge=new Worker(Ke);return Me.revokeObjectURL(Ke),Ge}catch(Dt){}}(de);P.onmessage=function(Ae){pe(Ae.data)},P.postMessage(ie)}}function K(pe){if(pe=pe||0,"paused"!==b.state){if("stopped"!==b.state){if(pe>=b.recordingDuration)return void R(b.onRecordingStopped);pe+=1e3,setTimeout(function(){K(pe)},1e3)}}else setTimeout(function(){K(pe)},1e3)}function G(pe){!b||(b.state=pe,"function"==typeof b.onStateChanged.call?b.onStateChanged.call(b,pe):b.onStateChanged(pe))}var ne='It seems that recorder is destroyed or "startRecording" is not invoked for '+l.type+" recorder.";function ce(){!0!==l.disableLogs&&console.warn(ne)}var H,De={startRecording:function D(pe){return l.disableLogs||console.log("RecordRTC version: ",b.version),pe&&(l=new m(w,pe)),l.disableLogs||console.log("started recording "+l.type+" stream."),H?(H.clearRecordedData(),H.record(),G("recording"),b.recordingDuration&&K(),b):(j(function(){b.recordingDuration&&K()}),b)},stopRecording:R,pauseRecording:function Q(){H?"recording"===b.state?(G("paused"),H.pause(),l.disableLogs||console.log("Paused recording.")):l.disableLogs||console.warn("Unable to pause the recording. Recording state: ",b.state):ce()},resumeRecording:function N(){H?"paused"===b.state?(G("recording"),H.resume(),l.disableLogs||console.log("Resumed recording.")):l.disableLogs||console.warn("Unable to resume the recording. Recording state: ",b.state):ce()},initRecorder:j,setRecordingDuration:function(pe,$){if(void 0===pe)throw"recordingDuration is required.";if("number"!=typeof pe)throw"recordingDuration must be a number.";return b.recordingDuration=pe,b.onRecordingStopped=$||function(){},{onRecordingStopped:function(ie){b.onRecordingStopped=ie}}},clearRecordedData:function(){H?(H.clearRecordedData(),l.disableLogs||console.log("Cleared old recorded data.")):ce()},getBlob:function(){if(H)return H.blob;ce()},getDataURL:Ce,toURL:function(){if(H)return Me.createObjectURL(H.blob);ce()},getInternalRecorder:function(){return H},save:function(pe){H?me(H.blob,pe):ce()},getFromDisk:function(pe){H?q.getFromDisk(l.type,pe):ce()},setAdvertisementArray:function(pe){l.advertisement=[];for(var $=pe.length,ie=0;ie<$;ie++)l.advertisement.push({duration:ie,image:pe[ie]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"===b.state&&!l.disableLogs&&console.warn("Stop an active recorder."),H&&"function"==typeof H.clearRecordedData&&H.clearRecordedData(),H=null,G("inactive"),b.blob=null},onStateChanged:function(pe){l.disableLogs||console.log("Recorder state changed:",pe)},state:"inactive",getState:function(){return b.state},destroy:function(){var pe=l.disableLogs;l={disableLogs:!0},b.reset(),G("destroyed"),De=b=null,Pe.AudioContextConstructor&&(Pe.AudioContextConstructor.close(),Pe.AudioContextConstructor=null),l.disableLogs=pe,l.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return b=De,De;for(var Ie in De)this[Ie]=De[Ie];return b=this,De}function m(w,l){return!l.recorderType&&!l.type&&(l.audio&&l.video?l.type="video":!!l.audio&&!l.video&&(l.type="audio")),l.recorderType&&!l.type&&(l.recorderType===nt||l.recorderType===We||void 0!==ye&&l.recorderType===ye?l.type="video":l.recorderType===Tt?l.type="gif":l.recorderType===Ye?l.type="audio":l.recorderType===fe&&(Z(w,"audio").length&&Z(w,"video").length||!Z(w,"audio").length&&Z(w,"video").length?l.type="video":Z(w,"audio").length&&!Z(w,"video").length&&(l.type="audio"))),void 0!==fe&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(l.mimeType||(l.mimeType="video/webm"),l.type||(l.type=l.mimeType.split("/")[0])),l.type||(l.mimeType&&(l.type=l.mimeType.split("/")[0]),l.type||(l.type="audio")),l}function E(w,l){var b;return(S||o||h)&&(b=Ye),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!S&&(b=fe),"video"===l.type&&(S||h)&&(b=nt,void 0!==ye&&"undefined"!=typeof ReadableStream&&(b=ye)),"gif"===l.type&&(b=Tt),"canvas"===l.type&&(b=We),qe()&&b!==We&&b!==Tt&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(Z(w,"video").length||Z(w,"audio").length)&&("audio"===l.type?"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(b=fe):"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(b=fe)),w instanceof Array&&w.length&&(b=Et),l.recorderType&&(b=l.recorderType),!l.disableLogs&&!!b&&!!b.name&&console.log("Using recorderType:",b.name||b.constructor.name),!b&&F&&(b=fe),b}function k(w){this.addStream=function(l){l&&(w=l)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var b,l=this.mediaType,D=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof l.audio&&qe()&&!Z(w,"audio").length&&(l.audio=!1),"function"!=typeof l.video&&qe()&&!Z(w,"video").length&&(l.video=!1),"function"!=typeof l.gif&&qe()&&!Z(w,"video").length&&(l.gif=!1),!l.audio&&!l.video&&!l.gif)throw"MediaStream must have either audio or video tracks.";if(l.audio&&(b=null,"function"==typeof l.audio&&(b=l.audio),this.audioRecorder=new q(w,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:b,mimeType:D.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),l.video||this.audioRecorder.startRecording()),l.video){b=null,"function"==typeof l.video&&(b=l.video);var j=w;if(qe()&&l.audio&&"function"==typeof l.audio){var R=Z(w,"video")[0];g?((j=new V).addTrack(R),b&&b===nt&&(b=fe)):(j=new V).addTrack(R)}this.videoRecorder=new q(j,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:b,mimeType:D.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),l.audio||this.videoRecorder.startRecording()}if(l.audio&&l.video){var Q=this,N=!0===qe();(l.audio instanceof Ye&&!!l.video||!0!==l.audio&&!0!==l.video&&l.audio!==l.video)&&(N=!1),!0===N?(Q.audioRecorder=null,Q.videoRecorder.startRecording()):Q.videoRecorder.initRecorder(function(){Q.audioRecorder.initRecorder(function(){Q.videoRecorder.startRecording(),Q.audioRecorder.startRecording()})})}l.gif&&(b=null,"function"==typeof l.gif&&(b=l.gif),this.gifRecorder=new q(w,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:b,mimeType:D.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(l){l=l||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(b){l(b,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(b){l(b,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(b){l(b,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(l){var b={};return this.audioRecorder&&(b.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(b.video=this.videoRecorder.getBlob()),this.gifRecorder&&(b.gif=this.gifRecorder.getBlob()),l&&l(b),b},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(l){function b(j,R){if("undefined"!=typeof Worker){var Q=function D(j){var N,R=Me.createObjectURL(new Blob([j.toString(),"this.onmessage =  function (eee) {"+j.name+"(eee.data);}"],{type:"application/javascript"})),Q=new Worker(R);if(void 0!==Me)N=Me;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";N=webkitURL}return N.revokeObjectURL(R),Q}(function(Ce){postMessage((new FileReaderSync).readAsDataURL(Ce))});Q.onmessage=function(de){R(de.data)},Q.postMessage(j)}else{var N=new FileReader;N.readAsDataURL(j),N.onload=function(de){R(de.target.result)}}}this.getBlob(function(j){j.audio&&j.video?b(j.audio,function(R){b(j.video,function(Q){l({audio:R,video:Q})})}):j.audio?b(j.audio,function(R){l({audio:R})}):j.video&&b(j.video,function(R){l({video:R})})})},this.writeToDisk=function(){q.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(l){!!(l=l||{audio:!0,video:!0,gif:!0}).audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof l.audio?l.audio:""),!!l.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof l.video?l.video:""),l.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof l.gif?l.gif:"")}}q.version="5.6.2",xe.exports=q,void 0!==(J=function(){return q}.apply(Oe,[]))&&(xe.exports=J),q.getFromDisk=function(w,l){if(!l)throw"callback is mandatory.";console.log("Getting recorded "+("all"===w?"blobs":w+" blob ")+" from disk!"),Ze.Fetch(function(b,D){"all"!==w&&D===w+"Blob"&&l&&l(b),"all"===w&&l&&l(b,D.replace("Blob",""))})},q.writeToDisk=function(w){console.log("Writing recorded blob(s) to disk!"),(w=w||{}).audio&&w.video&&w.gif?w.audio.getDataURL(function(l){w.video.getDataURL(function(b){w.gif.getDataURL(function(D){Ze.Store({audioBlob:l,videoBlob:b,gifBlob:D})})})}):w.audio&&w.video?w.audio.getDataURL(function(l){w.video.getDataURL(function(b){Ze.Store({audioBlob:l,videoBlob:b})})}):w.audio&&w.gif?w.audio.getDataURL(function(l){w.gif.getDataURL(function(b){Ze.Store({audioBlob:l,gifBlob:b})})}):w.video&&w.gif?w.video.getDataURL(function(l){w.gif.getDataURL(function(b){Ze.Store({videoBlob:l,gifBlob:b})})}):w.audio?w.audio.getDataURL(function(l){Ze.Store({audioBlob:l})}):w.video?w.video.getDataURL(function(l){Ze.Store({videoBlob:l})}):w.gif&&w.gif.getDataURL(function(l){Ze.Store({gifBlob:l})})},k.getFromDisk=q.getFromDisk,k.writeToDisk=q.writeToDisk,void 0!==q&&(q.MRecordRTC=k),!(w="undefined"!=typeof global?global:null)||"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},global.console||(global.console={}),(void 0===global.console.log||void 0===global.console.error)&&(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(w.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var l={getContext:function(){return l},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return l},w.HTMLVideoElement=function(){}),"undefined"==typeof location&&(w.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(w.screen={width:0,height:0}),void 0===Me&&(w.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),w.window=global);var ue=window.requestAnimationFrame;if(void 0===ue)if("undefined"!=typeof webkitRequestAnimationFrame)ue=webkitRequestAnimationFrame;else if("undefined"!=typeof mozRequestAnimationFrame)ue=mozRequestAnimationFrame;else if("undefined"!=typeof msRequestAnimationFrame)ue=msRequestAnimationFrame;else if(void 0===ue){var _=0;ue=function(w,l){var b=(new Date).getTime(),D=Math.max(0,16-(b-_)),j=setTimeout(function(){w(b+D)},D);return _=b+D,j}}var se=window.cancelAnimationFrame;void 0===se&&("undefined"!=typeof webkitCancelAnimationFrame?se=webkitCancelAnimationFrame:"undefined"!=typeof mozCancelAnimationFrame?se=mozCancelAnimationFrame:"undefined"!=typeof msCancelAnimationFrame?se=msCancelAnimationFrame:void 0===se&&(se=function(w){clearTimeout(w)}));var X=window.AudioContext;void 0===X&&("undefined"!=typeof webkitAudioContext&&(X=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(X=mozAudioContext));var Me=window.URL;void 0===Me&&"undefined"!=typeof webkitURL&&(Me=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var o=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),h=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),S=!h&&!o&&!!navigator.webkitGetUserMedia||Ee()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),F=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);F&&!S&&-1!==navigator.userAgent.indexOf("CriOS")&&(F=!1,S=!0);var V=window.MediaStream;function M(w){if(0===w)return"0 Bytes";var D=parseInt(Math.floor(Math.log(w)/Math.log(1e3)),10);return(w/Math.pow(1e3,D)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][D]}function me(w,l){if(!w)throw"Blob object is required.";if(!w.type)try{w.type="video/webm"}catch(Q){}var b=(w.type||"video/webm").split("/")[1];if(-1!==b.indexOf(";")&&(b=b.split(";")[0]),l&&-1!==l.indexOf(".")){var D=l.split(".");l=D[0],b=D[1]}var j=(l||Math.round(9999999999*Math.random())+888888888)+"."+b;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(w,j);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(w,j);var R=document.createElement("a");R.href=Me.createObjectURL(w),R.download=j,R.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(R),"function"==typeof R.click?R.click():(R.target="_blank",R.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),Me.revokeObjectURL(R.href)}function Ee(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&!!process.versions.electron||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}function Z(w,l){return w&&w.getTracks?w.getTracks().filter(function(b){return b.kind===(l||"audio")}):[]}function le(w,l){"srcObject"in l?l.srcObject=w:"mozSrcObject"in l?l.mozSrcObject=w:l.srcObject=w}void 0===V&&"undefined"!=typeof webkitMediaStream&&(V=webkitMediaStream),void 0!==V&&void 0===V.prototype.stop&&(V.prototype.stop=function(){this.getTracks().forEach(function(w){w.stop()})}),void 0!==q&&(q.invokeSaveAsDialog=me,q.getTracks=Z,q.getSeekableBlob=function be(w,l){if("undefined"==typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var b=new EBML.Reader,D=new EBML.Decoder,j=EBML.tools,R=new FileReader;R.onload=function(Q){D.decode(this.result).forEach(function(G){b.read(G)}),b.stop();var de=j.makeMetadataSeekable(b.metadatas,b.duration,b.cues),Ce=this.result.slice(b.metadataSize),K=new Blob([de,Ce],{type:"video/webm"});l(K)},R.readAsArrayBuffer(w)},q.bytesToSize=M,q.isElectron=Ee);var Pe={};function qe(){if(g||F||o)return!0;navigator;var R,Q,l=navigator.userAgent,b=""+parseFloat(navigator.appVersion),D=parseInt(navigator.appVersion,10);return(S||h)&&(R=l.indexOf("Chrome"),b=l.substring(R+7)),-1!==(Q=b.indexOf(";"))&&(b=b.substring(0,Q)),-1!==(Q=b.indexOf(" "))&&(b=b.substring(0,Q)),D=parseInt(""+b,10),isNaN(D)&&(b=""+parseFloat(navigator.appVersion),D=parseInt(navigator.appVersion,10)),D>=49}function fe(w,l){var b,K=this;if(void 0===w)throw'First argument "MediaStream" is required.';if("undefined"==typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";"audio"===(l=l||{mimeType:"video/webm"}).type&&(Z(w,"video").length&&Z(w,"audio").length&&(navigator.mozGetUserMedia?(b=new V).addTrack(Z(w,"audio")[0]):b=new V(Z(w,"audio")),w=b),(!l.mimeType||-1===l.mimeType.toString().toLowerCase().indexOf("audio"))&&(l.mimeType=S?"audio/webm":"audio/ogg"),l.mimeType&&"audio/ogg"!==l.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(l.mimeType="audio/ogg"));var N,D=[];function j(){K.timestamps.push((new Date).getTime()),"function"==typeof l.onTimeStamp&&l.onTimeStamp(K.timestamps[K.timestamps.length-1],K.timestamps)}function R(G){return N&&N.mimeType?N.mimeType:G.mimeType||"video/webm"}function Q(){D=[],N=null,K.timestamps=[]}this.getArrayOfBlobs=function(){return D},this.record=function(){K.blob=null,K.clearRecordedData(),K.timestamps=[],Ce=[],D=[];var G=l;l.disableLogs||console.log("Passing following config over MediaRecorder API.",G),N&&(N=null),S&&!qe()&&(G="video/vp8"),"function"==typeof MediaRecorder.isTypeSupported&&G.mimeType&&(MediaRecorder.isTypeSupported(G.mimeType)||(l.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",G.mimeType),G.mimeType="audio"===l.type?"audio/webm":"video/webm"));try{N=new MediaRecorder(w,G),l.mimeType=G.mimeType}catch(ne){N=new MediaRecorder(w)}G.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in N&&!1===N.canRecordMimeType(G.mimeType)&&(l.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",G.mimeType)),N.ondataavailable=function(ne){if(ne.data&&Ce.push("ondataavailable: "+M(ne.data.size)),"number"!=typeof l.timeSlice)!ne.data||!ne.data.size||ne.data.size<100||K.blob?K.recordingCallback&&(K.recordingCallback(new Blob([],{type:R(G)})),K.recordingCallback=null):(K.blob=l.getNativeBlob?ne.data:new Blob([ne.data],{type:R(G)}),K.recordingCallback&&(K.recordingCallback(K.blob),K.recordingCallback=null));else if(ne.data&&ne.data.size&&(D.push(ne.data),j(),"function"==typeof l.ondataavailable)){var ce=l.getNativeBlob?ne.data:new Blob([ne.data],{type:R(G)});l.ondataavailable(ce)}},N.onstart=function(){Ce.push("started")},N.onpause=function(){Ce.push("paused")},N.onresume=function(){Ce.push("resumed")},N.onstop=function(){Ce.push("stopped")},N.onerror=function(ne){!ne||(ne.name||(ne.name="UnknownError"),Ce.push("error: "+ne),l.disableLogs||(-1!==ne.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",ne):-1!==ne.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",G.mimeType,") is not supported.",ne):-1!==ne.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",ne):"OutOfMemory"===ne.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",ne):"IllegalStreamModification"===ne.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",ne):"OtherRecordingError"===ne.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",ne):"GenericError"===ne.name?console.error("The UA cannot provide the codec or recording option that has been requested.",ne):console.error("MediaRecorder Error",ne)),function(ce){if(!K.manuallyStopped&&N&&"inactive"===N.state)return delete l.timeslice,void N.start(6e5);setTimeout(void 0,1e3)}(),"inactive"!==N.state&&"stopped"!==N.state&&N.stop())},"number"==typeof l.timeSlice?(j(),N.start(l.timeSlice)):N.start(36e5),l.initCallback&&l.initCallback()},this.timestamps=[],this.stop=function(G){G=G||function(){},K.manuallyStopped=!0,N&&(this.recordingCallback=G,"recording"===N.state&&N.stop(),"number"==typeof l.timeSlice&&setTimeout(function(){K.blob=new Blob(D,{type:R(l)}),K.recordingCallback(K.blob)},100))},this.pause=function(){!N||"recording"===N.state&&N.pause()},this.resume=function(){!N||"paused"===N.state&&N.resume()},this.clearRecordedData=function(){N&&"recording"===N.state&&K.stop(Q),Q()},this.getInternalRecorder=function(){return N},this.blob=null,this.getState=function(){return N&&N.state||"inactive"};var Ce=[];this.getAllStates=function(){return Ce},void 0===l.checkForInactiveTracks&&(l.checkForInactiveTracks=!1),K=this,function G(){if(N&&!1!==l.checkForInactiveTracks){if(!1===function de(){if("active"in w){if(!w.active)return!1}else if("ended"in w&&w.ended)return!1;return!0}())return l.disableLogs||console.log("MediaStream seems stopped."),void K.stop();setTimeout(G,1e3)}}(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}function Ye(w,l){if(!Z(w,"audio").length)throw"Your stream has no audio tracks.";var N,b=this,D=[],j=[],R=!1,Q=0,de=2,Ce=(l=l||{}).desiredSampRate;function K(){if(!1===l.checkForInactiveTracks)return!0;if("active"in w){if(!w.active)return!1}else if("ended"in w&&w.ended)return!1;return!0}function G(Ge,Dt){function ft(xt,kn){var Jt,ot=xt.numberOfAudioChannels,St=xt.leftBuffers.slice(0),Qt=xt.rightBuffers.slice(0),Vt=xt.sampleRate,$t=xt.internalInterleavedLength,Lt=xt.desiredSampRate;function bn(ht,Qe,Nt){var At=Math.round(ht.length*(Qe/Nt)),kt=[],Kt=Number((ht.length-1)/(At-1));kt[0]=ht[0];for(var rn=1;rn<At-1;rn++){var Cn=rn*Kt,Ws=Number(Math.floor(Cn)).toFixed(),vi=Number(Math.ceil(Cn)).toFixed();kt[rn]=fs(ht[Ws],ht[vi],Cn-Ws)}return kt[At-1]=ht[ht.length-1],kt}function fs(ht,Qe,Nt){return ht+(Qe-ht)*Nt}function ps(ht,Qe){for(var Nt=new Float64Array(Qe),At=0,kt=ht.length,Kt=0;Kt<kt;Kt++){var rn=ht[Kt];Nt.set(rn,At),At+=rn.length}return Nt}function fn(ht,Qe,Nt){for(var At=Nt.length,kt=0;kt<At;kt++)ht.setUint8(Qe+kt,Nt.charCodeAt(kt))}2===ot&&(St=ps(St,$t),Qt=ps(Qt,$t),Lt&&(St=bn(St,Lt,Vt),Qt=bn(Qt,Lt,Vt))),1===ot&&(St=ps(St,$t),Lt&&(St=bn(St,Lt,Vt))),Lt&&(Vt=Lt),2===ot&&(Jt=function Hn(ht,Qe){for(var Nt=ht.length+Qe.length,At=new Float64Array(Nt),kt=0,Kt=0;Kt<Nt;)At[Kt++]=ht[kt],At[Kt++]=Qe[kt],kt++;return At}(St,Qt)),1===ot&&(Jt=St);var Fn=Jt.length,pn=new ArrayBuffer(44+2*Fn),vt=new DataView(pn);fn(vt,0,"RIFF"),vt.setUint32(4,36+2*Fn,!0),fn(vt,8,"WAVE"),fn(vt,12,"fmt "),vt.setUint32(16,16,!0),vt.setUint16(20,1,!0),vt.setUint16(22,ot,!0),vt.setUint32(24,Vt,!0),vt.setUint32(28,Vt*ot*2,!0),vt.setUint16(32,2*ot,!0),vt.setUint16(34,16,!0),fn(vt,36,"data"),vt.setUint32(40,2*Fn,!0);for(var Ls=Fn,Bs=44,Yn=0;Yn<Ls;Yn++)vt.setInt16(Bs,32767*Jt[Yn],!0),Bs+=2;if(kn)return kn({buffer:pn,view:vt});postMessage({buffer:pn,view:vt})}if(Ge.noWorker)ft(Ge,function(xt){Dt(xt.buffer,xt.view)});else{var dn=function ne(Ge){var Dt=Me.createObjectURL(new Blob([Ge.toString(),";this.onmessage =  function (eee) {"+Ge.name+"(eee.data);}"],{type:"application/javascript"})),ft=new Worker(Dt);return ft.workerURL=Dt,ft}(ft);dn.onmessage=function(xt){Dt(xt.data.buffer,xt.data.view),Me.revokeObjectURL(dn.workerURL),dn.terminate()},dn.postMessage(Ge)}}!0===l.leftChannel&&(de=1),1===l.numberOfAudioChannels&&(de=1),(!de||de<1)&&(de=2),l.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+de),void 0===l.checkForInactiveTracks&&(l.checkForInactiveTracks=!0),this.record=function(){if(!1===K())throw"Please make sure MediaStream is active.";ie(),W=$=!1,R=!0,void 0!==l.timeSlice&&Ke()},this.stop=function(Ge){Ge=Ge||function(){},R=!1,G({desiredSampRate:Ce,sampleRate:pe,numberOfAudioChannels:de,internalInterleavedLength:Q,leftBuffers:D,rightBuffers:1===de?[]:j,noWorker:l.noWorker},function(Dt,ft){b.blob=new Blob([ft],{type:"audio/wav"}),b.buffer=new ArrayBuffer(ft.buffer.byteLength),b.view=ft,b.sampleRate=Ce||pe,b.bufferSize=Ie,b.length=Q,W=!1,Ge&&Ge(b.blob)})},void 0===q.Storage&&(q.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!q.Storage.AudioContextConstructor||"closed"===q.Storage.AudioContextConstructor.state)&&(q.Storage.AudioContextConstructor=new q.Storage.AudioContext);var ce=q.Storage.AudioContextConstructor,H=ce.createMediaStreamSource(w),De=[0,256,512,1024,2048,4096,8192,16384],Ie=void 0===l.bufferSize?4096:l.bufferSize;if(-1===De.indexOf(Ie)&&(l.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(De,null,"\t"))),ce.createJavaScriptNode)N=ce.createJavaScriptNode(Ie,de,de);else{if(!ce.createScriptProcessor)throw"WebAudio API has no support on this browser.";N=ce.createScriptProcessor(Ie,de,de)}H.connect(N),l.bufferSize||(Ie=N.bufferSize);var pe=void 0!==l.sampleRate?l.sampleRate:ce.sampleRate||44100;(pe<22050||pe>96e3)&&(l.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),l.disableLogs||l.desiredSampRate&&console.log("Desired sample-rate: "+l.desiredSampRate);var $=!1;function ie(){j=[],Q=0,W=!1,R=!1,$=!1,ce=null,b.leftchannel=D=[],b.rightchannel=j,b.numberOfAudioChannels=de,b.desiredSampRate=Ce,b.sampleRate=pe,b.recordingLength=Q,Ae={left:[],right:[],recordingLength:0}}function P(){N&&(N.onaudioprocess=null,N.disconnect(),N=null),H&&(H.disconnect(),H=null),ie()}this.pause=function(){$=!0},this.resume=function(){if(!1===K())throw"Please make sure MediaStream is active.";if(!R)return l.disableLogs||console.log("Seems recording has been restarted."),void this.record();$=!1},this.clearRecordedData=function(){l.checkForInactiveTracks=!1,R&&this.stop(P),P()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var W=!1;N.onaudioprocess=function we(Ge){if(!$){if(!1===K()&&(l.disableLogs||console.log("MediaStream seems stopped."),N.disconnect(),R=!1),!R)return void(H&&(H.disconnect(),H=null));W||(W=!0,l.onAudioProcessStarted&&l.onAudioProcessStarted(),l.initCallback&&l.initCallback());var Dt=Ge.inputBuffer.getChannelData(0),ft=new Float32Array(Dt);if(D.push(ft),2===de){var dn=Ge.inputBuffer.getChannelData(1),xt=new Float32Array(dn);j.push(xt)}b.recordingLength=Q+=Ie,void 0!==l.timeSlice&&(Ae.recordingLength+=Ie,Ae.left.push(ft),2===de&&Ae.right.push(xt))}},N.connect(ce.createMediaStreamDestination?ce.createMediaStreamDestination():ce.destination),this.leftchannel=D,this.rightchannel=j,this.numberOfAudioChannels=de,this.desiredSampRate=Ce,this.sampleRate=pe,b.recordingLength=Q;var Ae={left:[],right:[],recordingLength:0};function Ke(){!R||"function"!=typeof l.ondataavailable||void 0===l.timeSlice||(Ae.left.length?(G({desiredSampRate:Ce,sampleRate:pe,numberOfAudioChannels:de,internalInterleavedLength:Ae.recordingLength,leftBuffers:Ae.left,rightBuffers:1===de?[]:Ae.right},function(Ge,Dt){var ft=new Blob([Dt],{type:"audio/wav"});l.ondataavailable(ft),setTimeout(Ke,l.timeSlice)}),Ae={left:[],right:[],recordingLength:0}):setTimeout(Ke,l.timeSlice))}}function We(w,l){if("undefined"==typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";(l=l||{}).frameInterval||(l.frameInterval=10);var b=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(De){De in document.createElement("canvas")&&(b=!0)});var Q,N,de,D=!(!window.webkitRTCPeerConnection&&!window.webkitGetUserMedia||!window.chrome),j=50,R=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(D&&R&&R[2]&&(j=parseInt(R[2],10)),D&&j<52&&(b=!1),l.useWhammyRecorder&&(b=!1),b)if(l.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),w instanceof HTMLCanvasElement)Q=w;else{if(!(w instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";Q=w.canvas}else navigator.mozGetUserMedia&&(l.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(de=!0,b&&!l.useWhammyRecorder){var De;"captureStream"in Q?De=Q.captureStream(25):"mozCaptureStream"in Q?De=Q.mozCaptureStream(25):"webkitCaptureStream"in Q&&(De=Q.webkitCaptureStream(25));try{var Ie=new V;Ie.addTrack(Z(De,"video")[0]),De=Ie}catch(pe){}if(!De)throw"captureStream API are NOT available.";(N=new fe(De,{mimeType:l.mimeType||"video/webm"})).record()}else H.frames=[],ce=(new Date).getTime(),ne();l.initCallback&&l.initCallback()},this.getWebPImages=function(De){if("canvas"===w.nodeName.toLowerCase()){var Ie=H.frames.length;H.frames.forEach(function(pe,$){var ie=Ie-$;l.disableLogs||console.log(ie+"/"+Ie+" frames remaining"),l.onEncodingCallback&&l.onEncodingCallback(ie,Ie);var P=pe.image.toDataURL("image/webp",1);H.frames[$].image=P}),l.disableLogs||console.log("Generating WebM"),De()}else De()},this.stop=function(De){de=!1;var Ie=this;b&&N?N.stop(De):this.getWebPImages(function(){H.compile(function(pe){l.disableLogs||console.log("Recording finished!"),Ie.blob=pe,Ie.blob.forEach&&(Ie.blob=new Blob([],{type:"video/webm"})),De&&De(Ie.blob),H.frames=[]})})};var Ce=!1;function K(){H.frames=[],de=!1,Ce=!1}function G(){var De=document.createElement("canvas"),Ie=De.getContext("2d");return De.width=w.width,De.height=w.height,Ie.drawImage(w,0,0),De}function ne(){if(Ce)return ce=(new Date).getTime(),setTimeout(ne,500);if("canvas"===w.nodeName.toLowerCase()){var De=(new Date).getTime()-ce;return ce=(new Date).getTime(),H.frames.push({image:G(),duration:De}),void(de&&setTimeout(ne,l.frameInterval))}html2canvas(w,{grabMouse:void 0===l.showMousePointer||l.showMousePointer,onrendered:function(Ie){var pe=(new Date).getTime()-ce;if(!pe)return setTimeout(ne,l.frameInterval);ce=(new Date).getTime(),H.frames.push({image:Ie.toDataURL("image/webp",1),duration:pe}),de&&setTimeout(ne,l.frameInterval)}})}this.pause=function(){Ce=!0,N instanceof fe&&N.pause()},this.resume=function(){Ce=!1,N instanceof fe?N.resume():de||this.record()},this.clearRecordedData=function(){de&&this.stop(K),K()},this.name="CanvasRecorder",this.toString=function(){return this.name};var ce=(new Date).getTime(),H=new wt.Video(100)}function nt(w,l){function b(ce){ce=void 0!==ce?ce:10;var H=(new Date).getTime()-G;return H?Q?(G=(new Date).getTime(),setTimeout(b,100)):(G=(new Date).getTime(),K.paused&&K.play(),Ce.drawImage(K,0,0,de.width,de.height),ne.frames.push({duration:H,image:de.toDataURL("image/webp")}),void(R||setTimeout(b,ce,ce))):setTimeout(b,ce,ce)}(l=l||{}).frameInterval||(l.frameInterval=10),l.disableLogs||console.log("Using frames-interval:",l.frameInterval),this.record=function(){l.width||(l.width=320),l.height||(l.height=240),l.video||(l.video={width:l.width,height:l.height}),l.canvas||(l.canvas={width:l.width,height:l.height}),de.width=l.canvas.width||320,de.height=l.canvas.height||240,Ce=de.getContext("2d"),l.video&&l.video instanceof HTMLVideoElement?(K=l.video.cloneNode(),l.initCallback&&l.initCallback()):(K=document.createElement("video"),le(w,K),K.onloadedmetadata=function(){l.initCallback&&l.initCallback()},K.width=l.video.width,K.height=l.video.height),K.muted=!0,K.play(),G=(new Date).getTime(),ne=new wt.Video,l.disableLogs||(console.log("canvas resolutions",de.width,"*",de.height),console.log("video width/height",K.width||de.width,"*",K.height||de.height)),b(l.frameInterval)};var R=!1;this.stop=function(ce){ce=ce||function(){},R=!0;var H=this;setTimeout(function(){!function j(ce,H,De,Ie,pe){var $=document.createElement("canvas");$.width=de.width,$.height=de.height;var ie=$.getContext("2d"),P=[],W=-1===H,we=H&&H>0&&H<=ce.length?H:ce.length,Ke=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),Ge=De&&De>=0&&De<=1?De:0,Dt=Ie&&Ie>=0&&Ie<=1?Ie:0,ft=!1;!function D(ce){var H=-1,De=ce.length;!function Ie(){++H!==De?setTimeout(function(){ce.functionToLoop(Ie,H)},1):ce.callback()}()}({length:we,functionToLoop:function(dn,xt){var kn,ot,St,Qt=function(){!ft&&St-kn<=St*Dt||(W&&(ft=!0),P.push(ce[xt])),dn()};if(ft)Qt();else{var Vt=new Image;Vt.onload=function(){ie.drawImage(Vt,0,0,de.width,de.height);var $t=ie.getImageData(0,0,de.width,de.height);kn=0,ot=$t.data.length,St=$t.data.length/4;for(var Lt=0;Lt<ot;Lt+=4){var bn={r:$t.data[Lt],g:$t.data[Lt+1],b:$t.data[Lt+2]};Math.sqrt(Math.pow(bn.r-0,2)+Math.pow(bn.g-0,2)+Math.pow(bn.b-0,2))<=Ke*Ge&&kn++}Qt()},Vt.src=ce[xt].image}},callback:function(){(P=P.concat(ce.slice(we))).length<=0&&P.push(ce[ce.length-1]),pe(P)}})}(ne.frames,-1,null,null,function(De){ne.frames=De,l.advertisement&&l.advertisement.length&&(ne.frames=l.advertisement.concat(ne.frames)),ne.compile(function(Ie){H.blob=Ie,H.blob.forEach&&(H.blob=new Blob([],{type:"video/webm"})),ce&&ce(H.blob)})})},10)};var Q=!1;function N(){ne.frames=[],R=!0,Q=!1}this.pause=function(){Q=!0},this.resume=function(){Q=!1,R&&this.record()},this.clearRecordedData=function(){R||this.stop(N),N()},this.name="WhammyRecorder",this.toString=function(){return this.name};var K,G,ne,de=document.createElement("canvas"),Ce=de.getContext("2d")}void 0!==X?Pe.AudioContext=X:"undefined"!=typeof webkitAudioContext&&(Pe.AudioContext=webkitAudioContext),void 0!==q&&(q.Storage=Pe),void 0!==q&&(q.MediaStreamRecorder=fe),void 0!==q&&(q.StereoAudioRecorder=Ye),void 0!==q&&(q.CanvasRecorder=We),void 0!==q&&(q.WhammyRecorder=nt);var wt=function(){function w(D){this.frames=[],this.duration=D||1,this.quality=.8}function b(D){function R($,ie,P){return[{data:$,id:231}].concat(P.map(function(W){var we=function ne($){var ie=0;if($.keyframe&&(ie|=128),$.invisible&&(ie|=8),$.lacing&&(ie|=$.lacing<<1),$.discardable&&(ie|=1),$.trackNum>127)throw"TrackNumber > 127 not supported";var P=[128|$.trackNum,$.timecode>>8,255&$.timecode,ie].map(function(W){return String.fromCharCode(W)}).join("")+$.frame;return P}({discardable:0,frame:W.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(ie)});return ie+=W.duration,{data:we,id:163}}))}function N($){for(var ie=[];$>0;)ie.push(255&$),$>>=8;return new Uint8Array(ie.reverse())}function de($){return new Uint8Array($.split("").map(function(ie){return ie.charCodeAt(0)}))}function Ce($){var ie=[];$=($.length%8?new Array(9-$.length%8).join("0"):"")+$;for(var W=0;W<$.length;W+=8)ie.push(parseInt($.substr(W,8),2));return new Uint8Array(ie)}function K($){for(var ie=[],P=0;P<$.length;P++){var W=$[P].data;"object"==typeof W&&(W=K(W)),"number"==typeof W&&(W=Ce(W.toString(2))),"string"==typeof W&&(W=de(W));var we=W.size||W.byteLength||W.length,Ae=Math.ceil(Math.ceil(Math.log(we)/Math.log(2))/8),Ke=we.toString(2),Ge=new Array(7*Ae+7+1-Ke.length).join("0")+Ke,Dt=new Array(Ae).join("0")+"1"+Ge;ie.push(N($[P].id)),ie.push(Ce(Dt)),ie.push(W)}return new Blob(ie,{type:"video/webm"})}function H($,ie){return parseInt($.substr(ie+4,4).split("").map(function(P){var W=P.charCodeAt(0).toString(2);return new Array(8-W.length+1).join("0")+W}).join(""),2)}function De($){for(var ie=0,P={};ie<$.length;){var W=$.substr(ie,4),we=H($,ie),Ae=$.substr(ie+4+4,we);ie+=8+we,P[W]=P[W]||[],P[W].push("RIFF"===W||"LIST"===W?De(Ae):Ae)}return P}function Ie($){return[].slice.call(new Uint8Array(new Float64Array([$]).buffer),0).map(function(ie){return String.fromCharCode(ie)}).reverse().join("")}var pe=new function j($){var ie=function Q($){if($[0]){for(var ie=$[0].width,P=$[0].height,W=$[0].duration,we=1;we<$.length;we++)W+=$[we].duration;return{duration:W,width:ie,height:P}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}($);if(!ie)return[];for(var W=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:Ie(ie.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:ie.width,id:176},{data:ie.height,id:186}]}]}]}]}],we=0,Ae=0;we<$.length;){var Ke=[],Ge=0;do{Ke.push($[we]),Ge+=$[we].duration,we++}while(we<$.length&&Ge<3e4);var ft={id:524531317,data:R(Ae,0,Ke)};W[1].data.push(ft),Ae+=Ge}return K(W)}(D.map(function($){var ie=function ce($){for(var ie=$.RIFF[0].WEBP[0],P=ie.indexOf("\x9d\x01*"),W=0,we=[];W<4;W++)we[W]=ie.charCodeAt(P+3+W);return{width:16383&(we[1]<<8|we[0]),height:16383&(we[3]<<8|we[2]),data:ie,riff:$}}(De(atob($.image.slice(23))));return ie.duration=$.duration,ie}));postMessage(pe)}return w.prototype.add=function(D,j){if("canvas"in D&&(D=D.canvas),"toDataURL"in D&&(D=D.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(D))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:D,duration:j||this.duration})},w.prototype.compile=function(D){var j=function l(D){var j=Me.createObjectURL(new Blob([D.toString(),"this.onmessage =  function (eee) {"+D.name+"(eee.data);}"],{type:"application/javascript"})),R=new Worker(j);return Me.revokeObjectURL(j),R}(b);j.onmessage=function(R){R.data.error?console.error(R.data.error):D(R.data)},j.postMessage(this.frames)},{Video:w}}();void 0!==q&&(q.Whammy=wt);var Ze={init:function(){var w=this;if("undefined"!=typeof indexedDB&&void 0!==indexedDB.open){var D,b=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),j=indexedDB.open(b,1);j.onerror=w.onError,j.onsuccess=function(){(D=j.result).onerror=w.onError,D.setVersion&&1!==D.version?D.setVersion(1).onsuccess=function(){R(D),Q()}:Q()},j.onupgradeneeded=function(N){R(N.target.result)}}else console.error("IndexedDB API are not available in this browser.");function R(N){N.createObjectStore(w.dataStoreName)}function Q(){var N=D.transaction([w.dataStoreName],"readwrite");function de(Ce){N.objectStore(w.dataStoreName).get(Ce).onsuccess=function(K){w.callback&&w.callback(K.target.result,Ce)}}w.videoBlob&&N.objectStore(w.dataStoreName).put(w.videoBlob,"videoBlob"),w.gifBlob&&N.objectStore(w.dataStoreName).put(w.gifBlob,"gifBlob"),w.audioBlob&&N.objectStore(w.dataStoreName).put(w.audioBlob,"audioBlob"),de("audioBlob"),de("videoBlob"),de("gifBlob")}},Fetch:function(w){return this.callback=w,this.init(),this},Store:function(w){return this.audioBlob=w.audioBlob,this.videoBlob=w.videoBlob,this.gifBlob=w.gifBlob,this.init(),this},onError:function(w){console.error(JSON.stringify(w,null,"\t"))},dataStoreName:"recordRTC",dbName:null};function Tt(w,l){if("undefined"==typeof GIFEncoder){var b=document.createElement("script");b.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(b)}l=l||{};var D=w instanceof CanvasRenderingContext2D||w instanceof HTMLCanvasElement;this.record=function(){"undefined"!=typeof GIFEncoder&&de?(D||(l.width||(l.width=Ce.offsetWidth||320),l.height||(l.height=Ce.offsetHeight||240),l.video||(l.video={width:l.width,height:l.height}),l.canvas||(l.canvas={width:l.width,height:l.height}),Q.width=l.canvas.width||320,Q.height=l.canvas.height||240,Ce.width=l.video.width||320,Ce.height=l.video.height||240),(H=new GIFEncoder).setRepeat(0),H.setDelay(l.frameRate||200),H.setQuality(l.quality||10),H.start(),"function"==typeof l.onGifRecordingStarted&&l.onGifRecordingStarted(),Date.now(),K=ue(function Ie(pe){if(!0!==De.clearedRecordedData){if(j)return setTimeout(function(){Ie(pe)},100);K=ue(Ie),void 0===typeof ce&&(ce=pe),!(pe-ce<90)&&(!D&&Ce.paused&&Ce.play(),D||N.drawImage(Ce,0,0,Q.width,Q.height),l.onGifPreview&&l.onGifPreview(Q.toDataURL("image/png")),H.addFrame(N),ce=pe)}}),l.initCallback&&l.initCallback()):setTimeout(De.record,1e3)},this.stop=function(Ie){Ie=Ie||function(){},K&&se(K),Date.now(),this.blob=new Blob([new Uint8Array(H.stream().bin)],{type:"image/gif"}),Ie(this.blob),H.stream().bin=[]};var j=!1;this.pause=function(){j=!0},this.resume=function(){j=!1},this.clearRecordedData=function(){De.clearedRecordedData=!0,function R(){H&&(H.stream().bin=[])}()},this.name="GifRecorder",this.toString=function(){return this.name};var Q=document.createElement("canvas"),N=Q.getContext("2d");D&&(w instanceof CanvasRenderingContext2D?Q=(N=w).canvas:w instanceof HTMLCanvasElement&&(N=w.getContext("2d"),Q=w));var de=!0;if(!D){var Ce=document.createElement("video");Ce.muted=!0,Ce.autoplay=!0,Ce.playsInline=!0,de=!1,Ce.onloadedmetadata=function(){de=!0},le(w,Ce),Ce.play()}var ce,H,K=null,De=this}function zt(w,l){var P;P="undefined"!=typeof global?global:null,void 0===q&&(!P||"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},global.console||(global.console={}),(void 0===global.console.log||void 0===global.console.error)&&(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(P.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var W={getContext:function(){return W},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return W},P.HTMLVideoElement=function(){}),"undefined"==typeof location&&(P.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(P.screen={width:0,height:0}),void 0===Ce&&(P.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),P.window=global)),l=l||"multi-streams-mixer";var D=[],j=!1,R=document.createElement("canvas"),Q=R.getContext("2d");R.style.opacity=0,R.style.position="absolute",R.style.zIndex=-1,R.style.top="-1000em",R.style.left="-1000em",R.className=l,(document.body||document.documentElement).appendChild(R),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var N=this,de=window.AudioContext;void 0===de&&("undefined"!=typeof webkitAudioContext&&(de=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(de=mozAudioContext));var Ce=window.URL;void 0===Ce&&"undefined"!=typeof webkitURL&&(Ce=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var K=window.MediaStream;void 0===K&&"undefined"!=typeof webkitMediaStream&&(K=webkitMediaStream),void 0!==K&&void 0===K.prototype.stop&&(K.prototype.stop=function(){this.getTracks().forEach(function(P){P.stop()})});var G={};function ce(){if(!j){var P=D.length,W=!1,we=[];if(D.forEach(function(Ke){Ke.stream||(Ke.stream={}),Ke.stream.fullcanvas?W=Ke:we.push(Ke)}),W)R.width=W.stream.width,R.height=W.stream.height;else if(we.length){R.width=P>1?2*we[0].width:we[0].width;var Ae=1;(3===P||4===P)&&(Ae=2),(5===P||6===P)&&(Ae=3),(7===P||8===P)&&(Ae=4),(9===P||10===P)&&(Ae=5),R.height=we[0].height*Ae}else R.width=N.width||360,R.height=N.height||240;W&&W instanceof HTMLVideoElement&&H(W),we.forEach(function(Ke,Ge){H(Ke,Ge)}),setTimeout(ce,N.frameInterval)}}function H(P,W){if(!j){var we=0,Ae=0,Ke=P.width,Ge=P.height;1===W&&(we=P.width),2===W&&(Ae=P.height),3===W&&(we=P.width,Ae=P.height),4===W&&(Ae=2*P.height),5===W&&(we=P.width,Ae=2*P.height),6===W&&(Ae=3*P.height),7===W&&(we=P.width,Ae=3*P.height),void 0!==P.stream.left&&(we=P.stream.left),void 0!==P.stream.top&&(Ae=P.stream.top),void 0!==P.stream.width&&(Ke=P.stream.width),void 0!==P.stream.height&&(Ge=P.stream.height),Q.drawImage(P,we,Ae,Ke,Ge),"function"==typeof P.stream.onRender&&P.stream.onRender(Q,we,Ae,Ke,Ge,W)}}function $(P){var W=document.createElement("video");return function ne(P,W){"srcObject"in W?W.srcObject=P:"mozSrcObject"in W?W.mozSrcObject=P:W.srcObject=P}(P,W),W.className=l,W.muted=!0,W.volume=0,W.width=P.width||N.width||360,W.height=P.height||N.height||240,W.play(),W}function ie(P){D=[],(P=P||w).forEach(function(W){if(W.getTracks().filter(function(Ae){return"video"===Ae.kind}).length){var we=$(W);we.stream=W,D.push(we)}})}void 0!==de?G.AudioContext=de:"undefined"!=typeof webkitAudioContext&&(G.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){ce()},this.appendStreams=function(P){if(!P)throw"First parameter is required.";P instanceof Array||(P=[P]),P.forEach(function(W){var we=new K;if(W.getTracks().filter(function(Ge){return"video"===Ge.kind}).length){var Ae=$(W);Ae.stream=W,D.push(Ae),we.addTrack(W.getTracks().filter(function(Ge){return"video"===Ge.kind})[0])}if(W.getTracks().filter(function(Ge){return"audio"===Ge.kind}).length){var Ke=N.audioContext.createMediaStreamSource(W);N.audioDestination=N.audioContext.createMediaStreamDestination(),Ke.connect(N.audioDestination),we.addTrack(N.audioDestination.stream.getTracks().filter(function(Ge){return"audio"===Ge.kind})[0])}w.push(we)})},this.releaseStreams=function(){D=[],j=!0,N.gainNode&&(N.gainNode.disconnect(),N.gainNode=null),N.audioSources.length&&(N.audioSources.forEach(function(P){P.disconnect()}),N.audioSources=[]),N.audioDestination&&(N.audioDestination.disconnect(),N.audioDestination=null),N.audioContext&&N.audioContext.close(),N.audioContext=null,Q.clearRect(0,0,R.width,R.height),R.stream&&(R.stream.stop(),R.stream=null)},this.resetVideoStreams=function(P){P&&!(P instanceof Array)&&(P=[P]),ie(P)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function De(){j=!1;var P=function Ie(){var P;ie(),"captureStream"in R?P=R.captureStream():"mozCaptureStream"in R?P=R.mozCaptureStream():N.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var W=new K;return P.getTracks().filter(function(we){return"video"===we.kind}).forEach(function(we){W.addTrack(we)}),R.stream=W,W}(),W=function pe(){G.AudioContextConstructor||(G.AudioContextConstructor=new G.AudioContext),N.audioContext=G.AudioContextConstructor,N.audioSources=[],!0===N.useGainNode&&(N.gainNode=N.audioContext.createGain(),N.gainNode.connect(N.audioContext.destination),N.gainNode.gain.value=0);var P=0;if(w.forEach(function(W){if(W.getTracks().filter(function(Ae){return"audio"===Ae.kind}).length){P++;var we=N.audioContext.createMediaStreamSource(W);!0===N.useGainNode&&we.connect(N.gainNode),N.audioSources.push(we)}}),P)return N.audioDestination=N.audioContext.createMediaStreamDestination(),N.audioSources.forEach(function(W){W.connect(N.audioDestination)}),N.audioDestination.stream}();return W&&W.getTracks().filter(function(Ae){return"audio"===Ae.kind}).forEach(function(Ae){P.addTrack(Ae)}),w.forEach(function(Ae){}),P}}function Et(w,l){w=w||[];var D,j,b=this;(l=l||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}}).frameInterval||(l.frameInterval=10),l.video||(l.video={}),l.video.width||(l.video.width=360),l.video.height||(l.video.height=240),this.record=function(){D=new zt(w,l.elementClass||"multi-streams-mixer"),function R(){var Q=[];return w.forEach(function(N){Z(N,"video").forEach(function(de){Q.push(de)})}),Q}().length&&(D.frameInterval=l.frameInterval||10,D.width=l.video.width||360,D.height=l.video.height||240,D.startDrawingFrames()),l.previewStream&&"function"==typeof l.previewStream&&l.previewStream(D.getMixedStream()),(j=new fe(D.getMixedStream(),l)).record()},this.stop=function(Q){!j||j.stop(function(N){b.blob=N,Q(N),b.clearRecordedData()})},this.pause=function(){j&&j.pause()},this.resume=function(){j&&j.resume()},this.clearRecordedData=function(){j&&(j.clearRecordedData(),j=null),D&&(D.releaseStreams(),D=null)},this.addStreams=function(Q){if(!Q)throw"First parameter is required.";Q instanceof Array||(Q=[Q]),w.concat(Q),j&&D&&(D.appendStreams(Q),l.previewStream&&"function"==typeof l.previewStream&&l.previewStream(D.getMixedStream()))},this.resetVideoStreams=function(Q){!D||(Q&&!(Q instanceof Array)&&(Q=[Q]),D.resetVideoStreams(Q))},this.getMixer=function(){return D},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}function ye(w,l){var D,R,N;function Q(K,G){if(!l.workerPath&&!G)return D=!1,void fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(ce){ce.arrayBuffer().then(function(H){Q(K,H)})});if(!l.workerPath&&G instanceof ArrayBuffer){var ne=new Blob([G],{type:"text/javascript"});l.workerPath=Me.createObjectURL(ne)}l.workerPath||console.error("workerPath parameter is missing."),(R=new Worker(l.workerPath)).postMessage(l.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),R.addEventListener("message",function(ce){"READY"===ce.data?(R.postMessage({width:l.width,height:l.height,bitrate:l.bitrate||1200,timebaseDen:l.frameRate||30,realtime:l.realtime}),function j(){return new ReadableStream({start:function(K){var G=document.createElement("canvas"),ne=document.createElement("video"),ce=!0;ne.srcObject=w,ne.muted=!0,ne.height=l.height,ne.width=l.width,ne.volume=0,ne.onplaying=function(){G.width=l.width,G.height=l.height;var H=G.getContext("2d"),Ie=setInterval(function(){if(D&&(clearInterval(Ie),K.close()),ce&&(ce=!1,l.onVideoProcessStarted&&l.onVideoProcessStarted()),H.drawImage(ne,0,0),"closed"!==K._controlledReadableStream.state)try{K.enqueue(H.getImageData(0,0,l.width,l.height))}catch($){}},1e3/l.frameRate)},ne.play()}})}().pipeTo(new WritableStream({write:function(H){D?console.error("Got image, but recorder is finished!"):R.postMessage(H.data.buffer,[H.data.buffer])}}))):ce.data&&(N||Ce.push(ce.data))})}("undefined"==typeof ReadableStream||"undefined"==typeof WritableStream)&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),(l=l||{}).width=l.width||640,l.height=l.height||480,l.frameRate=l.frameRate||30,l.bitrate=l.bitrate||1200,l.realtime=l.realtime||!0,this.record=function(){Ce=[],N=!1,this.blob=null,Q(w),"function"==typeof l.initCallback&&l.initCallback()},this.pause=function(){N=!0},this.resume=function(){N=!1};var Ce=[];this.stop=function(K){D=!0;var G=this;!function de(K){R?(R.addEventListener("message",function(G){null===G.data&&(R.terminate(),R=null,K&&K())}),R.postMessage(null)):K&&K()}(function(){G.blob=new Blob(Ce,{type:"video/webm"}),K(G.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){Ce=[],N=!1,this.blob=null},this.blob=null}void 0!==q&&(q.DiskStorage=Ze),void 0!==q&&(q.GifRecorder=Tt),void 0===q&&(xe.exports=zt,void 0!==(J=function(){return zt}.apply(Oe,[]))&&(xe.exports=J)),void 0!==q&&(q.MultiStreamRecorder=Et),void 0!==q&&(q.RecordRTCPromisesHandler=function Ve(w,l){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(void 0===w)throw'First argument "MediaStream" is required.';var b=this;b.recordRTC=new q(w,l),this.startRecording=function(){return new Promise(function(D,j){try{b.recordRTC.startRecording(),D()}catch(R){j(R)}})},this.stopRecording=function(){return new Promise(function(D,j){try{b.recordRTC.stopRecording(function(R){b.blob=b.recordRTC.getBlob(),b.blob&&b.blob.size?D(R):j("Empty blob.",b.blob)})}catch(R){j(R)}})},this.pauseRecording=function(){return new Promise(function(D,j){try{b.recordRTC.pauseRecording(),D()}catch(R){j(R)}})},this.resumeRecording=function(){return new Promise(function(D,j){try{b.recordRTC.resumeRecording(),D()}catch(R){j(R)}})},this.getDataURL=function(D){return new Promise(function(j,R){try{b.recordRTC.getDataURL(function(Q){j(Q)})}catch(Q){R(Q)}})},this.getBlob=function(){return new Promise(function(D,j){try{D(b.recordRTC.getBlob())}catch(R){j(R)}})},this.getInternalRecorder=function(){return new Promise(function(D,j){try{D(b.recordRTC.getInternalRecorder())}catch(R){j(R)}})},this.reset=function(){return new Promise(function(D,j){try{D(b.recordRTC.reset())}catch(R){j(R)}})},this.destroy=function(){return new Promise(function(D,j){try{D(b.recordRTC.destroy())}catch(R){j(R)}})},this.getState=function(){return new Promise(function(D,j){try{D(b.recordRTC.getState())}catch(R){j(R)}})},this.blob=null,this.version="5.6.2"}),void 0!==q&&(q.WebAssemblyRecorder=ye)},9855:xe=>{window,xe.exports=function(Oe){var re={};function J(q){if(re[q])return re[q].exports;var m=re[q]={i:q,l:!1,exports:{}};return Oe[q].call(m.exports,m,m.exports,J),m.l=!0,m.exports}return J.m=Oe,J.c=re,J.d=function(q,m,E){J.o(q,m)||Object.defineProperty(q,m,{enumerable:!0,get:E})},J.r=function(q){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(q,"__esModule",{value:!0})},J.t=function(q,m){if(1&m&&(q=J(q)),8&m||4&m&&"object"==typeof q&&q&&q.__esModule)return q;var E=Object.create(null);if(J.r(E),Object.defineProperty(E,"default",{enumerable:!0,value:q}),2&m&&"string"!=typeof q)for(var k in q)J.d(E,k,function(he){return q[he]}.bind(null,k));return E},J.n=function(q){var m=q&&q.__esModule?function(){return q.default}:function(){return q};return J.d(m,"a",m),m},J.o=function(q,m){return Object.prototype.hasOwnProperty.call(q,m)},J.p="/lib/",J(J.s=1)}([function(Oe,re,J){var q=J(2);"string"==typeof q&&(q=[[Oe.i,q,""]]);J(4)(q,{hmr:!0,transform:void 0,insertInto:void 0}),q.locals&&(Oe.exports=q.locals)},function(Oe,re,J){"use strict";J.r(re);var q=J(0),m=J.n(q);function E(_,se){var X=Object.keys(_);return Object.getOwnPropertySymbols&&X.push.apply(X,Object.getOwnPropertySymbols(_)),se&&(X=X.filter(function(Me){return Object.getOwnPropertyDescriptor(_,Me).enumerable})),X}function k(_,se,X){return se in _?Object.defineProperty(_,se,{value:X,enumerable:!0,configurable:!0,writable:!0}):_[se]=X,_}function he(_,se){for(var X=0;X<se.length;X++){var Me=se[X];Me.enumerable=Me.enumerable||!1,Me.configurable=!0,"value"in Me&&(Me.writable=!0),Object.defineProperty(_,Me.key,Me)}}var ue=function(){function _(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(function(h,g){if(!(h instanceof g))throw new TypeError("Cannot call a class as a function")})(this,_),this.value="",this.options={canvasWidth:document.body.clientWidth||375,canvasHeight:83,boxColor:"#E4E4E4",scrollLeft:0,heightDecimal:35,heightDigit:18,lineWidth:2,colorDecimal:"#E4E4E4",colorDigit:"#E4E4E4",divide:10,precision:1,fontSize:20,fontColor:"#666",fontMarginTop:35,maxValue:230,minValue:100,currentValue:160},this.localState={startX:0,startY:0,isTouchEnd:!0,touchPoints:[]},this.browserEnv=window.hasOwnProperty("ontouchstart"),this.options=function(h){for(var g=1;g<arguments.length;g++)if(g%2){var S=null!=arguments[g]?arguments[g]:{};E(S,!0).forEach(function(F){k(h,F,S[F])})}else Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(arguments[g])):E(S).forEach(function(F){Object.defineProperty(h,F,Object.getOwnPropertyDescriptor(arguments[g],F))});return h}({},this.options,{},o),this.init(this.options)}var se,X;return se=_,(X=[{key:"_renderBox",value:function(o){var h=document.createElement("div"),g=document.createElement("canvas");this.canvas=g,h.className=m.a.box,h.appendChild(g),o.appendChild(h),this._renderCanvas()}},{key:"_renderCanvas",value:function(){var o=this.options,h=o.canvasWidth,g=o.canvasHeight,S=this.canvas;S.width=2*h,S.height=2*g,S.style.width=h+"px",S.style.height=g+"px",S.className=m.a.canvas,this.browserEnv?(S.ontouchstart=this.touchStart.bind(this),S.ontouchmove=this.touchMove.bind(this),S.ontouchend=this.touchEnd.bind(this)):(S.onmousedown=this.touchStart.bind(this),S.onmousemove=this.touchMove.bind(this),S.onmouseup=this.touchEnd.bind(this)),this.dreawCanvas()}},{key:"touchStart",value:function(o){if(o.preventDefault(),o||this.localState.isTouchEnd){this.touchPoints(o);var h=o.touches&&o.touches[0]||o;this.localState.startX=h.pageX,this.localState.startY=h.pageY,this.localState.startT=(new Date).getTime(),this.localState.isTouchEnd=!1}}},{key:"touchMove",value:function(o){if(this.browserEnv||1===o.which&&0!==o.buttons){this.touchPoints(o);var h=o.touches&&o.touches[0]||o,g=h.pageX-this.localState.startX,S=h.pageY-this.localState.startY;if(Math.abs(g)>Math.abs(S)&&Math.abs(Math.round(g/this.options.divide))>0){if(this.browserEnv&&!this.rebound(g))return;this.moveDreaw(g),this.localState.startX=h.pageX,this.localState.startY=h.pageY}}}},{key:"touchEnd",value:function(){this.moveDreaw(this.browserEnv?this.inertialShift():0),this.localState.isTouchEnd=!0,this.localState.touchPoints=[],this.canvas.style.transform="translate3d(0, 0, 0)"}},{key:"touchPoints",value:function(o){var h=o.touches&&o.touches[0]||o,g=(new Date).getTime();this.localState.touchPoints.push({time:g,shift:h.pageX})}},{key:"inertialShift",value:function(){var o=0;if(this.localState.touchPoints.length>=4){var h=this.localState.touchPoints.slice(-4),g=(h[3].shift-h[0].shift)/(h[3].time-h[0].time)*1e3;o=Math.sign(g)*Math.pow(g,2)/12e3}return o}},{key:"rebound",value:function(o){var h=this.options,g=h.currentValue;if(g===h.minValue&&o>0||g===h.maxValue&&o<0){var F=1.5988*Math.sign(o)*Math.pow(Math.abs(o),.7962);return this.canvas.style.transform="translate3d(".concat(F,"px, 0, 0)"),!1}return!0}},{key:"moveDreaw",value:function(o){var h=this,g=this.options,F=g.precision,V=Math.round(-o/g.divide),M=Math.abs(V);!function me(){M<1||(h.options.currentValue+=Math.sign(V)*F,h.dreawCanvas(),window.requestAnimationFrame(me),M--)}()}},{key:"dreawCanvas",value:function(){var o=this.canvas,h=o.getContext("2d");o.height=o.height;var g=this.options,S=g.canvasWidth,F=g.maxValue,V=g.minValue,M=g.currentValue,me=g.handleValue,Ee=g.precision,Z=g.divide,le=g.heightDecimal,be=g.heightDigit,Pe=g.lineWidth,qe=g.colorDecimal,fe=g.colorDigit,Ye=g.fontSize,We=g.fontColor,nt=g.fontMarginTop;M=M>V?M<F?M:F:V,M=Math.round(10*M/Ee)*Ee/10,this.options.currentValue=M,me&&me(M);var wt=(M-V)*Z/Ee,Ze=M-Math.floor(S/2/Z)*Ee,Tt=(Ze=Ze>V?Ze<F?Ze:F:V)+S/Z*Ee;Tt=Tt<F?Tt:F;var zt=wt>S/2?2*(S/2-(M-Ze)*Z/Ee):2*(S/2-wt);le*=2,be*=2,Pe*=2,Ye*=2,nt*=2,Z*=2;for(var Et=1/Ee,Ve=Math.round(Ze/Ee*10)/10;Ve<=Tt/Ee;Ve++)h.beginPath(),h.moveTo(zt+(Ve-Ze/Ee)*Z,0),h.lineTo(zt+(Ve-Ze/Ee)*Z,Ve%10==0?le:be),h.lineWidth=Pe,h.strokeStyle=Ve%10==0?qe:fe,h.stroke(),h.fillStyle=We,h.textAlign="center",h.textBaseline="top",Ve%10==0&&(h.font="".concat(Ye,"px Arial"),h.fillText(Math.round(Ve/10)/(Et/10),zt+(Ve-Ze/Ee)*Z,nt)),h.closePath()}},{key:"init",value:function(o){this._renderBox(o.el)}}])&&he(se.prototype,X),_}();re.default=ue},function(Oe,re,J){(re=Oe.exports=J(3)(!1)).push([Oe.i,"* {}\n\n.slide-ruler_box_1Le {\n  position: relative; }\n  .slide-ruler_box_1Le:before {\n    position: absolute;\n    z-index: 1;\n    left: 50%;\n    top: 0;\n    transform: translateX(-50%);\n    content: '';\n    width: 3px;\n    height: 35px;\n    background-color: #00b0ab; }\n\n.slide-ruler_canvas_B8Y {\n  display: block;\n  transition-duration: 300ms; }\n",""]),re.locals={box:"slide-ruler_box_1Le",canvas:"slide-ruler_canvas_B8Y"}},function(Oe,re,J){"use strict";Oe.exports=function(q){var m=[];return m.toString=function(){return this.map(function(E){var k=function(he,ue){var h,g,_=he[1]||"",se=he[3];if(!se)return _;if(ue&&"function"==typeof btoa){var X=(h=btoa(unescape(encodeURIComponent(JSON.stringify(se)))),g="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(h),"/*# ".concat(g," */")),Me=se.sources.map(function(S){return"/*# sourceURL=".concat(se.sourceRoot).concat(S," */")});return[_].concat(Me).concat([X]).join("\n")}return[_].join("\n")}(E,q);return E[2]?"@media ".concat(E[2],"{").concat(k,"}"):k}).join("")},m.i=function(E,k){"string"==typeof E&&(E=[[null,E,""]]);for(var he={},ue=0;ue<this.length;ue++){var _=this[ue][0];null!=_&&(he[_]=!0)}for(var se=0;se<E.length;se++){var X=E[se];null!=X[0]&&he[X[0]]||(k&&!X[2]?X[2]=k:k&&(X[2]="(".concat(X[2],") and (").concat(k,")")),m.push(X))}},m}},function(Oe,re,J){var q,m,le,E={},k=(q=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===m&&(m=q.apply(this,arguments)),m}),he=(le={},function(be,Pe){if("function"==typeof be)return be();if(void 0===le[be]){var qe=function(fe,Ye){return Ye?Ye.querySelector(fe):document.querySelector(fe)}.call(this,be,Pe);if(window.HTMLIFrameElement&&qe instanceof window.HTMLIFrameElement)try{qe=qe.contentDocument.head}catch(fe){qe=null}le[be]=qe}return le[be]}),ue=null,_=0,se=[],X=J(5);function Me(Z,le){for(var be=0;be<Z.length;be++){var Pe=Z[be],qe=E[Pe.id];if(qe){qe.refs++;for(var fe=0;fe<qe.parts.length;fe++)qe.parts[fe](Pe.parts[fe]);for(;fe<Pe.parts.length;fe++)qe.parts.push(V(Pe.parts[fe],le))}else{var Ye=[];for(fe=0;fe<Pe.parts.length;fe++)Ye.push(V(Pe.parts[fe],le));E[Pe.id]={id:Pe.id,refs:1,parts:Ye}}}}function o(Z,le){for(var be=[],Pe={},qe=0;qe<Z.length;qe++){var fe=Z[qe],Ye=le.base?fe[0]+le.base:fe[0],We={css:fe[1],media:fe[2],sourceMap:fe[3]};Pe[Ye]?Pe[Ye].parts.push(We):be.push(Pe[Ye]={id:Ye,parts:[We]})}return be}function h(Z,le){var be=he(Z.insertInto);if(!be)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var Pe=se[se.length-1];if("top"===Z.insertAt)Pe?Pe.nextSibling?be.insertBefore(le,Pe.nextSibling):be.appendChild(le):be.insertBefore(le,be.firstChild),se.push(le);else if("bottom"===Z.insertAt)be.appendChild(le);else{if("object"!=typeof Z.insertAt||!Z.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var qe=he(Z.insertAt.before,be);be.insertBefore(le,qe)}}function g(Z){if(null===Z.parentNode)return!1;Z.parentNode.removeChild(Z);var le=se.indexOf(Z);le>=0&&se.splice(le,1)}function S(Z){var le=document.createElement("style");if(void 0===Z.attrs.nonce){var be=J.nc;be&&(Z.attrs.nonce=be)}return F(le,Z.attrs),h(Z,le),le}function F(Z,le){Object.keys(le).forEach(function(be){Z.setAttribute(be,le[be])})}function V(Z,le){var be,Pe,qe,fe,We,nt;if(le.transform&&Z.css){if(!(fe="function"==typeof le.transform?le.transform(Z.css):le.transform.default(Z.css)))return function(){};Z.css=fe}if(le.singleton){var Ye=_++;be=ue||(ue=S(le)),Pe=Ee.bind(null,be,Ye,!1),qe=Ee.bind(null,be,Ye,!0)}else Z.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(We=le,nt=document.createElement("link"),We.attrs.rel="stylesheet",F(nt,We.attrs),be=void h(We,nt),Pe=function(We,nt,wt){var Ze=wt.css,Tt=wt.sourceMap;(nt.convertToAbsoluteUrls||void 0===nt.convertToAbsoluteUrls&&Tt)&&(Ze=X(Ze)),Tt&&(Ze+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(Tt))))+" */"),he=We.href,We.href=URL.createObjectURL(Ye),he&&URL.revokeObjectURL(he)}.bind(null,be,le),qe=function(){g(be),be.href&&URL.revokeObjectURL(be.href)}):(be=S(le),Pe=function(We,nt){var wt=nt.css,Ze=nt.media;if(Ze&&We.setAttribute("media",Ze),We.styleSheet)We.styleSheet.cssText=wt;else{for(;We.firstChild;)We.removeChild(We.firstChild);We.appendChild(document.createTextNode(wt))}}.bind(null,be),qe=function(){g(be)});return Pe(Z),function(We){if(We){if(We.css===Z.css&&We.media===Z.media&&We.sourceMap===Z.sourceMap)return;Pe(Z=We)}else qe()}}Oe.exports=function(Z,le){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(le=le||{}).attrs="object"==typeof le.attrs?le.attrs:{},le.singleton||"boolean"==typeof le.singleton||(le.singleton=k()),le.insertInto||(le.insertInto="head"),le.insertAt||(le.insertAt="bottom");var be=o(Z,le);return Me(be,le),function(Pe){for(var qe=[],fe=0;fe<be.length;fe++)(We=E[be[fe].id]).refs--,qe.push(We);for(Pe&&Me(o(Pe,le),le),fe=0;fe<qe.length;fe++){var We;if(0===(We=qe[fe]).refs){for(var nt=0;nt<We.parts.length;nt++)We.parts[nt]();delete E[We.id]}}}};var M,me=(M=[],function(Z,le){return M[Z]=le,M.filter(Boolean).join("\n")});function Ee(Z,le,be,Pe){var qe=be?"":Pe.css;if(Z.styleSheet)Z.styleSheet.cssText=me(le,qe);else{var fe=document.createTextNode(qe),Ye=Z.childNodes;Ye[le]&&Z.removeChild(Ye[le]),Ye.length?Z.insertBefore(fe,Ye[le]):Z.appendChild(fe)}}},function(Oe,re){Oe.exports=function(J){var q="undefined"!=typeof window&&window.location;if(!q)throw new Error("fixUrls requires window.location");if(!J||"string"!=typeof J)return J;var m=q.protocol+"//"+q.host,E=m+q.pathname.replace(/\/[^\/]*$/,"/");return J.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(k,he){var ue,_=he.trim().replace(/^"(.*)"$/,function(se,X){return X}).replace(/^'(.*)'$/,function(se,X){return X});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(_)?k:(ue=0===_.indexOf("//")?_:0===_.indexOf("/")?m+_:E+_.replace(/^\.\//,""),"url("+JSON.stringify(ue)+")")})}}])},3915:xe=>{xe.exports=function Oe(re,J){(null==J||J>re.length)&&(J=re.length);for(var q=0,m=new Array(J);q<J;q++)m[q]=re[q];return m},xe.exports.__esModule=!0,xe.exports.default=xe.exports},7572:xe=>{xe.exports=function Oe(re){if(Array.isArray(re))return re},xe.exports.__esModule=!0,xe.exports.default=xe.exports},785:xe=>{xe.exports=function Oe(re,J){if(!(re instanceof J))throw new TypeError("Cannot call a class as a function")},xe.exports.__esModule=!0,xe.exports.default=xe.exports},2919:xe=>{function Oe(J,q){for(var m=0;m<q.length;m++){var E=q[m];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(J,E.key,E)}}xe.exports=function re(J,q,m){return q&&Oe(J.prototype,q),m&&Oe(J,m),Object.defineProperty(J,"prototype",{writable:!1}),J},xe.exports.__esModule=!0,xe.exports.default=xe.exports},617:xe=>{xe.exports=function Oe(re,J){var q=null==re?null:"undefined"!=typeof Symbol&&re[Symbol.iterator]||re["@@iterator"];if(null!=q){var he,ue,m=[],E=!0,k=!1;try{for(q=q.call(re);!(E=(he=q.next()).done)&&(m.push(he.value),!J||m.length!==J);E=!0);}catch(_){k=!0,ue=_}finally{try{!E&&null!=q.return&&q.return()}finally{if(k)throw ue}}return m}},xe.exports.__esModule=!0,xe.exports.default=xe.exports},3600:xe=>{xe.exports=function Oe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},xe.exports.__esModule=!0,xe.exports.default=xe.exports},1428:(xe,Oe,re)=>{var J=re(7572),q=re(617),m=re(2105),E=re(3600);xe.exports=function k(he,ue){return J(he)||q(he,ue)||m(he,ue)||E()},xe.exports.__esModule=!0,xe.exports.default=xe.exports},2105:(xe,Oe,re)=>{var J=re(3915);xe.exports=function q(m,E){if(m){if("string"==typeof m)return J(m,E);var k=Object.prototype.toString.call(m).slice(8,-1);if("Object"===k&&m.constructor&&(k=m.constructor.name),"Map"===k||"Set"===k)return Array.from(m);if("Arguments"===k||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return J(m,E)}},xe.exports.__esModule=!0,xe.exports.default=xe.exports}}]);